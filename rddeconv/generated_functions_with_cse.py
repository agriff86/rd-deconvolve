
"""
Functions generated using Sage

Total count functions (tf_*) assume an inlet radon concentration of 1 Bq/m3
i.e. the result should be multiplied by the inlet radon concentration in
Bq/m3, converted from ambient temperature and pressure to the temperature
and pressure inside the radon detector.
"""

from numpy import exp
from numpy import sqrt
from numpy import abs

lambda_r = 2.100140526711101e-6
lambda_a = 0.003787689511256532
lambda_b = 0.0004310616794527023
lambda_c = 0.0005805252768508755
def calc_na_nb_factors(Q,lamp,V_tank, **kwargs):
    N_af = lambda_r*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q)/lambda_r - 1/lambda_r)*exp(-V_tank*lamp/Q)/(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q))
    N_bf = -lambda_r*(lambda_a**2*exp(V_tank*lambda_a/Q)/lambda_r - lambda_a*lambda_b*exp(V_tank*lambda_b/Q)/lambda_r + lamp*(lambda_a*exp(V_tank*lambda_a/Q)/lambda_r - lambda_a*exp(V_tank*lambda_b/Q)/lambda_r) - (lambda_a**2*exp(V_tank*lambda_a/Q)/lambda_r - lambda_a*lambda_b*exp(V_tank*lambda_a/Q)/lambda_r)*exp(V_tank*lambda_b/Q + V_tank*lamp/Q))*exp(-V_tank*lamp/Q)/(lamp**2*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + lamp*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + (lambda_a**2*lambda_b*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q))

    return N_af,N_bf


def num_filter_atoms_steady_state(rs,recoil_prob,V_tank,Q,lamp, **kwargs):
    Na = Q*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_a*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q)))
    Nb = -Q*recoil_prob*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_b*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q))) - Q*rs*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_b/Q) + lamp*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_a*exp(V_tank*lambda_b/Q)) - (lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q + V_tank*lamp/Q))*exp(-V_tank*lamp/Q)/(lambda_b*(lamp**2*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + lamp*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + (lambda_a**2*lambda_b*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q))) + Q*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_b*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q)))
    Nc = -Q*recoil_prob*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_c*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q))) - Q*rs*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_b/Q) + lamp*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_a*exp(V_tank*lambda_b/Q)) - (lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q + V_tank*lamp/Q))*exp(-V_tank*lamp/Q)/(lambda_c*(lamp**2*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + lamp*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + (lambda_a**2*lambda_b*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q))) + Q*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_c*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q)))

    return Na,Nb,Nc


def tc_integral_filter_activity(N_d0,V_tank,Q,a0,b0,N_bf,N_af,c0,V_delay,rs,recoil_prob,N_r0,Q_external,eff,t, **kwargs):
    X = -eff*((-(((rs*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0))) + lambda_b**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_c**4*(lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_b**3*(N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**2*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf)))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**2*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**3*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af - N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))))) + lambda_c**3*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b**4*(N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**2*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf)))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**3*V_tank**3 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**4*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af - N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf))) - lambda_a**2*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf))))) - lambda_c**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b**4*(N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**2*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) + lambda_b**3*(N_bf*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**3*V_tank**3 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)))) + lambda_c*(lambda_a**4*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b**4*(lambda_a**3*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af - N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf)))) + lambda_b**3*(lambda_a**4*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af - N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf))) - lambda_a**2*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf)))) - lambda_b**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)))) - recoil_prob*(lambda_c**4*(lambda_b**3*(lambda_a**2*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**2*(lambda_a**3*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0)))) - lambda_c**3*(lambda_b**4*(lambda_a**2*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**2*(lambda_a**4*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0)))) + lambda_c**2*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0)))) - lambda_c*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b**2*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))))))*exp(Q_external*t/V_delay) - rs*(lambda_b**4*(-N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**3) - lambda_b**3*(N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**4 - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank)) - lambda_b**2*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**2 + N_af*N_d0*Q*Q_external**4*V_delay**4*lambda_a**3 - lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2)) - lambda_b*(-N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**3 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank*lambda_a**4) - lambda_c**4*(-N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**3 - lambda_b**3*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*V_delay**5*V_tank**3*lambda_a**2*(2*N_af + N_bf) - lambda_a*(N_bf*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf))) + lambda_b**2*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**2*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**3*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf))) + lambda_b*(N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a*(N_af - N_bf) - lambda_a**3*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**2*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf)))) + lambda_c**3*(N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**4 - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank) - lambda_b**4*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*V_delay**5*V_tank**3*lambda_a**2*(2*N_af + N_bf) - lambda_a*(N_bf*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf))) + lambda_b**2*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3*lambda_a**2 + N_bf*N_d0*Q*Q_external**4*V_delay**4 + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**3*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**4*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2 + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf))) - lambda_b*(lambda_a**4*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af - N_bf)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank + N_d0*Q*Q_external**4*V_delay**4*(N_af - N_bf)))) + lambda_c**2*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**2 + N_af*N_d0*Q*Q_external**4*V_delay**4*lambda_a**3 - lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2) + lambda_b**4*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**2*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**3*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf))) - lambda_b**3*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3*lambda_a**2 + N_bf*N_d0*Q*Q_external**4*V_delay**4 + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**3*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**4*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2 + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf))) - lambda_b*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a + N_d0*Q*Q_external**4*V_delay**4*lambda_a**2*(N_af - N_bf) - lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)))) + lambda_c*(-N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**3 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank*lambda_a**4 + lambda_b**4*(N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a*(N_af - N_bf) - lambda_a**3*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**2*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf))) + lambda_b**3*(lambda_a**4*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af - N_bf)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank + N_d0*Q*Q_external**4*V_delay**4*(N_af - N_bf))) + lambda_b**2*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a + N_d0*Q*Q_external**4*V_delay**4*lambda_a**2*(N_af - N_bf) - lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)))) - recoil_prob*(lambda_c**4*(lambda_b**3*(-N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**2) - lambda_b**2*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**3) + lambda_b*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**3)) - lambda_c**3*(lambda_b**4*(-N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**2) - lambda_b**2*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**4) + lambda_b*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**4)) + lambda_c**2*(lambda_b**4*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**3) - lambda_b**3*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**4) + lambda_b*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**4)) - lambda_c*(lambda_b**4*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**3) - lambda_b**3*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**4) + lambda_b**2*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**4))))*exp(Q_external*t/V_tank))*exp(lambda_a*t) - (lambda_b**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_c**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - 2*lambda_b**3*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_b**2*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(2*Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - 2*Q_external**3*V_delay*V_tank**4) + 2*a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay**3*V_tank**2 + Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + 2*a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) + lambda_c**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - 2*lambda_b**4*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_b**2*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(2*Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - 2*Q_external**4*V_tank**4) + 2*a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) - lambda_b*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_delay**3*V_tank + Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + 2*a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) - lambda_c**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(2*Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - 2*Q_external**3*V_delay*V_tank**4) + 2*a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**3*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(2*Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - 2*Q_external**4*V_tank**4) + 2*a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) - lambda_b*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + 2*a0*(Q_external**7*V_delay - Q_external**7*V_tank))) + lambda_c*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay**3*V_tank**2 + Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + 2*a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) + lambda_b**3*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_delay**3*V_tank + Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + 2*a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) - lambda_b**2*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + 2*a0*(Q_external**7*V_delay - Q_external**7*V_tank))) - recoil_prob*(lambda_c**4*(lambda_b**3*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**2*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b*(a0*lambda_a**2*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_c**3*(lambda_b**4*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**2*(a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_b*(a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) + lambda_c**2*(lambda_b**4*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b**3*(a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_b*(a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*(Q_external**7*V_delay - Q_external**7*V_tank))) - lambda_c*(lambda_b**4*(a0*lambda_a**2*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*(Q_external**7*V_delay - Q_external**7*V_tank)))) - rs*(lambda_b**4*(lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3)) + lambda_b**2*(lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) - lambda_a**2*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_b*(lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2) - lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_c**4*(lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) + 2*lambda_b**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(2*N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - 2*N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + 2*N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - 2*N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a**2*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(2*N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - 2*Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - 2*N_af*N_r0)))) + lambda_c**3*(lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) + 2*lambda_b**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(2*N_af*N_d0*Q*Q_external**4*V_delay**4 - 2*N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + 2*N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a**2*(Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(-N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - 2*N_af*N_r0))) + lambda_b*(2*N_af*N_d0*Q*Q_external**5*V_delay**3 - 2*N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + 2*N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - 2*N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a**2*(Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)))) - lambda_c**2*(lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) - lambda_a**2*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) + lambda_b**4*(2*N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - 2*N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + 2*N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - 2*N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a**2*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(2*N_af*N_d0*Q*Q_external**4*V_delay**4 - 2*N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + 2*N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a**2*(Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(-N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - 2*N_af*N_r0))) + lambda_b*(2*N_af*N_d0*Q*Q_external**6*V_delay**2 - 2*N_af*N_r0*Q*Q_external**6*V_tank**2 - 2*Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0)))) + lambda_c*(lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2) - lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) + lambda_b**4*(2*N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - 2*Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - 2*N_af*N_r0))) - lambda_b**3*(2*N_af*N_d0*Q*Q_external**5*V_delay**3 - 2*N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + 2*N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - 2*N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a**2*(Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0))) + lambda_b**2*(2*N_af*N_d0*Q*Q_external**6*V_delay**2 - 2*N_af*N_r0*Q*Q_external**6*V_tank**2 - 2*Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0)))) + recoil_prob*(lambda_c**4*(lambda_b**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) + lambda_b*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3))) - lambda_c**3*(lambda_b**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4)) + lambda_b*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3))) + lambda_c**2*(lambda_b**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) - lambda_b**3*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4)) + lambda_b*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_b**4*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3)) - lambda_b**3*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))))))*exp(Q_external*t/V_tank + Q_external*t/V_delay))*exp(lambda_b*t) + (lambda_c**4*(lambda_a**3*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(b0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - b0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**2*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) - lambda_b*(a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + lambda_a**3*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)))) - lambda_c**3*(lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) - lambda_b**3*(b0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - b0*lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + lambda_a**4*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_a*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) - lambda_b*(b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)))) + lambda_c**2*(lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b**3*(b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - b0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) + lambda_b**2*(-b0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**3*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_b*(-b0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4)) - lambda_a**3*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)))) - lambda_c*(lambda_a**4*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_a**3*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_a**2*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b**3*(b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**2*(a0*lambda_a**3*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - b0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3))) - lambda_b*(a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)))) - recoil_prob*(lambda_c**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + lambda_b**2*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*lambda_a*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3))) - lambda_c**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_b**2*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3))) + lambda_c**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_b**2*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**3*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) - lambda_c*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_b**2*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**3*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)))) + rs*(lambda_c**4*(lambda_a**3*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) - lambda_b*(N_bf*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a*(-N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf))))) - lambda_c**3*(lambda_a**4*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf)) + lambda_b**2*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 + lambda_a**3*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) - lambda_b*(N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_tank**3 + lambda_a**4*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(N_r0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a*(-N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank + N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf))))) + lambda_c**2*(lambda_a**4*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a**3*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2 + lambda_a**3*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) - lambda_b*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - N_bf*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + Q*Q_external**3*V_delay**4*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf))) - lambda_a**2*(N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf)))) - lambda_c*(lambda_a**4*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf)) + lambda_a**2*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_b**2*(lambda_a**3*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2)) - lambda_b*(lambda_a**4*(N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**3*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(-N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank + N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf))) + lambda_a*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0)))) - recoil_prob*(lambda_c**4*(lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3))) - lambda_c**3*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3))) + lambda_c**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) - lambda_a**3*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_a**4*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) + lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))))))*exp(Q_external*t/V_tank + Q_external*t/V_delay + lambda_a*t))*exp(lambda_c*t) + (lambda_b**4*(lambda_a**3*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_b**3*(lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) + lambda_b**2*(lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + c0*(Q_external**7*V_delay - Q_external**7*V_tank))) - lambda_b*(lambda_a**4*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_a**3*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_a**2*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + c0*(Q_external**7*V_delay - Q_external**7*V_tank))) - lambda_c**4*(c0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - c0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + c0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_b**3*(c0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - c0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_b**2*(c0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - c0*lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b*(c0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - c0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) + lambda_c**3*(c0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - c0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - lambda_b**4*(b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + lambda_a**2*(b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + c0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a*(b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4))) + lambda_b**3*(b0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - b0*lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(-b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - c0*lambda_a*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) - lambda_b*(-b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**2*(b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)))) - lambda_c**2*(c0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_b**4*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + c0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) + lambda_b**3*(b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a**4*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + c0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_a*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) - c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) - lambda_b**2*(-b0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**3*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) + lambda_b*(b0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - c0*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) - lambda_a**3*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a**2*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)))) + lambda_c*(c0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - c0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + lambda_a**3*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) + lambda_b**3*(b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_b**2*(-b0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + c0*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) - lambda_a**3*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) + lambda_b*(a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)))) - recoil_prob*(lambda_b**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank)) + lambda_c**2*(lambda_b**4*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*lambda_a*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**3*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**3*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**3*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_b**4*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b**3*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3)) + lambda_b**2*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)))) + rs*(lambda_b**4*(lambda_a**3*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b**3*(lambda_a**4*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf))) + lambda_b**2*(lambda_a**4*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a**3*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**4*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf)) + lambda_a**2*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf)))) + lambda_c**2*(lambda_b**4*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) - lambda_b**3*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 + lambda_a**3*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) + lambda_b**2*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2 + lambda_a**3*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) - lambda_b*(lambda_a**3*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_b**4*(N_bf*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a*(-N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf)))) - lambda_b**3*(N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_tank**3 + lambda_a**4*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(N_r0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a*(-N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank + N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf)))) + lambda_b**2*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - N_bf*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + Q*Q_external**3*V_delay**4*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf))) - lambda_a**2*(N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf))) - lambda_b*(lambda_a**4*(N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**3*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(-N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank + N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf))) + lambda_a*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0)))) - recoil_prob*(lambda_b**4*(lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3)) + lambda_b**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) - lambda_a**3*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_b*(lambda_a**4*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) + lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_c*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3)) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2)) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))))))*exp(Q_external*t/V_tank + Q_external*t/V_delay + lambda_a*t + lambda_b*t))*exp(-Q_external*t/V_tank - Q_external*t/V_delay - lambda_a*t - lambda_b*t - lambda_c*t)/(lambda_b**4*(lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b*(lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_c**4*(lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_b**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) + lambda_b**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 + lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) - lambda_b*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 + lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) + lambda_c**3*(lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - lambda_b**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) + lambda_b**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3 + lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) - lambda_b*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2 + lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) - lambda_c**2*(lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 + lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_b**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3 + lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) - lambda_b*(Q_external**7*V_delay - Q_external**7*V_tank + lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) + lambda_c*(lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 + lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_b**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2 + lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) - lambda_b**2*(Q_external**7*V_delay - Q_external**7*V_tank + lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)))) + (Q_external*a0*recoil_prob - 2*Q_external*a0 - Q_external*b0 - Q_external*c0 - rs*(N_d0*Q*V_delay*(2*N_af + N_bf) + N_r0*Q*V_tank*(2*N_af + N_bf) - recoil_prob*(N_af*N_d0*Q*V_delay + N_af*N_r0*Q*V_tank)))/Q_external)

    return X


def tc_integral_delta(V_delay,rs,recoil_prob,V_tank,Q,N_bf,N_af,Q_external,eff,t, **kwargs):
    x0 = 2*N_af
    x1 = -N_bf
    x2 = 1/V_delay
    x3 = Q_external*x2
    x4 = 1/V_tank
    x5 = Q_external*x4
    x6 = lambda_a + x3 + x5
    x7 = lambda_b + x6
    x8 = Q_external**4
    x9 = lambda_b*x8
    x10 = lambda_a**2
    x11 = Q_external**2
    x12 = V_delay - V_tank
    x13 = x11*x12
    x14 = V_delay*V_tank*x12
    x15 = Q_external*lambda_a
    x16 = V_delay**2
    x17 = V_tank**2
    x18 = x16 - x17
    x19 = x15*x18
    x20 = x10*x14 - x19
    x21 = x13 + x20
    x22 = lambda_b**4
    x23 = V_delay*V_tank*lambda_a*x11*x22
    x24 = Q_external**3
    x25 = lambda_b**2
    x26 = lambda_a*x24*x25
    x27 = x12*x24
    x28 = V_delay**3
    x29 = V_tank**3
    x30 = x28 - x29
    x31 = x10*x30
    x32 = lambda_a**3
    x33 = V_delay*V_tank*x18
    x34 = -Q_external*x31 + x32*x33
    x35 = x27 + x34
    x36 = lambda_b**3
    x37 = lambda_a*x11*x36
    x38 = x18*x24
    x39 = x11*x30
    x40 = x12*x16*x17
    x41 = -lambda_a*x39 + x32*x40
    x42 = x38 + x41
    x43 = V_delay*V_tank*lambda_c**4
    x44 = lambda_a*x12
    x45 = x44*x8
    x46 = V_delay*V_tank*x11*x12
    x47 = -x10*x38
    x48 = V_delay*V_tank
    x49 = V_delay*x11
    x50 = V_tank*x11
    x51 = x20 + x49 - x50
    x52 = x36*x48*x51
    x53 = Q_external*lambda_b
    x54 = V_delay*x24 - V_tank*x24 + x34
    x55 = x53*x54
    x56 = x16*x24 - x17*x24 + x41
    x57 = x25*x56
    x58 = Q_external*lambda_c
    x59 = Q_external**5
    x60 = x10*x12
    x61 = V_tank*x12
    x62 = lambda_a**4
    x63 = V_delay*x24*x62
    x64 = x32*x8
    x65 = Q_external*x25
    x66 = Q_external*x32
    x67 = V_delay**4 - V_tank**4
    x68 = V_delay*x8 - V_tank*x8 + x30*x48*x62 - x66*x67
    x69 = V_delay*V_tank*x22
    x70 = x10*x11
    x71 = x16*x17*x62
    x72 = x16*x8 - x17*x8 + x18*x71 - x67*x70
    x73 = lambda_c**2
    x74 = V_tank*x18
    x75 = lambda_b*x11
    x76 = lambda_a*x24
    x77 = x29*x62
    x78 = x12*x28*x77 + x28*x8 - x29*x8 - x67*x76
    x79 = lambda_c**3
    x80 = lambda_a*x18
    x81 = N_af + N_bf
    x82 = x21*x81
    x83 = Q_external*lambda_a*lambda_b
    x84 = lambda_a*x81
    x85 = x25*x42
    x86 = N_af*lambda_a*recoil_prob
    x87 = lambda_a*x11
    x88 = -x21*x87
    x89 = V_delay*V_tank*x21
    x90 = N_bf*lambda_b
    x91 = lambda_a*x13
    x92 = Q_external*x18
    x93 = -x10*x81*x92 + x14*x32*x81 + x81*x91
    x94 = V_delay*V_tank*x79
    x95 = x62*x81
    x96 = x24*x80
    x97 = V_delay*lambda_a
    x98 = x61*x97
    x99 = 2*Q_external
    x100 = V_delay*x99 - V_tank*x99 + x80
    x101 = x16*x99 - x17*x99 + x98
    x102 = x19 + x31 + 2*x49 - 2*x50
    x103 = 2*x11
    x104 = V_tank*x10
    x105 = V_tank*x16
    x106 = V_delay*x17
    x107 = V_delay*x104*x18 + x103*x16 - x103*x17 + x15*(x105 - x106 + x30)
    x108 = Q_external*x97
    x109 = x10*x16
    x110 = x12*x17
    x111 = x103*x28 - x103*x29 + x108*x74 + x109*x110
    x112 = -lambda_b*x92 + x13 + x14*x25
    x113 = x16*x36
    x114 = -Q_external
    x115 = V_tank*lambda_a
    x116 = x114 + x115
    x117 = N_af*lambda_b*x32*x8
    x118 = N_af*V_delay*V_tank*x22
    x119 = x116*x70
    x120 = N_af*x10*x24*x25
    x121 = V_delay + V_tank
    x122 = x10*x121
    x123 = N_af*x10*x11*x36
    x124 = -x11*x121
    x125 = N_af*x24
    x126 = -x10*x125
    x127 = N_af*V_tank
    x128 = x11*x32
    x129 = V_tank*x36
    x130 = N_bf*V_tank
    x131 = N_bf + x0
    x132 = V_delay*x131
    x133 = x130 + x132
    x134 = x133*x15
    x135 = N_bf*x11 + x104*x132
    x136 = -x134 + x135
    x137 = N_af + x1
    x138 = x11*x137
    x139 = x127 + x132
    x140 = -x104*x139 + x134 + x138
    x141 = N_bf*x24
    x142 = Q_external*x137
    x143 = x10*x17
    x144 = x131*x32
    x145 = x106*x144 - x139*x87 + x141 + x142*x143
    x146 = N_af*lambda_a*lambda_b*lambda_c*recoil_prob
    x147 = -x11
    x148 = x143 + x147
    x149 = V_tank*x116*x25 - lambda_b*x148 + x116*x15
    x150 = -x24
    x151 = x29*x32
    x152 = x150 + x151
    x153 = Q_external*lambda_a*lambda_c
    x154 = N_af*x10
    x155 = x154*x8
    x156 = -x155
    x157 = x24*x32
    x158 = V_delay*x10
    x159 = N_af*V_delay
    x160 = V_tank*x159
    x161 = x131*x16
    x162 = N_af*x17 + x160 + x161
    x163 = Q_external*x133*x158 - V_tank*x162*x32 + x125 + x138*x97
    x164 = V_delay*x137 + x127
    x165 = Q_external*x143*x164 + x106*x139*x32 - x11*x139*x97 - x164*x24
    x166 = x154*x59
    x167 = x121*x24*x62
    x168 = lambda_a*lambda_b*x11
    x169 = N_bf*V_delay
    x170 = N_af*x10*x11
    x171 = Q_external*V_delay*x137*x151 + x161*x77 - x162*x76 + x169*x8 + x170*x29
    x172 = N_af*x24*x32
    x173 = -x121*x155
    x174 = x11*x62
    x175 = x114 + x97
    x176 = x175*x70
    x177 = V_delay*x36
    x178 = V_tank*x131
    x179 = x169 + x178
    x180 = x15*x179
    x181 = x135 - x180
    x182 = x159 + x178
    x183 = x138 - x158*x182 + x180
    x184 = x105*x144 + x109*x142 + x141 - x182*x87
    x185 = x109 + x147
    x186 = V_delay*x175*x25 - lambda_b*x185 + x15*x175
    x187 = x150 + x28*x32
    x188 = x131*x17
    x189 = N_af*x16 + x160 + x188
    x190 = Q_external*x104*x179 - V_delay*x189*x32 + x115*x138 + x125
    x191 = V_tank*x137
    x192 = x159 + x191
    x193 = Q_external*x109*x192 + x105*x182*x32 - x11*x115*x182 - x192*x24
    x194 = Q_external*x191*x28*x32 + x130*x8 + x170*x28 + x188*x28*x62 - x189*x76
    X = -Q*eff*rs*(N_af*recoil_prob - x0 + x1 - (x75*(N_bf*lambda_c*(x52 + x55 - x57 + x88) - V_delay*V_tank*lambda_a*x36*x82 - x35*x81*x83 + x70*x82 + x84*x85 + x86*(x35*x53 + x36*x89 - x85 + x88))*exp(t*x7) + (-lambda_c*x11*(-x58*(x27*x84 - x30*x66*x81 + x33*x95 - x54*x90) + x73*(-x11*x31*x81 + x40*x95 - x56*x90 + x81*x96) + x86*(x35*x58 - x42*x73 + x79*x89 + x88) + x87*(-x21*x90 + x93) - x94*(-x51*x90 + x93))*exp(t*x6) + (N_af*x11*(lambda_b*lambda_c*recoil_prob*(-x112*x75 + x112*x94 + x58*(x27 - x30*x65 + x33*x36) - x73*(-lambda_b*x39 + x110*x113 + x38)) - x12*x23 - x26*(Q_external*x12 + x80) + x37*(x92 + x98) - x43*(x100*x53 - x101*x25 + 2*x14*x36 - x91) + x58*(-x10*x27 + x100*x69 + x102*x65 - x107*x36) + x60*x9 - x73*(x101*x69 + x102*x75 - x111*x36 - x45 + x47) + x79*(-x10*x46 + x107*x53 - x111*x25 + 2*x22*x40 - x96))*exp(Q_external*t*(x2 + x4)) + (x16*(x116*x117 - x118*x119 + x120*(-V_tank*x122 + x108 + x11) + x123*(x10*x106 + x124 + x15*x17) + x146*x16*(V_tank*x149*x79 + lambda_c*(x119 + x129*x148 - x152*x25) - x149*x83 - x73*(-lambda_b*x152 + x116*x17*x36 + x148*x15)) - x153*(x127*x157 + x140*x69 + x156 + x163*x65 + x165*x36) + x43*(x126 + x127*x128 - x129*x136 + x140*x83 + x145*x25) - x73*(-x127*x167 + x145*x69 + x159*x64 - x163*x168 + x166 - x171*x36) - x79*(N_af*V_delay*x17*x174 - x106*x136*x22 - x165*x83 + x17*x172 + x171*x25 + x173))*exp(t*x5) - x17*(x117*x175 - x118*x176 + x120*(Q_external*x115 - V_delay*x122 + x11) + x123*(x10*x105 + x124 + x15*x16) + x146*x17*(V_delay*x186*x79 + lambda_c*(x176 + x177*x185 - x187*x25) - x186*x83 - x73*(-lambda_b*x187 + x113*x175 + x15*x185)) - x153*(x156 + x157*x159 + x183*x69 + x190*x65 + x193*x36) + x43*(x126 + x128*x159 - x177*x181 + x183*x83 + x184*x25) - x73*(x127*x64 - x159*x167 + x166 - x168*x190 + x184*x69 - x194*x36) - x79*(N_af*V_tank*x16*x174 - x105*x181*x22 + x16*x172 + x173 - x193*x83 + x194*x25))*exp(t*x3))*exp(lambda_a*t))*exp(lambda_b*t))*exp(lambda_c*t))*exp(-t*(lambda_c + x7))/(-x10*x21*x9 + x21*x23 + x26*x35 - x37*x42 - x43*(x32*x46 + x45 + x47 - x52 - x55 + x57) + x58*(-x18*x64 + x36*x72 - x54*x69 + x59*x60 + x61*x63 - x65*x68) - x73*(Q_external**6*x44 - x30*x64 + x36*x78 - x56*x69 + x63*x74 - x68*x75) + x79*(x13*x71 - x16*x17*x22*x51 + x25*x78 - x31*x8 - x53*x72 + x59*x80)))/Q_external

    return X


def tc_integral_calibration(Ncal,rs,recoil_prob,V_tank,Q,cal_begin,N_bf,N_af,t,Q_external,eff,cal_duration, **kwargs):
    x0 = lambda_c**2
    x1 = Q_external**3
    x2 = lambda_a*x1
    x3 = x0*x2
    x4 = lambda_a**2
    x5 = x1*x4
    x6 = lambda_b*x5
    x7 = lambda_b**2
    x8 = lambda_c*x1*x7
    x9 = x2*x7
    x10 = lambda_c*x5
    x11 = lambda_b*x0*x1
    x12 = lambda_b**3
    x13 = Q_external**2
    x14 = V_tank*lambda_a*x13
    x15 = x12*x14
    x16 = lambda_a**3
    x17 = V_tank*x13*x16
    x18 = lambda_c*x17
    x19 = V_tank*x13
    x20 = lambda_c**3
    x21 = lambda_b*x20
    x22 = x19*x21
    x23 = x14*x20
    x24 = lambda_b*x17
    x25 = lambda_c*x12
    x26 = x19*x25
    x27 = V_tank**2
    x28 = Q_external*x27*x4
    x29 = x20*x28
    x30 = Q_external*x16*x27
    x31 = x30*x7
    x32 = Q_external*x27
    x33 = x0*x12
    x34 = x32*x33
    x35 = V_tank**3
    x36 = lambda_a*x35
    x37 = x20*x7
    x38 = x36*x37
    x39 = x35*x4
    x40 = x25*x39
    x41 = lambda_b*x0
    x42 = x16*x35
    x43 = x41*x42
    x44 = x12*x28
    x45 = x0*x30
    x46 = x32*x37
    x47 = x33*x36
    x48 = x21*x39
    x49 = lambda_c*x7
    x50 = x42*x49
    x51 = N_bf*cal_duration
    x52 = 2*N_af*cal_duration
    x53 = N_af*cal_duration*recoil_prob
    x54 = cal_begin - t
    x55 = abs(x54)
    x56 = N_bf*x55
    x57 = 2*N_af*x55
    x58 = abs(cal_duration + x54)
    x59 = N_bf*x58
    x60 = N_af*recoil_prob*x55
    x61 = 2*N_af*x58
    x62 = N_af*recoil_prob*x58
    x63 = cal_begin/2
    x64 = -t/2
    x65 = -x55/2 + x63 + x64
    x66 = exp(lambda_a*x65)
    x67 = 2*N_af*lambda_a*x1*x66
    x68 = 2*N_bf*lambda_a*lambda_b*x1
    x69 = exp(lambda_c*x65)
    x70 = 2*N_bf*lambda_a*lambda_c*x1
    x71 = exp(lambda_b*x65)
    x72 = 2*N_af*x1*x66
    x73 = 2*N_bf*x1*x7
    x74 = 2*N_bf*x0*x1
    x75 = 2*N_af*V_tank*x13*x66
    x76 = cal_duration/2 - x58/2 + x63 + x64
    x77 = exp(lambda_a*x76)
    x78 = 2*N_af*lambda_a*x1*x77
    x79 = 2*N_bf*V_tank*x13
    x80 = x12*x69
    x81 = x20*x71
    x82 = exp(lambda_c*x76)
    x83 = exp(lambda_b*x76)
    x84 = 2*N_af*x1*x77
    x85 = 2*N_af*Q_external*x27*x66
    x86 = 2*N_af*V_tank*lambda_a*x13*x66
    x87 = 2*N_bf*Q_external*lambda_a*x27
    x88 = 2*N_bf*V_tank*lambda_b*x13*x4
    x89 = 2*N_bf*V_tank*lambda_c*x13*x4
    x90 = 2*N_af*V_tank*x13*x77
    x91 = x12*x82
    x92 = x20*x83
    x93 = 2*N_af*Q_external*lambda_a*x27*x66
    x94 = 2*N_af*Q_external*x27*x77
    x95 = 2*N_af*V_tank*lambda_a*x13*x77
    x96 = 1/lambda_a
    x97 = 4*N_af*x66*x96
    x98 = 1/lambda_b
    x99 = 2*N_af*x71*x98
    x100 = x3*x99
    x101 = 1/lambda_c
    x102 = 2*N_af*x101*x69
    x103 = x102*x9
    x104 = x10*x99
    x105 = x102*x6
    x106 = 2*N_bf*Q_external*x27*x4*x7
    x107 = 2*N_bf*Q_external*x0*x27*x4
    x108 = 2*N_bf*x71*x98
    x109 = 2*N_bf*x101*x69
    x110 = Q_external/V_tank
    x111 = exp(x110*x65)
    x112 = 2*N_af*Q_external*x111*x16*x27
    x113 = 2*N_af*lambda_a*x111*x35
    x114 = 2*N_bf*lambda_a*x111*x35
    x115 = 2*N_af*Q_external*lambda_a*x27*x77
    x116 = x23*x99
    x117 = x102*x15
    x118 = x18*x99
    x119 = x102*x24
    x120 = 2*N_af*recoil_prob*x66*x96
    x121 = 2*N_af*x111*x35*x4
    x122 = 2*N_af*x111*x16*x35
    x123 = 2*N_bf*x111*x35
    x124 = 4*N_af*x77*x96
    x125 = 2*N_af*x83*x98
    x126 = x125*x3
    x127 = 2*N_af*x101*x82
    x128 = x127*x9
    x129 = x10*x125
    x130 = x127*x6
    x131 = 2*N_bf*x83*x98
    x132 = 2*N_bf*x101*x82
    x133 = 2*N_af*Q_external*lambda_a*x111*x27
    x134 = 2*N_af*Q_external*x111*x27*x4
    x135 = exp(x110*x76)
    x136 = 2*N_af*Q_external*x135*x16*x27
    x137 = 2*N_af*lambda_a*x135*x35
    x138 = 2*N_bf*lambda_a*x135*x35
    x139 = 2*N_bf*x111*x35*x4
    x140 = x29*x99
    x141 = x102*x44
    x142 = x45*x99
    x143 = x102*x31
    x144 = x125*x23
    x145 = x127*x15
    x146 = x125*x18
    x147 = x127*x24
    x148 = 2*N_af*recoil_prob*x77*x96
    x149 = 2*N_af*x135*x35*x4
    x150 = 2*N_af*x135*x16*x35
    x151 = 2*N_bf*x135*x35
    x152 = 2*N_af*Q_external*lambda_a*x135*x27
    x153 = 2*N_af*Q_external*x135*x27*x4
    x154 = 2*N_bf*x135*x35*x4
    x155 = x125*x29
    x156 = x127*x44
    x157 = x125*x45
    x158 = x127*x31
    x159 = 1/Q_external
    x160 = V_tank**4
    x161 = 4*N_af*lambda_a*x111*x159*x160
    x162 = 4*N_af*x111*x159*x160*x4
    x163 = 4*N_af*x111*x159*x16*x160
    x164 = 2*N_bf*lambda_a*x111*x159*x160
    x165 = 2*N_bf*x111*x159*x160*x4
    x166 = 2*N_bf*x111*x159*x16*x160
    x167 = 2*N_af*lambda_a*recoil_prob*x111*x159*x160
    x168 = 2*N_af*recoil_prob*x111*x159*x160*x4
    x169 = 2*N_af*recoil_prob*x111*x159*x16*x160
    x170 = 4*N_af*lambda_a*x135*x159*x160
    x171 = 4*N_af*x135*x159*x160*x4
    x172 = 4*N_af*x135*x159*x16*x160
    x173 = 2*N_bf*lambda_a*x135*x159*x160
    x174 = 2*N_bf*x135*x159*x160*x4
    x175 = 2*N_bf*x135*x159*x16*x160
    x176 = 2*N_af*lambda_a*recoil_prob*x135*x159*x160
    x177 = 2*N_af*recoil_prob*x135*x159*x160*x4
    x178 = 2*N_af*recoil_prob*x135*x159*x16*x160
    X = Ncal*Q*eff*rs*(-lambda_b*x112 + lambda_b*x136 + lambda_b*x67 - lambda_b*x78 + lambda_c*x112 - lambda_c*x136 - lambda_c*x67 + lambda_c*x78 - recoil_prob*x100 + recoil_prob*x103 + recoil_prob*x104 - recoil_prob*x105 + recoil_prob*x116 - recoil_prob*x117 - recoil_prob*x118 + recoil_prob*x119 + recoil_prob*x126 - recoil_prob*x128 - recoil_prob*x129 + recoil_prob*x130 - recoil_prob*x140 + recoil_prob*x141 + recoil_prob*x142 - recoil_prob*x143 - recoil_prob*x144 + recoil_prob*x145 + recoil_prob*x146 - recoil_prob*x147 + recoil_prob*x155 - recoil_prob*x156 - recoil_prob*x157 + recoil_prob*x158 - x0*x122 - x0*x134 + x0*x150 + x0*x153 + x0*x72 - x0*x84 + x0*x86 - x0*x95 - x10*x108 + x10*x131 - x10*x51 - x10*x52 + x10*x53 - x10*x56 - x10*x57 + x10*x59 + x10*x60 + x10*x61 - x10*x62 + x100 - x103 - x104 + x105 - x106*x69 + x106*x82 + x107*x71 - x107*x83 + x108*x18 - x108*x23 + x108*x29 + x108*x3 - x108*x45 + x109*x15 - x109*x24 + x109*x31 - x109*x44 + x109*x6 - x109*x9 + x11*x120 + x11*x124 - x11*x148 - x11*x51 - x11*x52 + x11*x53 - x11*x56 - x11*x57 + x11*x59 + x11*x60 + x11*x61 - x11*x62 - x11*x97 - x113*x21 + x113*x25 + x114*x21 - x114*x25 + x115*x41 - x115*x49 - x116 + x117 + x118 - x119 - x12*x121 + x12*x149 + x12*x75 - x12*x90 - x120*x22 + x120*x26 - x120*x34 + x120*x46 - x120*x8 + x121*x20 + x121*x41 - x121*x49 + x122*x7 + x123*x33 - x123*x37 - x124*x22 + x124*x26 - x124*x34 + x124*x46 - x124*x8 - x126 + x128 + x129 - x130 - x131*x18 + x131*x23 - x131*x29 - x131*x3 + x131*x45 - x132*x15 + x132*x24 - x132*x31 + x132*x44 - x132*x6 + x132*x9 + x133*x41 - x133*x49 + x134*x7 + x137*x21 - x137*x25 - x138*x21 + x138*x25 - x139*x41 + x139*x49 + x140 - x141 - x142 + x143 + x144 - x145 - x146 + x147 + x148*x22 - x148*x26 + x148*x34 - x148*x46 + x148*x8 - x149*x20 - x149*x41 + x149*x49 + x15*x51 + x15*x52 - x15*x53 + x15*x56 + x15*x57 - x15*x59 - x15*x60 - x15*x61 + x15*x62 - x150*x7 - x151*x33 + x151*x37 - x152*x41 + x152*x49 - x153*x7 + x154*x41 - x154*x49 - x155 + x156 + x157 - x158 - x161*x33 + x161*x37 - x162*x21 + x162*x25 + x163*x41 - x163*x49 - x164*x33 + x164*x37 - x165*x21 + x165*x25 + x166*x41 - x166*x49 + x167*x33 - x167*x37 + x168*x21 - x168*x25 - x169*x41 + x169*x49 + x170*x33 - x170*x37 + x171*x21 - x171*x25 - x172*x41 + x172*x49 + x173*x33 - x173*x37 + x174*x21 - x174*x25 - x175*x41 + x175*x49 - x176*x33 + x176*x37 - x177*x21 + x177*x25 + x178*x41 - x178*x49 + x18*x51 + x18*x52 - x18*x53 + x18*x56 + x18*x57 - x18*x59 - x18*x60 - x18*x61 + x18*x62 - x20*x75 + x20*x90 + x21*x85 - x21*x94 + x22*x51 + x22*x52 - x22*x53 + x22*x56 + x22*x57 - x22*x59 - x22*x60 - x22*x61 + x22*x62 + x22*x97 - x23*x51 - x23*x52 + x23*x53 - x23*x56 - x23*x57 + x23*x59 + x23*x60 + x23*x61 - x23*x62 - x24*x51 - x24*x52 + x24*x53 - x24*x56 - x24*x57 + x24*x59 + x24*x60 + x24*x61 - x24*x62 - x25*x85 + x25*x94 - x26*x51 - x26*x52 + x26*x53 - x26*x56 - x26*x57 + x26*x59 + x26*x60 + x26*x61 - x26*x62 - x26*x97 + x29*x51 + x29*x52 - x29*x53 + x29*x56 + x29*x57 - x29*x59 - x29*x60 - x29*x61 + x29*x62 + x3*x51 + x3*x52 - x3*x53 + x3*x56 + x3*x57 - x3*x59 - x3*x60 - x3*x61 + x3*x62 + x31*x51 + x31*x52 - x31*x53 + x31*x56 + x31*x57 - x31*x59 - x31*x60 - x31*x61 + x31*x62 + x34*x51 + x34*x52 - x34*x53 + x34*x56 + x34*x57 - x34*x59 - x34*x60 - x34*x61 + x34*x62 + x34*x97 + x38*x51 + x38*x52 - x38*x53 + x38*x56 + x38*x57 - x38*x59 - x38*x60 - x38*x61 + x38*x62 + x40*x51 + x40*x52 - x40*x53 + x40*x56 + x40*x57 - x40*x59 - x40*x60 - x40*x61 + x40*x62 - x41*x75 + x41*x90 - x41*x93 + x43*x51 + x43*x52 - x43*x53 + x43*x56 + x43*x57 - x43*x59 - x43*x60 - x43*x61 + x43*x62 - x44*x51 - x44*x52 + x44*x53 - x44*x56 - x44*x57 + x44*x59 + x44*x60 + x44*x61 - x44*x62 - x45*x51 - x45*x52 + x45*x53 - x45*x56 - x45*x57 + x45*x59 + x45*x60 + x45*x61 - x45*x62 - x46*x51 - x46*x52 + x46*x53 - x46*x56 - x46*x57 + x46*x59 + x46*x60 + x46*x61 - x46*x62 - x46*x97 - x47*x51 - x47*x52 + x47*x53 - x47*x56 - x47*x57 + x47*x59 + x47*x60 + x47*x61 - x47*x62 - x48*x51 - x48*x52 + x48*x53 - x48*x56 - x48*x57 + x48*x59 + x48*x60 + x48*x61 - x48*x62 + x49*x75 - x49*x90 + x49*x93 - x50*x51 - x50*x52 + x50*x53 - x50*x56 - x50*x57 + x50*x59 + x50*x60 + x50*x61 - x50*x62 + x51*x6 + x51*x8 - x51*x9 + x52*x6 + x52*x8 - x52*x9 - x53*x6 - x53*x8 + x53*x9 + x56*x6 + x56*x8 - x56*x9 + x57*x6 + x57*x8 - x57*x9 - x59*x6 - x59*x8 + x59*x9 - x6*x60 - x6*x61 + x6*x62 - x60*x8 + x60*x9 - x61*x8 + x61*x9 + x62*x8 - x62*x9 - x68*x69 + x68*x82 + x69*x73 + x69*x88 - x7*x72 + x7*x84 - x7*x86 + x7*x95 + x70*x71 - x70*x83 - x71*x74 - x71*x89 - x73*x82 + x74*x83 - x79*x80 + x79*x81 + x79*x91 - x79*x92 + x8*x97 + x80*x87 - x81*x87 - x82*x88 + x83*x89 - x87*x91 + x87*x92)/(2*(-x10 - x11 + x15 + x18 + x22 - x23 - x24 - x26 + x29 + x3 + x31 + x34 + x38 + x40 + x43 - x44 - x45 - x46 - x47 - x48 - x50 + x6 + x8 - x9))

    return X


def tc_integral_square_wave(V_delay,delta_t,V_tank,Q,N_bf,N_af,rs,recoil_prob,t0,t,N_e,Q_external,eff, **kwargs):
    x0 = Q_external**2
    x1 = lambda_a*lambda_b*x0
    x2 = lambda_a*x0
    x3 = V_delay - V_tank
    x4 = x0*x3
    x5 = lambda_a**2
    x6 = V_delay*V_tank*x3
    x7 = Q_external*lambda_a
    x8 = V_delay**2
    x9 = V_tank**2
    x10 = x8 - x9
    x11 = x10*x7
    x12 = -x11 + x4 + x5*x6
    x13 = -x12*x2
    x14 = lambda_b**3
    x15 = V_delay*V_tank*x14
    x16 = Q_external*lambda_b
    x17 = Q_external**3
    x18 = x17*x3
    x19 = V_delay**3
    x20 = V_tank**3
    x21 = x19 - x20
    x22 = x21*x5
    x23 = lambda_a**3
    x24 = V_delay*V_tank*x10
    x25 = -Q_external*x22 + x18 + x23*x24
    x26 = lambda_b**2
    x27 = x10*x17
    x28 = x3*x8*x9
    x29 = -x2*x21 + x23*x28 + x27
    x30 = x26*x29
    x31 = x12*x15 + x13 + x16*x25 - x30
    x32 = x1*x31
    x33 = lambda_c**4
    x34 = V_delay*V_tank*x33
    x35 = Q_external*lambda_c
    x36 = Q_external*x26
    x37 = Q_external**4
    x38 = Q_external*x23
    x39 = V_delay**4 - V_tank**4
    x40 = lambda_a**4
    x41 = V_delay*V_tank*x21*x40 + x3*x37 - x38*x39
    x42 = lambda_b**4
    x43 = V_delay*V_tank*x42
    x44 = x0*x5
    x45 = x8*x9
    x46 = x10*x37 + x10*x40*x45 - x39*x44
    x47 = x35*(-x12*x17*x5 - x14*x46 + x25*x43 + x36*x41)
    x48 = lambda_c**2
    x49 = lambda_b*x0
    x50 = lambda_a*x17
    x51 = x20*x40
    x52 = x19*x3*x51 + x21*x37 - x39*x50
    x53 = x48*(-x14*x52 - x25*x50 + x29*x43 + x41*x49)
    x54 = lambda_c**3
    x55 = x54*(x12*x42*x45 + x16*x46 - x2*x29 - x26*x52)
    x56 = x31*x34 + x32 - x47 + x53 - x55
    x57 = 1/V_delay
    x58 = Q_external*x57
    x59 = 1/V_tank
    x60 = Q_external*x59
    x61 = lambda_a + x58 + x60
    x62 = lambda_b + x61
    x63 = lambda_c + x62
    x64 = t - t0
    x65 = abs(x64)
    x66 = t/2 - t0/2 + x65/2
    x67 = N_af + N_bf
    x68 = x12*x67
    x69 = Q_external*lambda_a*lambda_b
    x70 = lambda_a*x67
    x71 = N_af*lambda_a*recoil_prob
    x72 = 2*lambda_a*x17*x26*(N_bf*lambda_c*x31 - V_delay*V_tank*lambda_a*x14*x68 - x25*x67*x69 + x30*x70 + x31*x71 + x44*x68)
    x73 = lambda_a*x4
    x74 = Q_external*x10
    x75 = N_bf*lambda_b
    x76 = -x12*x75 + x23*x6*x67 - x5*x67*x74 + x67*x73
    x77 = V_delay*V_tank*x54
    x78 = x40*x67
    x79 = lambda_a*x10
    x80 = 2*lambda_a*lambda_c*x17*(x2*x76 - x35*(x18*x70 - x21*x38*x67 + x24*x78 - x25*x75) + x48*(-x0*x22*x67 + x17*x67*x79 + x28*x78 - x29*x75) + x71*(x12*x77 + x13 + x25*x35 - x29*x48) - x76*x77)
    x81 = Q_external*(x57 + x59)
    x82 = x14*x6
    x83 = Q_external*x3 + x79
    x84 = V_delay*lambda_a
    x85 = V_tank*x3
    x86 = x84*x85
    x87 = x74 + x86
    x88 = 2*Q_external
    x89 = V_delay*x88 - V_tank*x88 + x79
    x90 = x8*x88 + x86 - x88*x9
    x91 = 2*x0
    x92 = V_delay*x91 - V_tank*x91 + x11 + x22
    x93 = V_tank*x5
    x94 = V_tank*x8
    x95 = V_delay*x9
    x96 = V_delay*x10*x93 + x7*(x21 + x94 - x95) + x8*x91 - x9*x91
    x97 = Q_external*x84
    x98 = x5*x8
    x99 = x3*x9
    x100 = V_tank*x10*x97 + x19*x91 - x20*x91 + x98*x99
    x101 = V_delay*x26
    x102 = -lambda_b*x74 + x101*x85 + x4
    x103 = x14*x8
    x104 = 2*N_af*x17*(-lambda_b*lambda_c*recoil_prob*(-x102*x49 + x102*x77 + x35*(x10*x15 + x18 - x21*x36) - x48*(x103*x99 - x21*x49 + x27)) - x1*(-x16*x83 + x26*x87 + x73 - x82) - x34*(-x16*x89 + x26*x90 + x73 - 2*x82) + x35*(x14*x96 + x18*x5 - x36*x92 - x43*x89) + x48*(-x100*x14 + x43*x90 + x49*x92 - x50*x83) - x54*(-x100*x26 + x16*x96 - x2*x87 + 2*x28*x42))
    x105 = exp(x60*x66)
    x106 = N_af*lambda_b*x0*x5
    x107 = -Q_external
    x108 = V_tank*lambda_a
    x109 = x107 + x108
    x110 = V_delay + V_tank
    x111 = x110*x5
    x112 = -V_tank*x111 + x0 + x97
    x113 = -x0*x110
    x114 = x113 + x5*x95 + x7*x9
    x115 = N_af*x0*x5
    x116 = V_tank*x14
    x117 = N_bf*V_tank
    x118 = 2*N_af + N_bf
    x119 = V_delay*x118
    x120 = x117 + x119
    x121 = x120*x7
    x122 = N_bf*x0 + x119*x93
    x123 = -x121 + x122
    x124 = N_af - N_bf
    x125 = x0*x124
    x126 = N_af*V_tank
    x127 = x119 + x126
    x128 = x121 + x125 - x127*x93
    x129 = N_bf*x17
    x130 = Q_external*x124
    x131 = x5*x9
    x132 = x118*x23
    x133 = -x127*x2 + x129 + x130*x131 + x132*x95
    x134 = lambda_a*lambda_b*lambda_c*recoil_prob
    x135 = Q_external - x108
    x136 = x0 - x131
    x137 = -V_tank*x135*x26 + lambda_b*x136 - x135*x7
    x138 = x20*x23
    x139 = -x138 + x17
    x140 = Q_external*lambda_a*lambda_c
    x141 = N_af*x17*x5
    x142 = N_af*x17
    x143 = V_delay*x5
    x144 = N_af*V_delay
    x145 = V_tank*x144
    x146 = x118*x8
    x147 = N_af*x9 + x145 + x146
    x148 = Q_external*x120*x143 - V_tank*x147*x23 + x125*x84 + x142
    x149 = V_delay*x124 + x126
    x150 = Q_external*x131*x149 - x0*x127*x84 + x127*x23*x95 - x149*x17
    x151 = N_bf*V_delay
    x152 = Q_external*V_delay*x124*x138 + x115*x20 + x146*x51 - x147*x50 + x151*x37
    x153 = 2*x19*(-N_af*x134*x8*(V_tank*x137*x54 + lambda_c*(-x116*x136 - x135*x44 + x139*x26) - x137*x69 - x48*(lambda_b*x139 - x135*x14*x9 - x136*x7)) - x106*(-x109*x15 + x109*x2 + x112*x16 + x114*x26) + x140*(x128*x43 - x135*x141 + x14*x150 + x148*x36) - x34*(x109*x115 - x116*x123 + x128*x69 + x133*x26) + x48*(-x1*x148 + x112*x141 + x133*x43 - x14*x152) - x54*(-x114*x115 + x123*x42*x95 + x150*x69 - x152*x26))
    x154 = x107 + x84
    x155 = Q_external*x108 - V_delay*x111 + x0
    x156 = x113 + x5*x94 + x7*x8
    x157 = V_delay*x14
    x158 = V_tank*x118
    x159 = x151 + x158
    x160 = x159*x7
    x161 = x122 - x160
    x162 = x144 + x158
    x163 = x125 - x143*x162 + x160
    x164 = x129 + x130*x98 + x132*x94 - x162*x2
    x165 = Q_external - x84
    x166 = x0 - x98
    x167 = lambda_b*x166 - x101*x165 - x165*x7
    x168 = x17 - x19*x23
    x169 = x118*x9
    x170 = N_af*x8 + x145 + x169
    x171 = Q_external*x159*x93 - V_delay*x170*x23 + x108*x125 + x142
    x172 = V_tank*x124
    x173 = x144 + x172
    x174 = Q_external*x173*x98 - x0*x108*x162 + x162*x23*x94 - x17*x173
    x175 = Q_external*x172*x19*x23 + x115*x19 + x117*x37 + x169*x19*x40 - x170*x50
    x176 = 2*x20*(-N_af*x134*x9*(V_delay*x167*x54 + lambda_c*(-x157*x166 - x165*x44 + x168*x26) - x167*x69 - x48*(lambda_b*x168 - x103*x165 - x166*x7)) - x106*(-x15*x154 + x154*x2 + x155*x16 + x156*x26) + x140*(x14*x174 - x141*x165 + x163*x43 + x171*x36) - x34*(x115*x154 - x157*x161 + x163*x69 + x164*x26) + x48*(-x1*x171 - x14*x175 + x141*x155 + x164*x43) - x54*(-x115*x156 + x161*x42*x94 + x174*x69 - x175*x26))
    x177 = Q_external*(-N_af*recoil_prob*x56 + V_tank*x119*x31*x33 + x118*x32 - x118*x47 + x118*x53 - x118*x55)
    x178 = delta_t - t + t0
    x179 = abs(x178)
    x180 = delta_t/2 - t/2 + t0/2 - x179/2
    x181 = exp(-x180*x60)
    X = N_e*Q*eff*rs*((lambda_c*(lambda_b*(lambda_a*(x105*x153 + (x105*x177*(x64 + x65) - x176)*exp(x58*x66))*exp(lambda_a*x66) + x104*exp(x66*x81))*exp(lambda_b*x66) + x80*exp(x61*x66))*exp(lambda_c*x66) - x72*exp(x62*x66))*exp(-x63*x66) - (lambda_c*(lambda_b*(lambda_a*(x153*x181 - (x176 + x177*x181*(x178 - x179))*exp(-x180*x58))*exp(-lambda_a*x180) + x104*exp(-x180*x81))*exp(-lambda_b*x180) + x80*exp(-x180*x61))*exp(-lambda_c*x180) - x72*exp(-x180*x62))*exp(x180*x63))/(2*Q_external*lambda_a*lambda_b*lambda_c*x56)

    return X


def steady_state_count_rate(rs,recoil_prob,V_tank,Q,lamp,eff, **kwargs):
    x0 = V_tank/Q
    x1 = lambda_a*x0
    x2 = lambda_b*x0
    x3 = lamp*x0
    x4 = lambda_a*lambda_b
    x5 = lambda_a - lambda_b
    x6 = lambda_a**2
    x7 = lambda_b**2
    x8 = exp(x1)
    x9 = exp(x2)
    x10 = x9*(lambda_a - 2*lambda_b)
    x11 = lambda_b + lamp
    x12 = x8*exp(x3)
    X = -Q*eff*rs*(lambda_b*x10 + lamp*(lambda_a*x8 + x10) - recoil_prob*x5*x9*(-x11*x12 + x11) - x12*x9*(2*lamp*x5 + x4 + x6 - 2*x7) + x6*x8)*exp(-x1)*exp(-x2)*exp(-x3)/(lamp**2*x5 + lamp*(x6 - x7) + x4*x5)

    return X


