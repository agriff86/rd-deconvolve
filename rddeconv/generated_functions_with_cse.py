
"""
Functions generated using Sage

Total count functions (tf_*) assume an inlet radon concentration of 1 Bq/m3
i.e. the result should be multiplied by the inlet radon concentration in
Bq/m3, converted from ambient temperature and pressure to the temperature
and pressure inside the radon detector.
"""

from numpy import exp
from numpy import sqrt
from numpy import abs

lambda_r = 2.100140526711101e-6
lambda_a = 0.003787689511256532
lambda_b = 0.0004310616794527023
lambda_c = 0.0005805252768508755
def calc_na_nb_factors(Q,lamp,V_tank, **kwargs):
    N_af = lambda_r*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q)/lambda_r - 1/lambda_r)*exp(-V_tank*lamp/Q)/(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q))
    N_bf = -lambda_r*(lambda_a**2*exp(V_tank*lambda_a/Q)/lambda_r - lambda_a*lambda_b*exp(V_tank*lambda_b/Q)/lambda_r + lamp*(lambda_a*exp(V_tank*lambda_a/Q)/lambda_r - lambda_a*exp(V_tank*lambda_b/Q)/lambda_r) - (lambda_a**2*exp(V_tank*lambda_a/Q)/lambda_r - lambda_a*lambda_b*exp(V_tank*lambda_a/Q)/lambda_r)*exp(V_tank*lambda_b/Q + V_tank*lamp/Q))*exp(-V_tank*lamp/Q)/(lamp**2*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + lamp*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + (lambda_a**2*lambda_b*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q))

    return N_af,N_bf


def num_filter_atoms_steady_state(rs,recoil_prob,V_tank,Q,lamp, **kwargs):
    Na = Q*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_a*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q)))
    Nb = -Q*recoil_prob*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_b*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q))) - Q*rs*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_b/Q) + lamp*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_a*exp(V_tank*lambda_b/Q)) - (lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q + V_tank*lamp/Q))*exp(-V_tank*lamp/Q)/(lambda_b*(lamp**2*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + lamp*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + (lambda_a**2*lambda_b*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q))) + Q*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_b*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q)))
    Nc = -Q*recoil_prob*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_c*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q))) - Q*rs*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_b/Q) + lamp*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_a*exp(V_tank*lambda_b/Q)) - (lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q + V_tank*lamp/Q))*exp(-V_tank*lamp/Q)/(lambda_c*(lamp**2*(lambda_a*exp(V_tank*lambda_a/Q) - lambda_b*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + lamp*(lambda_a**2*exp(V_tank*lambda_a/Q) - lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q) + (lambda_a**2*lambda_b*exp(V_tank*lambda_a/Q) - lambda_a*lambda_b**2*exp(V_tank*lambda_a/Q))*exp(V_tank*lambda_b/Q))) + Q*rs*(exp(V_tank*lambda_a/Q + V_tank*lamp/Q) - 1)*exp(-V_tank*lamp/Q)/(lambda_c*(lambda_a*exp(V_tank*lambda_a/Q) + lamp*exp(V_tank*lambda_a/Q)))

    return Na,Nb,Nc


def tc_integral_filter_activity(N_d0,V_tank,Q,a0,b0,N_bf,N_af,c0,V_delay,rs,recoil_prob,N_r0,Q_external,eff,t, **kwargs):
    X = -eff*((-(((rs*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0))) + lambda_b**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_c**4*(lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_b**3*(N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**2*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf)))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**2*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**3*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af - N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))))) + lambda_c**3*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b**4*(N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**2*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf)))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**3*V_tank**3 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**4*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af - N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf))) - lambda_a**2*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf))))) - lambda_c**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b**4*(N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**2*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) + lambda_b**3*(N_bf*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*V_delay**3*V_tank**5*(2*N_af + N_bf) + Q*V_delay**4*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(2*N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af - N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**3*V_tank**3 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**3*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)))) + lambda_c*(lambda_a**4*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b**4*(lambda_a**3*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af - N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf)))) + lambda_b**3*(lambda_a**4*(N_r0*Q*Q_external*V_delay**2*V_tank**5*(2*N_af + N_bf) + Q*Q_external*V_delay**4*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external*V_delay**3*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_a**3*(N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af - N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf))) - lambda_a**2*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_r0 + N_d0*(N_af - N_bf)))) - lambda_b**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_r0*Q*Q_external**2*V_delay*V_tank**5*(2*N_af + N_bf) + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) + Q*Q_external**2*V_delay**2*V_tank**4*(N_d0*(2*N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_r0*Q*Q_external**3*V_tank**5*(2*N_af + N_bf) + Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_bf*N_r0) + Q*Q_external**3*V_delay*V_tank**4*(-2*N_af*N_r0 + N_d0*(2*N_af + N_bf))) - lambda_a**2*(N_r0*Q*Q_external**4*V_tank**4*(N_af - N_bf) + Q*Q_external**4*V_delay*V_tank**3*(N_d0*(N_af - N_bf) - N_r0*(N_af - N_bf))) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_tank**3 + Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)))) - recoil_prob*(lambda_c**4*(lambda_b**3*(lambda_a**2*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**2*(lambda_a**3*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0)))) - lambda_c**3*(lambda_b**4*(lambda_a**2*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**2*(lambda_a**4*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0)))) + lambda_c**2*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*V_delay**3*V_tank**5 + Q*V_delay**4*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0)))) - lambda_c*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**2*V_tank**5 + Q*Q_external*V_delay**3*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))) + lambda_b**2*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay*V_tank**5 + Q*Q_external**2*V_delay**2*V_tank**4*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_tank**5 + Q*Q_external**3*V_delay*V_tank**4*(N_af*N_d0 - N_af*N_r0))))))*exp(Q_external*t/V_delay) - rs*(lambda_b**4*(-N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**3) - lambda_b**3*(N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**4 - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank)) - lambda_b**2*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**2 + N_af*N_d0*Q*Q_external**4*V_delay**4*lambda_a**3 - lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2)) - lambda_b*(-N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**3 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank*lambda_a**4) - lambda_c**4*(-N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**3 - lambda_b**3*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*V_delay**5*V_tank**3*lambda_a**2*(2*N_af + N_bf) - lambda_a*(N_bf*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf))) + lambda_b**2*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**2*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**3*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf))) + lambda_b*(N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a*(N_af - N_bf) - lambda_a**3*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**2*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf)))) + lambda_c**3*(N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2*lambda_a**4 - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank) - lambda_b**4*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*V_delay**5*V_tank**3*lambda_a**2*(2*N_af + N_bf) - lambda_a*(N_bf*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf))) + lambda_b**2*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3*lambda_a**2 + N_bf*N_d0*Q*Q_external**4*V_delay**4 + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**3*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**4*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2 + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf))) - lambda_b*(lambda_a**4*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af - N_bf)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank + N_d0*Q*Q_external**4*V_delay**4*(N_af - N_bf)))) + lambda_c**2*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**2 + N_af*N_d0*Q*Q_external**4*V_delay**4*lambda_a**3 - lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2) + lambda_b**4*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**2*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**3*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf))) - lambda_b**3*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3*lambda_a**2 + N_bf*N_d0*Q*Q_external**4*V_delay**4 + N_d0*Q*Q_external*V_delay**4*V_tank**3*lambda_a**3*(N_af - N_bf) + N_d0*Q*V_delay**5*V_tank**3*lambda_a**4*(2*N_af + N_bf) - lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_af*N_d0*Q*Q_external**3*V_delay**3*V_tank**2 + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf))) - lambda_b*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a + N_d0*Q*Q_external**4*V_delay**4*lambda_a**2*(N_af - N_bf) - lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)))) + lambda_c*(-N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a**3 + N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank*lambda_a**4 + lambda_b**4*(N_d0*Q*Q_external**3*V_delay**4*V_tank*lambda_a*(N_af - N_bf) - lambda_a**3*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**2*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf))) + lambda_b**3*(lambda_a**4*(N_af*N_d0*Q*Q_external*V_delay**4*V_tank**3 + N_d0*Q*Q_external*V_delay**5*V_tank**2*(2*N_af + N_bf)) + lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af - N_bf)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank + N_d0*Q*Q_external**4*V_delay**4*(N_af - N_bf))) + lambda_b**2*(N_af*N_d0*Q*Q_external**5*V_delay**3*lambda_a + N_d0*Q*Q_external**4*V_delay**4*lambda_a**2*(N_af - N_bf) - lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 + N_af*N_d0*Q*Q_external**2*V_delay**3*V_tank**3 + N_d0*Q*Q_external**2*V_delay**5*V_tank*(2*N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank + N_d0*Q*Q_external**3*V_delay**5*(2*N_af + N_bf)))) - recoil_prob*(lambda_c**4*(lambda_b**3*(-N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**2) - lambda_b**2*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**3) + lambda_b*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**3)) - lambda_c**3*(lambda_b**4*(-N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**2) - lambda_b**2*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**4) + lambda_b*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**4)) + lambda_c**2*(lambda_b**4*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**3) - lambda_b**3*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a + N_af*N_d0*Q*V_delay**5*V_tank**3*lambda_a**4) + lambda_b*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**4)) - lambda_c*(lambda_b**4*(-N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**3) - lambda_b**3*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**2 + N_af*N_d0*Q*Q_external*V_delay**5*V_tank**2*lambda_a**4) + lambda_b**2*(-N_af*N_d0*Q*Q_external**3*V_delay**5*lambda_a**3 + N_af*N_d0*Q*Q_external**2*V_delay**5*V_tank*lambda_a**4))))*exp(Q_external*t/V_tank))*exp(lambda_a*t) - (lambda_b**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_c**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - 2*lambda_b**3*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_b**2*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(2*Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - 2*Q_external**3*V_delay*V_tank**4) + 2*a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay**3*V_tank**2 + Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + 2*a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) + lambda_c**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - 2*lambda_b**4*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_b**2*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(2*Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - 2*Q_external**4*V_tank**4) + 2*a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) - lambda_b*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_delay**3*V_tank + Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + 2*a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) - lambda_c**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(2*Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - 2*Q_external**3*V_delay*V_tank**4) + 2*a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**3*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(2*Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - 2*Q_external**4*V_tank**4) + 2*a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) - lambda_b*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + 2*a0*(Q_external**7*V_delay - Q_external**7*V_tank))) + lambda_c*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay**3*V_tank**2 + Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + 2*a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) + lambda_b**3*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_delay**3*V_tank + Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + 2*a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) - lambda_b**2*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + 2*a0*(Q_external**7*V_delay - Q_external**7*V_tank))) - recoil_prob*(lambda_c**4*(lambda_b**3*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**2*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b*(a0*lambda_a**2*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_c**3*(lambda_b**4*(a0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**2*(a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_b*(a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) + lambda_c**2*(lambda_b**4*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b**3*(a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - a0*lambda_a*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_b*(a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*(Q_external**7*V_delay - Q_external**7*V_tank))) - lambda_c*(lambda_b**4*(a0*lambda_a**2*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*(Q_external**7*V_delay - Q_external**7*V_tank)))) - rs*(lambda_b**4*(lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3)) + lambda_b**2*(lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) - lambda_a**2*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_b*(lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2) - lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_c**4*(lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) + 2*lambda_b**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(2*N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - 2*N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + 2*N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - 2*N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a**2*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0))) + lambda_b*(2*N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - 2*Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - 2*N_af*N_r0)))) + lambda_c**3*(lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) + 2*lambda_b**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(2*N_af*N_d0*Q*Q_external**4*V_delay**4 - 2*N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + 2*N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a**2*(Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(-N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - 2*N_af*N_r0))) + lambda_b*(2*N_af*N_d0*Q*Q_external**5*V_delay**3 - 2*N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + 2*N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - 2*N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a**2*(Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)))) - lambda_c**2*(lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) - lambda_a**2*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) + lambda_b**4*(2*N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - 2*N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + 2*N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - 2*N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a**2*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(2*N_af*N_d0*Q*Q_external**4*V_delay**4 - 2*N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + 2*N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) + lambda_a**2*(Q*Q_external**2*V_delay**4*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(-N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 + Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - 2*N_af*N_r0))) + lambda_b*(2*N_af*N_d0*Q*Q_external**6*V_delay**2 - 2*N_af*N_r0*Q*Q_external**6*V_tank**2 - 2*Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0)))) + lambda_c*(lambda_a**3*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2) - lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) + lambda_b**4*(2*N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - 2*N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - 2*Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - 2*N_af*N_r0))) - lambda_b**3*(2*N_af*N_d0*Q*Q_external**5*V_delay**3 - 2*N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + 2*N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - 2*N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a**3*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a**2*(Q*Q_external**3*V_delay**4*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**3*V_delay**2*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 + Q*Q_external**4*V_delay**3*V_tank*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0))) + lambda_b**2*(2*N_af*N_d0*Q*Q_external**6*V_delay**2 - 2*N_af*N_r0*Q*Q_external**6*V_tank**2 - 2*Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_af*N_d0 - N_af*N_r0)) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_af*N_d0 - 2*N_af*N_r0)))) + recoil_prob*(lambda_c**4*(lambda_b**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) + lambda_b*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3))) - lambda_c**3*(lambda_b**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4)) - lambda_b**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4)) + lambda_b*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3))) + lambda_c**2*(lambda_b**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) - lambda_b**3*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4 - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4)) + lambda_b*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_b**4*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3)) - lambda_b**3*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3 - lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0) - lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))))))*exp(Q_external*t/V_tank + Q_external*t/V_delay))*exp(lambda_b*t) + (lambda_c**4*(lambda_a**3*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(b0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - b0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**2*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) - lambda_b*(a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + lambda_a**3*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)))) - lambda_c**3*(lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) - lambda_b**3*(b0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - b0*lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + lambda_a**4*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_a*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) - lambda_b*(b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)))) + lambda_c**2*(lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b**3*(b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - b0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) + lambda_b**2*(-b0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**3*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_b*(-b0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4)) - lambda_a**3*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)))) - lambda_c*(lambda_a**4*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_a**3*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_a**2*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b**3*(b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**2*(a0*lambda_a**3*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - b0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3))) - lambda_b*(a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)))) - recoil_prob*(lambda_c**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + lambda_b**2*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*lambda_a*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3))) - lambda_c**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_b**2*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3))) + lambda_c**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_b**2*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**3*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) - lambda_c*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_b**2*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**3*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)))) + rs*(lambda_c**4*(lambda_a**3*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) - lambda_b*(N_bf*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a*(-N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf))))) - lambda_c**3*(lambda_a**4*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf)) + lambda_b**2*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 + lambda_a**3*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) - lambda_b*(N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_tank**3 + lambda_a**4*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(N_r0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a*(-N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank + N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf))))) + lambda_c**2*(lambda_a**4*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a**3*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_b**2*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2 + lambda_a**3*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) - lambda_b*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - N_bf*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + Q*Q_external**3*V_delay**4*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf))) - lambda_a**2*(N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf)))) - lambda_c*(lambda_a**4*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf)) + lambda_a**2*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) + lambda_b**2*(lambda_a**3*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2)) - lambda_b*(lambda_a**4*(N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**3*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(-N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank + N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf))) + lambda_a*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0)))) - recoil_prob*(lambda_c**4*(lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_b*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3))) - lambda_c**3*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3))) + lambda_c**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) - lambda_a**3*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_a**4*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) + lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0)) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))))))*exp(Q_external*t/V_tank + Q_external*t/V_delay + lambda_a*t))*exp(lambda_c*t) + (lambda_b**4*(lambda_a**3*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_b**3*(lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_a**2*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) + lambda_b**2*(lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) + lambda_a*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + c0*(Q_external**7*V_delay - Q_external**7*V_tank))) - lambda_b*(lambda_a**4*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_a**3*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_a**2*(a0*(Q_external**7*V_delay - Q_external**7*V_tank) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + c0*(Q_external**7*V_delay - Q_external**7*V_tank))) - lambda_c**4*(c0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - c0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + c0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_b**3*(c0*lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - c0*lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_b**2*(c0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - c0*lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b*(c0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - c0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) + lambda_c**3*(c0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - c0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - lambda_b**4*(b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + c0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + lambda_a**2*(b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + c0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a*(b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4))) + lambda_b**3*(b0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - b0*lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(-b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - c0*lambda_a*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)) - lambda_b*(-b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**2*(b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)))) - lambda_c**2*(c0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + c0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_b**4*(a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + c0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) + lambda_b**3*(b0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + c0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a**4*(a0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + b0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) + c0*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_a*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) - c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) - lambda_b**2*(-b0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**3*(a0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) + lambda_a*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) + lambda_b*(b0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - c0*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) - lambda_a**3*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a**2*(a0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)))) + lambda_c*(c0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - c0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + c0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) + lambda_a**3*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) + lambda_b**3*(b0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + c0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**4*(a0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + b0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + c0*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) - lambda_a**2*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_b**2*(-b0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + b0*(Q_external**7*V_delay - Q_external**7*V_tank) + c0*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + b0*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + c0*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) - lambda_a**3*(a0*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + b0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4) + c0*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) + lambda_a*(a0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2))) + lambda_b*(a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + b0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) + lambda_a**4*(a0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + b0*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_a**3*(a0*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + b0*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3)))) - recoil_prob*(lambda_b**4*(a0*lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + a0*lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b*(a0*lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - a0*lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + a0*lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank)) + lambda_c**2*(lambda_b**4*(a0*lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) + a0*lambda_a*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3)) - lambda_b**3*(a0*lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**3*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - a0*lambda_a**3*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + a0*lambda_a**2*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_b**4*(a0*lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) + a0*lambda_a*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3)) - lambda_b**3*(a0*lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - a0*lambda_a**2*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3)) + lambda_b**2*(a0*lambda_a**4*(Q_external**3*V_delay**4*V_tank + Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 - Q_external**3*V_delay*V_tank**4) - a0*lambda_a**3*(Q_external**4*V_delay**4 + Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 - Q_external**4*V_tank**4) + a0*lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) - lambda_b*(a0*lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - a0*lambda_a**3*(Q_external**5*V_delay**3 + Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 - Q_external**5*V_tank**3) + a0*lambda_a**2*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)))) + rs*(lambda_b**4*(lambda_a**3*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b**3*(lambda_a**4*(N_d0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf) - Q*Q_external**2*V_delay**3*V_tank**3*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**2*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf))) + lambda_b**2*(lambda_a**4*(N_d0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_d0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a**3*(N_d0*Q*Q_external**4*V_delay**4*(N_af + N_bf) - N_d0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) + N_r0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_tank**4*(N_af + N_bf)) + lambda_a*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf)))) - lambda_b*(lambda_a**4*(N_d0*Q*Q_external**4*V_delay**3*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**4*V_delay*V_tank**3*(N_af + N_bf) - Q*Q_external**4*V_delay**2*V_tank**2*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf))) - lambda_a**3*(N_d0*Q*Q_external**5*V_delay**3*(N_af + N_bf) - N_d0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf) + N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_tank**3*(N_af + N_bf)) + lambda_a**2*(N_d0*Q*Q_external**6*V_delay**2*(N_af + N_bf) - N_r0*Q*Q_external**6*V_tank**2*(N_af + N_bf) - Q*Q_external**6*V_delay*V_tank*(N_d0*(N_af + N_bf) - N_r0*(N_af + N_bf)))) + lambda_c**2*(lambda_b**4*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4)) - lambda_b**3*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 + lambda_a**3*(N_bf*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_bf*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) + lambda_b**2*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2 + lambda_a**3*(N_bf*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(N_bf*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4)) - lambda_b*(lambda_a**3*(N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_bf*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a*(N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_delay*V_tank**2))) - lambda_c*(lambda_b**4*(N_bf*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**3*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 + Q*Q_external**2*V_delay**4*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a*(-N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + N_bf*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_bf*N_r0*Q*Q_external**3*V_delay*V_tank**4 - Q*Q_external**3*V_delay**2*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf)))) - lambda_b**3*(N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_bf*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_bf*N_r0*Q*Q_external**5*V_tank**3 + lambda_a**4*(N_r0*Q*Q_external*V_delay**4*V_tank**3*(N_af + N_bf) - N_r0*Q*Q_external*V_delay**3*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_bf*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_bf*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(N_r0*Q*Q_external**3*V_delay**4*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay*V_tank**4*(N_af + N_bf)) - lambda_a*(-N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank + N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_r0*Q*Q_external**4*V_tank**4 - Q*Q_external**4*V_delay*V_tank**3*(N_bf*N_d0 - N_r0*(N_af + N_bf)))) + lambda_b**2*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0) + lambda_a**4*(N_r0*Q*Q_external**2*V_delay**4*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**2*V_delay**2*V_tank**4*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4 - N_bf*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_bf*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 + Q*Q_external**3*V_delay**4*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf))) - lambda_a**2*(N_bf*N_d0*Q*Q_external**4*V_delay**4 - N_bf*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_bf*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_bf*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_r0*Q*Q_external**5*V_delay**2*V_tank*(N_af + N_bf) - N_r0*Q*Q_external**5*V_delay*V_tank**2*(N_af + N_bf))) - lambda_b*(lambda_a**4*(N_r0*Q*Q_external**3*V_delay**3*V_tank**2*(N_af + N_bf) - N_r0*Q*Q_external**3*V_delay**2*V_tank**3*(N_af + N_bf)) + lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 + Q*Q_external**4*V_delay**3*V_tank*(N_bf*N_d0 - N_r0*(N_af + N_bf)) - Q*Q_external**4*V_delay**2*V_tank**2*(N_bf*N_d0 - N_bf*N_r0)) - lambda_a**2*(-N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank + N_bf*N_d0*Q*Q_external**5*V_delay**3 - N_bf*N_r0*Q*Q_external**5*V_tank**3 - Q*Q_external**5*V_delay*V_tank**2*(N_bf*N_d0 - N_r0*(N_af + N_bf))) + lambda_a*(N_bf*N_d0*Q*Q_external**6*V_delay**2 - N_bf*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_bf*N_d0 - N_bf*N_r0)))) - recoil_prob*(lambda_b**4*(lambda_a**3*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0))) - lambda_b**3*(lambda_a**4*(N_af*N_d0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4 - Q*Q_external**2*V_delay**3*V_tank**3*(N_af*N_d0 - N_af*N_r0)) - lambda_a**2*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3)) + lambda_b**2*(lambda_a**4*(N_af*N_d0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_d0*Q*Q_external**3*V_delay**2*V_tank**3 + N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) - lambda_a**3*(N_af*N_d0*Q*Q_external**4*V_delay**4 - N_af*N_d0*Q*Q_external**4*V_delay*V_tank**3 + N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_tank**4) + lambda_a*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_b*(lambda_a**4*(N_af*N_d0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3 - Q*Q_external**4*V_delay**2*V_tank**2*(N_af*N_d0 - N_af*N_r0)) - lambda_a**3*(N_af*N_d0*Q*Q_external**5*V_delay**3 - N_af*N_d0*Q*Q_external**5*V_delay*V_tank**2 + N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_tank**3) + lambda_a**2*(N_af*N_d0*Q*Q_external**6*V_delay**2 - N_af*N_r0*Q*Q_external**6*V_tank**2 - Q*Q_external**6*V_delay*V_tank*(N_af*N_d0 - N_af*N_r0))) - lambda_c*(lambda_b**4*(lambda_a**3*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3)) - lambda_b**3*(lambda_a**4*(N_af*N_r0*Q*Q_external*V_delay**4*V_tank**3 - N_af*N_r0*Q*Q_external*V_delay**3*V_tank**4) - lambda_a**2*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3)) + lambda_b**2*(lambda_a**4*(N_af*N_r0*Q*Q_external**2*V_delay**4*V_tank**2 - N_af*N_r0*Q*Q_external**2*V_delay**2*V_tank**4) - lambda_a**3*(N_af*N_r0*Q*Q_external**3*V_delay**4*V_tank - N_af*N_r0*Q*Q_external**3*V_delay*V_tank**4) + lambda_a*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2)) - lambda_b*(lambda_a**4*(N_af*N_r0*Q*Q_external**3*V_delay**3*V_tank**2 - N_af*N_r0*Q*Q_external**3*V_delay**2*V_tank**3) - lambda_a**3*(N_af*N_r0*Q*Q_external**4*V_delay**3*V_tank - N_af*N_r0*Q*Q_external**4*V_delay*V_tank**3) + lambda_a**2*(N_af*N_r0*Q*Q_external**5*V_delay**2*V_tank - N_af*N_r0*Q*Q_external**5*V_delay*V_tank**2))))))*exp(Q_external*t/V_tank + Q_external*t/V_delay + lambda_a*t + lambda_b*t))*exp(-Q_external*t/V_tank - Q_external*t/V_delay - lambda_a*t - lambda_b*t - lambda_c*t)/(lambda_b**4*(lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2)) - lambda_b**3*(lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2)) + lambda_b**2*(lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_b*(lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank)) - lambda_c**4*(lambda_a**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) + lambda_a*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_b**3*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) + lambda_b**2*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 + lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) - lambda_b*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 + lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4))) + lambda_c**3*(lambda_a**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3) - lambda_a**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) - lambda_b**4*(Q_external**3*V_delay**3*V_tank**2 - Q_external**3*V_delay**2*V_tank**3 + lambda_a**2*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4)) + lambda_b**2*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3 + lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) - lambda_b*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2 + lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) - lambda_c**2*(lambda_a**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3) - lambda_a**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3) + lambda_a*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(Q_external**4*V_delay**3*V_tank - Q_external**4*V_delay*V_tank**3 + lambda_a**3*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_b**3*(Q_external**5*V_delay**3 - Q_external**5*V_tank**3 + lambda_a**4*(Q_external*V_delay**4*V_tank**3 - Q_external*V_delay**3*V_tank**4) - lambda_a*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) - lambda_b*(Q_external**7*V_delay - Q_external**7*V_tank + lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4))) + lambda_c*(lambda_a**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2) - lambda_a**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2) + lambda_a**2*(Q_external**7*V_delay - Q_external**7*V_tank) - lambda_b**4*(Q_external**5*V_delay**2*V_tank - Q_external**5*V_delay*V_tank**2 + lambda_a**3*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4)) + lambda_b**3*(Q_external**6*V_delay**2 - Q_external**6*V_tank**2 + lambda_a**4*(Q_external**2*V_delay**4*V_tank**2 - Q_external**2*V_delay**2*V_tank**4) - lambda_a**2*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)) - lambda_b**2*(Q_external**7*V_delay - Q_external**7*V_tank + lambda_a**4*(Q_external**3*V_delay**4*V_tank - Q_external**3*V_delay*V_tank**4) - lambda_a**3*(Q_external**4*V_delay**4 - Q_external**4*V_tank**4)))) + (Q_external*a0*recoil_prob - 2*Q_external*a0 - Q_external*b0 - Q_external*c0 - rs*(N_d0*Q*V_delay*(2*N_af + N_bf) + N_r0*Q*V_tank*(2*N_af + N_bf) - recoil_prob*(N_af*N_d0*Q*V_delay + N_af*N_r0*Q*V_tank)))/Q_external)

    return X


def tc_integral_filter_activity_nodelay(V_tank,Q,a0,b0,N_bf,N_af,c0,rs,recoil_prob,N_r0,t,Q_external,eff, **kwargs):
    X = -eff*((-(-(rs*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**3*lambda_b + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**2*lambda_b**3 - lambda_b**2*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**2 + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**3) - lambda_c**3*(N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**2 + lambda_b**2*(-N_bf*N_r0*Q*Q_external*V_tank**3 + N_r0*Q*V_tank**4*lambda_a*(2*N_af + N_bf)) - lambda_b*(N_r0*Q*Q_external*V_tank**3*lambda_a*(N_af - N_bf) + N_r0*Q*V_tank**4*lambda_a**2*(2*N_af + N_bf))) + lambda_c**2*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**2 + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**3 + lambda_b**3*(-N_bf*N_r0*Q*Q_external*V_tank**3 + N_r0*Q*V_tank**4*lambda_a*(2*N_af + N_bf)) - lambda_b*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + N_r0*Q*Q_external*V_tank**3*lambda_a**2*(N_af - N_bf) + N_r0*Q*V_tank**4*lambda_a**3*(2*N_af + N_bf))) - lambda_c*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**3 + lambda_b**3*(N_r0*Q*Q_external*V_tank**3*lambda_a*(N_af - N_bf) + N_r0*Q*V_tank**4*lambda_a**2*(2*N_af + N_bf)) - lambda_b**2*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + N_r0*Q*Q_external*V_tank**3*lambda_a**2*(N_af - N_bf) + N_r0*Q*V_tank**4*lambda_a**3*(2*N_af + N_bf))) - recoil_prob*(lambda_c**3*(N_af*N_r0*Q*V_tank**4*lambda_a**2*lambda_b - N_af*N_r0*Q*V_tank**4*lambda_a*lambda_b**2) - lambda_c**2*(N_af*N_r0*Q*V_tank**4*lambda_a**3*lambda_b - N_af*N_r0*Q*V_tank**4*lambda_a*lambda_b**3) + lambda_c*(N_af*N_r0*Q*V_tank**4*lambda_a**3*lambda_b**2 - N_af*N_r0*Q*V_tank**4*lambda_a**2*lambda_b**3)))*exp(lambda_a*t) + (lambda_b**3*(-Q_external**3*V_tank*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**2) - lambda_b**2*(-Q_external**4*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**3) + lambda_b*(-Q_external**4*a0*lambda_a**2 + Q_external**3*V_tank*a0*lambda_a**3) - lambda_c**3*(-Q_external**3*V_tank*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**2 + 2*lambda_b**2*(-Q_external**2*V_tank**2*a0 + Q_external*V_tank**3*a0*lambda_a) - lambda_b*(-2*Q_external**3*V_tank*a0 + Q_external**2*V_tank**2*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**2)) + lambda_c**2*(-Q_external**4*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**3 + 2*lambda_b**3*(-Q_external**2*V_tank**2*a0 + Q_external*V_tank**3*a0*lambda_a) - lambda_b*(-2*Q_external**4*a0 + Q_external**3*V_tank*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**3)) - lambda_c*(-Q_external**4*a0*lambda_a**2 + Q_external**3*V_tank*a0*lambda_a**3 + lambda_b**3*(-2*Q_external**3*V_tank*a0 + Q_external**2*V_tank**2*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**2) - lambda_b**2*(-2*Q_external**4*a0 + Q_external**3*V_tank*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**3)) + recoil_prob*(lambda_c**3*(lambda_b**2*(-Q_external**2*V_tank**2*a0 + Q_external*V_tank**3*a0*lambda_a) - lambda_b*(-Q_external**3*V_tank*a0 + Q_external**2*V_tank**2*a0*lambda_a)) - lambda_c**2*(lambda_b**3*(-Q_external**2*V_tank**2*a0 + Q_external*V_tank**3*a0*lambda_a) - lambda_b*(-Q_external**4*a0 + Q_external**3*V_tank*a0*lambda_a)) + lambda_c*(lambda_b**3*(-Q_external**3*V_tank*a0 + Q_external**2*V_tank**2*a0*lambda_a) - lambda_b**2*(-Q_external**4*a0 + Q_external**3*V_tank*a0*lambda_a))) - rs*(N_af*N_r0*Q*Q_external**3*V_tank*lambda_a**2*lambda_b + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a*lambda_b**3 - lambda_b**2*(N_af*N_r0*Q*Q_external**3*V_tank*lambda_a + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**2) - lambda_c**3*(N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + 2*N_af*N_r0*Q*Q_external*V_tank**3*lambda_b**2 - lambda_b*(2*N_af*N_r0*Q*Q_external**2*V_tank**2 + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a)) + lambda_c**2*(N_af*N_r0*Q*Q_external**3*V_tank*lambda_a + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**2 + 2*N_af*N_r0*Q*Q_external*V_tank**3*lambda_b**3 - lambda_b*(2*N_af*N_r0*Q*Q_external**3*V_tank + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**2)) - lambda_c*(N_af*N_r0*Q*Q_external**3*V_tank*lambda_a**2 + lambda_b**3*(2*N_af*N_r0*Q*Q_external**2*V_tank**2 + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a) - lambda_b**2*(2*N_af*N_r0*Q*Q_external**3*V_tank + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**2)) + recoil_prob*(lambda_c**3*(-N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_b + N_af*N_r0*Q*Q_external*V_tank**3*lambda_b**2) - lambda_c**2*(-N_af*N_r0*Q*Q_external**3*V_tank*lambda_b + N_af*N_r0*Q*Q_external*V_tank**3*lambda_b**3) + lambda_c*(-N_af*N_r0*Q*Q_external**3*V_tank*lambda_b**2 + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_b**3))))*exp(Q_external*t/V_tank))*exp(lambda_b*t) + (lambda_c**3*(lambda_a**2*(Q_external**2*V_tank**2*a0 + Q_external**2*V_tank**2*b0) - lambda_a*(Q_external**3*V_tank*a0 + Q_external**3*V_tank*b0) + lambda_b**2*(-Q_external**2*V_tank**2*b0 + Q_external*V_tank**3*b0*lambda_a) + lambda_b*(Q_external**3*V_tank*b0 + Q_external**2*V_tank**2*a0*lambda_a - lambda_a**2*(Q_external*V_tank**3*a0 + Q_external*V_tank**3*b0))) - lambda_c**2*(lambda_a**3*(Q_external**2*V_tank**2*a0 + Q_external**2*V_tank**2*b0) - lambda_a*(Q_external**4*a0 + Q_external**4*b0) + lambda_b**2*(-Q_external**3*V_tank*b0 + Q_external*V_tank**3*b0*lambda_a**2) - lambda_b*(-Q_external**4*b0 + Q_external**2*V_tank**2*b0*lambda_a**2 + lambda_a**3*(Q_external*V_tank**3*a0 + Q_external*V_tank**3*b0) - lambda_a*(Q_external**3*V_tank*a0 + Q_external**3*V_tank*b0))) + lambda_c*(lambda_a**3*(Q_external**3*V_tank*a0 + Q_external**3*V_tank*b0) - lambda_a**2*(Q_external**4*a0 + Q_external**4*b0) + lambda_b**2*(-Q_external**3*V_tank*b0*lambda_a + Q_external**2*V_tank**2*b0*lambda_a**2) + lambda_b*(Q_external**4*b0*lambda_a + Q_external**3*V_tank*a0*lambda_a**2 - lambda_a**3*(Q_external**2*V_tank**2*a0 + Q_external**2*V_tank**2*b0))) - recoil_prob*(lambda_c**3*(-Q_external**3*V_tank*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**2 - lambda_b*(-Q_external**2*V_tank**2*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**2)) - lambda_c**2*(-Q_external**4*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**3 - lambda_b*(-Q_external**3*V_tank*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**3)) + lambda_c*(-Q_external**4*a0*lambda_a**2 + Q_external**3*V_tank*a0*lambda_a**3 - lambda_b*(-Q_external**3*V_tank*a0*lambda_a**2 + Q_external**2*V_tank**2*a0*lambda_a**3))) + rs*(lambda_c**3*(-N_r0*Q*Q_external**2*V_tank**2*lambda_a*(N_af + N_bf) + N_r0*Q*Q_external*V_tank**3*lambda_a**2*(N_af + N_bf) - lambda_b*(-N_bf*N_r0*Q*Q_external**2*V_tank**2 + N_bf*N_r0*Q*Q_external*V_tank**3*lambda_a)) - lambda_c**2*(-N_r0*Q*Q_external**3*V_tank*lambda_a*(N_af + N_bf) + N_r0*Q*Q_external*V_tank**3*lambda_a**3*(N_af + N_bf) - lambda_b*(-N_bf*N_r0*Q*Q_external**3*V_tank + N_bf*N_r0*Q*Q_external*V_tank**3*lambda_a**2)) + lambda_c*(-N_r0*Q*Q_external**3*V_tank*lambda_a**2*(N_af + N_bf) + N_r0*Q*Q_external**2*V_tank**2*lambda_a**3*(N_af + N_bf) - lambda_b*(-N_bf*N_r0*Q*Q_external**3*V_tank*lambda_a + N_bf*N_r0*Q*Q_external**2*V_tank**2*lambda_a**2)) - recoil_prob*(lambda_c**3*(-N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**2) - lambda_c**2*(-N_af*N_r0*Q*Q_external**3*V_tank*lambda_a + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**3) + lambda_c*(-N_af*N_r0*Q*Q_external**3*V_tank*lambda_a**2 + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**3))))*exp(Q_external*t/V_tank + lambda_a*t))*exp(lambda_c*t) + (lambda_b**3*(lambda_a**2*(Q_external**2*V_tank**2*a0 + Q_external**2*V_tank**2*b0 + Q_external**2*V_tank**2*c0) - lambda_a*(Q_external**3*V_tank*a0 + Q_external**3*V_tank*b0 + Q_external**3*V_tank*c0)) - lambda_b**2*(lambda_a**3*(Q_external**2*V_tank**2*a0 + Q_external**2*V_tank**2*b0 + Q_external**2*V_tank**2*c0) - lambda_a*(Q_external**4*a0 + Q_external**4*b0 + Q_external**4*c0)) + lambda_b*(lambda_a**3*(Q_external**3*V_tank*a0 + Q_external**3*V_tank*b0 + Q_external**3*V_tank*c0) - lambda_a**2*(Q_external**4*a0 + Q_external**4*b0 + Q_external**4*c0)) - lambda_c**3*(-Q_external**3*V_tank*c0*lambda_a + Q_external**2*V_tank**2*c0*lambda_a**2 + lambda_b**2*(-Q_external**2*V_tank**2*c0 + Q_external*V_tank**3*c0*lambda_a) - lambda_b*(-Q_external**3*V_tank*c0 + Q_external*V_tank**3*c0*lambda_a**2)) + lambda_c**2*(-Q_external**4*c0*lambda_a + Q_external**2*V_tank**2*c0*lambda_a**3 - lambda_b**3*(Q_external**2*V_tank**2*b0 + Q_external**2*V_tank**2*c0 - lambda_a*(Q_external*V_tank**3*b0 + Q_external*V_tank**3*c0)) - lambda_b**2*(-Q_external**3*V_tank*b0 + Q_external*V_tank**3*b0*lambda_a**2) - lambda_b*(-Q_external**4*c0 + Q_external**3*V_tank*b0*lambda_a - Q_external**2*V_tank**2*b0*lambda_a**2 + Q_external*V_tank**3*c0*lambda_a**3)) - lambda_c*(-Q_external**4*c0*lambda_a**2 + Q_external**3*V_tank*c0*lambda_a**3 - lambda_b**3*(Q_external**3*V_tank*b0 + Q_external**3*V_tank*c0 + Q_external**2*V_tank**2*a0*lambda_a - lambda_a**2*(Q_external*V_tank**3*a0 + Q_external*V_tank**3*b0 + Q_external*V_tank**3*c0)) - lambda_b**2*(-Q_external**4*b0 - Q_external**4*c0 + Q_external**2*V_tank**2*b0*lambda_a**2 + lambda_a**3*(Q_external*V_tank**3*a0 + Q_external*V_tank**3*b0 + Q_external*V_tank**3*c0) - lambda_a*(Q_external**3*V_tank*a0 + Q_external**3*V_tank*b0)) - lambda_b*(Q_external**4*b0*lambda_a + Q_external**3*V_tank*a0*lambda_a**2 - lambda_a**3*(Q_external**2*V_tank**2*a0 + Q_external**2*V_tank**2*b0))) - recoil_prob*(lambda_b**3*(-Q_external**3*V_tank*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**2) - lambda_b**2*(-Q_external**4*a0*lambda_a + Q_external**2*V_tank**2*a0*lambda_a**3) + lambda_b*(-Q_external**4*a0*lambda_a**2 + Q_external**3*V_tank*a0*lambda_a**3) - lambda_c*(lambda_b**3*(-Q_external**2*V_tank**2*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**2) - lambda_b**2*(-Q_external**3*V_tank*a0*lambda_a + Q_external*V_tank**3*a0*lambda_a**3) + lambda_b*(-Q_external**3*V_tank*a0*lambda_a**2 + Q_external**2*V_tank**2*a0*lambda_a**3))) + rs*(lambda_b**3*(-N_r0*Q*Q_external**2*V_tank**2*lambda_a*(N_af + N_bf) + N_r0*Q*Q_external*V_tank**3*lambda_a**2*(N_af + N_bf)) - lambda_b**2*(-N_r0*Q*Q_external**3*V_tank*lambda_a*(N_af + N_bf) + N_r0*Q*Q_external*V_tank**3*lambda_a**3*(N_af + N_bf)) + lambda_b*(-N_r0*Q*Q_external**3*V_tank*lambda_a**2*(N_af + N_bf) + N_r0*Q*Q_external**2*V_tank**2*lambda_a**3*(N_af + N_bf)) - lambda_c*(lambda_b**3*(-N_bf*N_r0*Q*Q_external**2*V_tank**2 + N_bf*N_r0*Q*Q_external*V_tank**3*lambda_a) - lambda_b**2*(-N_bf*N_r0*Q*Q_external**3*V_tank + N_bf*N_r0*Q*Q_external*V_tank**3*lambda_a**2) + lambda_b*(-N_bf*N_r0*Q*Q_external**3*V_tank*lambda_a + N_bf*N_r0*Q*Q_external**2*V_tank**2*lambda_a**2)) - recoil_prob*(lambda_b**3*(-N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**2) - lambda_b**2*(-N_af*N_r0*Q*Q_external**3*V_tank*lambda_a + N_af*N_r0*Q*Q_external*V_tank**3*lambda_a**3) + lambda_b*(-N_af*N_r0*Q*Q_external**3*V_tank*lambda_a**2 + N_af*N_r0*Q*Q_external**2*V_tank**2*lambda_a**3))))*exp(Q_external*t/V_tank + lambda_a*t + lambda_b*t))*exp(-Q_external*t/V_tank - lambda_a*t - lambda_b*t - lambda_c*t)/(lambda_b**3*(-Q_external**3*V_tank*lambda_a + Q_external**2*V_tank**2*lambda_a**2) - lambda_b**2*(-Q_external**4*lambda_a + Q_external**2*V_tank**2*lambda_a**3) + lambda_b*(-Q_external**4*lambda_a**2 + Q_external**3*V_tank*lambda_a**3) - lambda_c**3*(-Q_external**3*V_tank*lambda_a + Q_external**2*V_tank**2*lambda_a**2 + lambda_b**2*(-Q_external**2*V_tank**2 + Q_external*V_tank**3*lambda_a) - lambda_b*(-Q_external**3*V_tank + Q_external*V_tank**3*lambda_a**2)) + lambda_c**2*(-Q_external**4*lambda_a + Q_external**2*V_tank**2*lambda_a**3 + lambda_b**3*(-Q_external**2*V_tank**2 + Q_external*V_tank**3*lambda_a) - lambda_b*(-Q_external**4 + Q_external*V_tank**3*lambda_a**3)) - lambda_c*(-Q_external**4*lambda_a**2 + Q_external**3*V_tank*lambda_a**3 + lambda_b**3*(-Q_external**3*V_tank + Q_external*V_tank**3*lambda_a**2) - lambda_b**2*(-Q_external**4 + Q_external*V_tank**3*lambda_a**3))) + (Q_external*a0*recoil_prob - 2*Q_external*a0 - Q_external*b0 - Q_external*c0 + rs*(N_af*N_r0*Q*V_tank*recoil_prob - N_r0*Q*V_tank*(2*N_af + N_bf)))/Q_external)

    return X


def tc_integral_delta(V_delay,rs,recoil_prob,V_tank,Q,N_bf,N_af,Q_external,eff,t, **kwargs):
    x0 = 2*N_af
    x1 = -N_bf
    x2 = 1/V_delay
    x3 = Q_external*x2
    x4 = 1/V_tank
    x5 = Q_external*x4
    x6 = lambda_a + x3 + x5
    x7 = lambda_b + x6
    x8 = Q_external**4
    x9 = lambda_b*x8
    x10 = lambda_a**2
    x11 = Q_external**2
    x12 = V_delay - V_tank
    x13 = x11*x12
    x14 = V_delay*V_tank*x12
    x15 = Q_external*lambda_a
    x16 = V_delay**2
    x17 = V_tank**2
    x18 = x16 - x17
    x19 = x15*x18
    x20 = x10*x14 - x19
    x21 = x13 + x20
    x22 = lambda_b**4
    x23 = V_delay*V_tank*lambda_a*x11*x22
    x24 = Q_external**3
    x25 = lambda_b**2
    x26 = lambda_a*x24*x25
    x27 = x12*x24
    x28 = V_delay**3
    x29 = V_tank**3
    x30 = x28 - x29
    x31 = x10*x30
    x32 = lambda_a**3
    x33 = V_delay*V_tank*x18
    x34 = -Q_external*x31 + x32*x33
    x35 = x27 + x34
    x36 = lambda_b**3
    x37 = lambda_a*x11*x36
    x38 = x18*x24
    x39 = x11*x30
    x40 = x12*x16*x17
    x41 = -lambda_a*x39 + x32*x40
    x42 = x38 + x41
    x43 = V_delay*V_tank*lambda_c**4
    x44 = lambda_a*x12
    x45 = x44*x8
    x46 = V_delay*V_tank*x11*x12
    x47 = -x10*x38
    x48 = V_delay*V_tank
    x49 = V_delay*x11
    x50 = V_tank*x11
    x51 = x20 + x49 - x50
    x52 = x36*x48*x51
    x53 = Q_external*lambda_b
    x54 = V_delay*x24 - V_tank*x24 + x34
    x55 = x53*x54
    x56 = x16*x24 - x17*x24 + x41
    x57 = x25*x56
    x58 = Q_external*lambda_c
    x59 = Q_external**5
    x60 = x10*x12
    x61 = V_tank*x12
    x62 = lambda_a**4
    x63 = V_delay*x24*x62
    x64 = x32*x8
    x65 = Q_external*x25
    x66 = Q_external*x32
    x67 = V_delay**4 - V_tank**4
    x68 = V_delay*x8 - V_tank*x8 + x30*x48*x62 - x66*x67
    x69 = V_delay*V_tank*x22
    x70 = x10*x11
    x71 = x16*x17*x62
    x72 = x16*x8 - x17*x8 + x18*x71 - x67*x70
    x73 = lambda_c**2
    x74 = V_tank*x18
    x75 = lambda_b*x11
    x76 = lambda_a*x24
    x77 = x29*x62
    x78 = x12*x28*x77 + x28*x8 - x29*x8 - x67*x76
    x79 = lambda_c**3
    x80 = lambda_a*x18
    x81 = N_af + N_bf
    x82 = x21*x81
    x83 = Q_external*lambda_a*lambda_b
    x84 = lambda_a*x81
    x85 = x25*x42
    x86 = N_af*lambda_a*recoil_prob
    x87 = lambda_a*x11
    x88 = -x21*x87
    x89 = V_delay*V_tank*x21
    x90 = N_bf*lambda_b
    x91 = lambda_a*x13
    x92 = Q_external*x18
    x93 = -x10*x81*x92 + x14*x32*x81 + x81*x91
    x94 = V_delay*V_tank*x79
    x95 = x62*x81
    x96 = x24*x80
    x97 = V_delay*lambda_a
    x98 = x61*x97
    x99 = 2*Q_external
    x100 = V_delay*x99 - V_tank*x99 + x80
    x101 = x16*x99 - x17*x99 + x98
    x102 = x19 + x31 + 2*x49 - 2*x50
    x103 = 2*x11
    x104 = V_tank*x10
    x105 = V_tank*x16
    x106 = V_delay*x17
    x107 = V_delay*x104*x18 + x103*x16 - x103*x17 + x15*(x105 - x106 + x30)
    x108 = Q_external*x97
    x109 = x10*x16
    x110 = x12*x17
    x111 = x103*x28 - x103*x29 + x108*x74 + x109*x110
    x112 = -lambda_b*x92 + x13 + x14*x25
    x113 = x16*x36
    x114 = -Q_external
    x115 = V_tank*lambda_a
    x116 = x114 + x115
    x117 = N_af*lambda_b*x32*x8
    x118 = N_af*V_delay*V_tank*x22
    x119 = x116*x70
    x120 = N_af*x10*x24*x25
    x121 = V_delay + V_tank
    x122 = x10*x121
    x123 = N_af*x10*x11*x36
    x124 = -x11*x121
    x125 = N_af*x24
    x126 = -x10*x125
    x127 = N_af*V_tank
    x128 = x11*x32
    x129 = V_tank*x36
    x130 = N_bf*V_tank
    x131 = N_bf + x0
    x132 = V_delay*x131
    x133 = x130 + x132
    x134 = x133*x15
    x135 = N_bf*x11 + x104*x132
    x136 = -x134 + x135
    x137 = N_af + x1
    x138 = x11*x137
    x139 = x127 + x132
    x140 = -x104*x139 + x134 + x138
    x141 = N_bf*x24
    x142 = Q_external*x137
    x143 = x10*x17
    x144 = x131*x32
    x145 = x106*x144 - x139*x87 + x141 + x142*x143
    x146 = N_af*lambda_a*lambda_b*lambda_c*recoil_prob
    x147 = -x11
    x148 = x143 + x147
    x149 = V_tank*x116*x25 - lambda_b*x148 + x116*x15
    x150 = -x24
    x151 = x29*x32
    x152 = x150 + x151
    x153 = Q_external*lambda_a*lambda_c
    x154 = N_af*x10
    x155 = x154*x8
    x156 = -x155
    x157 = x24*x32
    x158 = V_delay*x10
    x159 = N_af*V_delay
    x160 = V_tank*x159
    x161 = x131*x16
    x162 = N_af*x17 + x160 + x161
    x163 = Q_external*x133*x158 - V_tank*x162*x32 + x125 + x138*x97
    x164 = V_delay*x137 + x127
    x165 = Q_external*x143*x164 + x106*x139*x32 - x11*x139*x97 - x164*x24
    x166 = x154*x59
    x167 = x121*x24*x62
    x168 = lambda_a*lambda_b*x11
    x169 = N_bf*V_delay
    x170 = N_af*x10*x11
    x171 = Q_external*V_delay*x137*x151 + x161*x77 - x162*x76 + x169*x8 + x170*x29
    x172 = N_af*x24*x32
    x173 = -x121*x155
    x174 = x11*x62
    x175 = x114 + x97
    x176 = x175*x70
    x177 = V_delay*x36
    x178 = V_tank*x131
    x179 = x169 + x178
    x180 = x15*x179
    x181 = x135 - x180
    x182 = x159 + x178
    x183 = x138 - x158*x182 + x180
    x184 = x105*x144 + x109*x142 + x141 - x182*x87
    x185 = x109 + x147
    x186 = V_delay*x175*x25 - lambda_b*x185 + x15*x175
    x187 = x150 + x28*x32
    x188 = x131*x17
    x189 = N_af*x16 + x160 + x188
    x190 = Q_external*x104*x179 - V_delay*x189*x32 + x115*x138 + x125
    x191 = V_tank*x137
    x192 = x159 + x191
    x193 = Q_external*x109*x192 + x105*x182*x32 - x11*x115*x182 - x192*x24
    x194 = Q_external*x191*x28*x32 + x130*x8 + x170*x28 + x188*x28*x62 - x189*x76
    X = -Q*eff*rs*(N_af*recoil_prob - x0 + x1 - (x75*(N_bf*lambda_c*(x52 + x55 - x57 + x88) - V_delay*V_tank*lambda_a*x36*x82 - x35*x81*x83 + x70*x82 + x84*x85 + x86*(x35*x53 + x36*x89 - x85 + x88))*exp(t*x7) + (-lambda_c*x11*(-x58*(x27*x84 - x30*x66*x81 + x33*x95 - x54*x90) + x73*(-x11*x31*x81 + x40*x95 - x56*x90 + x81*x96) + x86*(x35*x58 - x42*x73 + x79*x89 + x88) + x87*(-x21*x90 + x93) - x94*(-x51*x90 + x93))*exp(t*x6) + (N_af*x11*(lambda_b*lambda_c*recoil_prob*(-x112*x75 + x112*x94 + x58*(x27 - x30*x65 + x33*x36) - x73*(-lambda_b*x39 + x110*x113 + x38)) - x12*x23 - x26*(Q_external*x12 + x80) + x37*(x92 + x98) - x43*(x100*x53 - x101*x25 + 2*x14*x36 - x91) + x58*(-x10*x27 + x100*x69 + x102*x65 - x107*x36) + x60*x9 - x73*(x101*x69 + x102*x75 - x111*x36 - x45 + x47) + x79*(-x10*x46 + x107*x53 - x111*x25 + 2*x22*x40 - x96))*exp(Q_external*t*(x2 + x4)) + (x16*(x116*x117 - x118*x119 + x120*(-V_tank*x122 + x108 + x11) + x123*(x10*x106 + x124 + x15*x17) + x146*x16*(V_tank*x149*x79 + lambda_c*(x119 + x129*x148 - x152*x25) - x149*x83 - x73*(-lambda_b*x152 + x116*x17*x36 + x148*x15)) - x153*(x127*x157 + x140*x69 + x156 + x163*x65 + x165*x36) + x43*(x126 + x127*x128 - x129*x136 + x140*x83 + x145*x25) - x73*(-x127*x167 + x145*x69 + x159*x64 - x163*x168 + x166 - x171*x36) - x79*(N_af*V_delay*x17*x174 - x106*x136*x22 - x165*x83 + x17*x172 + x171*x25 + x173))*exp(t*x5) - x17*(x117*x175 - x118*x176 + x120*(Q_external*x115 - V_delay*x122 + x11) + x123*(x10*x105 + x124 + x15*x16) + x146*x17*(V_delay*x186*x79 + lambda_c*(x176 + x177*x185 - x187*x25) - x186*x83 - x73*(-lambda_b*x187 + x113*x175 + x15*x185)) - x153*(x156 + x157*x159 + x183*x69 + x190*x65 + x193*x36) + x43*(x126 + x128*x159 - x177*x181 + x183*x83 + x184*x25) - x73*(x127*x64 - x159*x167 + x166 - x168*x190 + x184*x69 - x194*x36) - x79*(N_af*V_tank*x16*x174 - x105*x181*x22 + x16*x172 + x173 - x193*x83 + x194*x25))*exp(t*x3))*exp(lambda_a*t))*exp(lambda_b*t))*exp(lambda_c*t))*exp(-t*(lambda_c + x7))/(-x10*x21*x9 + x21*x23 + x26*x35 - x37*x42 - x43*(x32*x46 + x45 + x47 - x52 - x55 + x57) + x58*(-x18*x64 + x36*x72 - x54*x69 + x59*x60 + x61*x63 - x65*x68) - x73*(Q_external**6*x44 - x30*x64 + x36*x78 - x56*x69 + x63*x74 - x68*x75) + x79*(x13*x71 - x16*x17*x22*x51 + x25*x78 - x31*x8 - x53*x72 + x59*x80)))/Q_external

    return X


def tc_integral_calibration(Ncal,rs,recoil_prob,V_tank,Q,cal_begin,N_bf,N_af,t,Q_external,eff,cal_duration, **kwargs):
    x0 = lambda_c**2
    x1 = Q_external**3
    x2 = lambda_a*x1
    x3 = x0*x2
    x4 = lambda_a**2
    x5 = x1*x4
    x6 = lambda_b*x5
    x7 = lambda_b**2
    x8 = lambda_c*x1*x7
    x9 = x2*x7
    x10 = lambda_c*x5
    x11 = lambda_b*x0*x1
    x12 = lambda_b**3
    x13 = Q_external**2
    x14 = V_tank*lambda_a*x13
    x15 = x12*x14
    x16 = lambda_a**3
    x17 = V_tank*x13*x16
    x18 = lambda_c*x17
    x19 = V_tank*x13
    x20 = lambda_c**3
    x21 = lambda_b*x20
    x22 = x19*x21
    x23 = x14*x20
    x24 = lambda_b*x17
    x25 = lambda_c*x12
    x26 = x19*x25
    x27 = V_tank**2
    x28 = Q_external*x27*x4
    x29 = x20*x28
    x30 = Q_external*x16*x27
    x31 = x30*x7
    x32 = Q_external*x27
    x33 = x0*x12
    x34 = x32*x33
    x35 = V_tank**3
    x36 = lambda_a*x35
    x37 = x20*x7
    x38 = x36*x37
    x39 = x35*x4
    x40 = x25*x39
    x41 = lambda_b*x0
    x42 = x16*x35
    x43 = x41*x42
    x44 = x12*x28
    x45 = x0*x30
    x46 = x32*x37
    x47 = x33*x36
    x48 = x21*x39
    x49 = lambda_c*x7
    x50 = x42*x49
    x51 = N_bf*cal_duration
    x52 = 2*N_af*cal_duration
    x53 = N_af*cal_duration*recoil_prob
    x54 = cal_begin - t
    x55 = abs(x54)
    x56 = N_bf*x55
    x57 = 2*N_af*x55
    x58 = abs(cal_duration + x54)
    x59 = N_bf*x58
    x60 = N_af*recoil_prob*x55
    x61 = 2*N_af*x58
    x62 = N_af*recoil_prob*x58
    x63 = cal_begin/2
    x64 = -t/2
    x65 = -x55/2 + x63 + x64
    x66 = exp(lambda_a*x65)
    x67 = 2*N_af*lambda_a*x1*x66
    x68 = 2*N_bf*lambda_a*lambda_b*x1
    x69 = exp(lambda_c*x65)
    x70 = 2*N_bf*lambda_a*lambda_c*x1
    x71 = exp(lambda_b*x65)
    x72 = 2*N_af*x1*x66
    x73 = 2*N_bf*x1*x7
    x74 = 2*N_bf*x0*x1
    x75 = 2*N_af*V_tank*x13*x66
    x76 = cal_duration/2 - x58/2 + x63 + x64
    x77 = exp(lambda_a*x76)
    x78 = 2*N_af*lambda_a*x1*x77
    x79 = 2*N_bf*V_tank*x13
    x80 = x12*x69
    x81 = x20*x71
    x82 = exp(lambda_c*x76)
    x83 = exp(lambda_b*x76)
    x84 = 2*N_af*x1*x77
    x85 = 2*N_af*Q_external*x27*x66
    x86 = 2*N_af*V_tank*lambda_a*x13*x66
    x87 = 2*N_bf*Q_external*lambda_a*x27
    x88 = 2*N_bf*V_tank*lambda_b*x13*x4
    x89 = 2*N_bf*V_tank*lambda_c*x13*x4
    x90 = 2*N_af*V_tank*x13*x77
    x91 = x12*x82
    x92 = x20*x83
    x93 = 2*N_af*Q_external*lambda_a*x27*x66
    x94 = 2*N_af*Q_external*x27*x77
    x95 = 2*N_af*V_tank*lambda_a*x13*x77
    x96 = 1/lambda_a
    x97 = 4*N_af*x66*x96
    x98 = 1/lambda_b
    x99 = 2*N_af*x71*x98
    x100 = x3*x99
    x101 = 1/lambda_c
    x102 = 2*N_af*x101*x69
    x103 = x102*x9
    x104 = x10*x99
    x105 = x102*x6
    x106 = 2*N_bf*Q_external*x27*x4*x7
    x107 = 2*N_bf*Q_external*x0*x27*x4
    x108 = 2*N_bf*x71*x98
    x109 = 2*N_bf*x101*x69
    x110 = Q_external/V_tank
    x111 = exp(x110*x65)
    x112 = 2*N_af*Q_external*x111*x16*x27
    x113 = 2*N_af*lambda_a*x111*x35
    x114 = 2*N_bf*lambda_a*x111*x35
    x115 = 2*N_af*Q_external*lambda_a*x27*x77
    x116 = x23*x99
    x117 = x102*x15
    x118 = x18*x99
    x119 = x102*x24
    x120 = 2*N_af*recoil_prob*x66*x96
    x121 = 2*N_af*x111*x35*x4
    x122 = 2*N_af*x111*x16*x35
    x123 = 2*N_bf*x111*x35
    x124 = 4*N_af*x77*x96
    x125 = 2*N_af*x83*x98
    x126 = x125*x3
    x127 = 2*N_af*x101*x82
    x128 = x127*x9
    x129 = x10*x125
    x130 = x127*x6
    x131 = 2*N_bf*x83*x98
    x132 = 2*N_bf*x101*x82
    x133 = 2*N_af*Q_external*lambda_a*x111*x27
    x134 = 2*N_af*Q_external*x111*x27*x4
    x135 = exp(x110*x76)
    x136 = 2*N_af*Q_external*x135*x16*x27
    x137 = 2*N_af*lambda_a*x135*x35
    x138 = 2*N_bf*lambda_a*x135*x35
    x139 = 2*N_bf*x111*x35*x4
    x140 = x29*x99
    x141 = x102*x44
    x142 = x45*x99
    x143 = x102*x31
    x144 = x125*x23
    x145 = x127*x15
    x146 = x125*x18
    x147 = x127*x24
    x148 = 2*N_af*recoil_prob*x77*x96
    x149 = 2*N_af*x135*x35*x4
    x150 = 2*N_af*x135*x16*x35
    x151 = 2*N_bf*x135*x35
    x152 = 2*N_af*Q_external*lambda_a*x135*x27
    x153 = 2*N_af*Q_external*x135*x27*x4
    x154 = 2*N_bf*x135*x35*x4
    x155 = x125*x29
    x156 = x127*x44
    x157 = x125*x45
    x158 = x127*x31
    x159 = 1/Q_external
    x160 = V_tank**4
    x161 = 4*N_af*lambda_a*x111*x159*x160
    x162 = 4*N_af*x111*x159*x160*x4
    x163 = 4*N_af*x111*x159*x16*x160
    x164 = 2*N_bf*lambda_a*x111*x159*x160
    x165 = 2*N_bf*x111*x159*x160*x4
    x166 = 2*N_bf*x111*x159*x16*x160
    x167 = 2*N_af*lambda_a*recoil_prob*x111*x159*x160
    x168 = 2*N_af*recoil_prob*x111*x159*x160*x4
    x169 = 2*N_af*recoil_prob*x111*x159*x16*x160
    x170 = 4*N_af*lambda_a*x135*x159*x160
    x171 = 4*N_af*x135*x159*x160*x4
    x172 = 4*N_af*x135*x159*x16*x160
    x173 = 2*N_bf*lambda_a*x135*x159*x160
    x174 = 2*N_bf*x135*x159*x160*x4
    x175 = 2*N_bf*x135*x159*x16*x160
    x176 = 2*N_af*lambda_a*recoil_prob*x135*x159*x160
    x177 = 2*N_af*recoil_prob*x135*x159*x160*x4
    x178 = 2*N_af*recoil_prob*x135*x159*x16*x160
    X = Ncal*Q*eff*rs*(-lambda_b*x112 + lambda_b*x136 + lambda_b*x67 - lambda_b*x78 + lambda_c*x112 - lambda_c*x136 - lambda_c*x67 + lambda_c*x78 - recoil_prob*x100 + recoil_prob*x103 + recoil_prob*x104 - recoil_prob*x105 + recoil_prob*x116 - recoil_prob*x117 - recoil_prob*x118 + recoil_prob*x119 + recoil_prob*x126 - recoil_prob*x128 - recoil_prob*x129 + recoil_prob*x130 - recoil_prob*x140 + recoil_prob*x141 + recoil_prob*x142 - recoil_prob*x143 - recoil_prob*x144 + recoil_prob*x145 + recoil_prob*x146 - recoil_prob*x147 + recoil_prob*x155 - recoil_prob*x156 - recoil_prob*x157 + recoil_prob*x158 - x0*x122 - x0*x134 + x0*x150 + x0*x153 + x0*x72 - x0*x84 + x0*x86 - x0*x95 - x10*x108 + x10*x131 - x10*x51 - x10*x52 + x10*x53 - x10*x56 - x10*x57 + x10*x59 + x10*x60 + x10*x61 - x10*x62 + x100 - x103 - x104 + x105 - x106*x69 + x106*x82 + x107*x71 - x107*x83 + x108*x18 - x108*x23 + x108*x29 + x108*x3 - x108*x45 + x109*x15 - x109*x24 + x109*x31 - x109*x44 + x109*x6 - x109*x9 + x11*x120 + x11*x124 - x11*x148 - x11*x51 - x11*x52 + x11*x53 - x11*x56 - x11*x57 + x11*x59 + x11*x60 + x11*x61 - x11*x62 - x11*x97 - x113*x21 + x113*x25 + x114*x21 - x114*x25 + x115*x41 - x115*x49 - x116 + x117 + x118 - x119 - x12*x121 + x12*x149 + x12*x75 - x12*x90 - x120*x22 + x120*x26 - x120*x34 + x120*x46 - x120*x8 + x121*x20 + x121*x41 - x121*x49 + x122*x7 + x123*x33 - x123*x37 - x124*x22 + x124*x26 - x124*x34 + x124*x46 - x124*x8 - x126 + x128 + x129 - x130 - x131*x18 + x131*x23 - x131*x29 - x131*x3 + x131*x45 - x132*x15 + x132*x24 - x132*x31 + x132*x44 - x132*x6 + x132*x9 + x133*x41 - x133*x49 + x134*x7 + x137*x21 - x137*x25 - x138*x21 + x138*x25 - x139*x41 + x139*x49 + x140 - x141 - x142 + x143 + x144 - x145 - x146 + x147 + x148*x22 - x148*x26 + x148*x34 - x148*x46 + x148*x8 - x149*x20 - x149*x41 + x149*x49 + x15*x51 + x15*x52 - x15*x53 + x15*x56 + x15*x57 - x15*x59 - x15*x60 - x15*x61 + x15*x62 - x150*x7 - x151*x33 + x151*x37 - x152*x41 + x152*x49 - x153*x7 + x154*x41 - x154*x49 - x155 + x156 + x157 - x158 - x161*x33 + x161*x37 - x162*x21 + x162*x25 + x163*x41 - x163*x49 - x164*x33 + x164*x37 - x165*x21 + x165*x25 + x166*x41 - x166*x49 + x167*x33 - x167*x37 + x168*x21 - x168*x25 - x169*x41 + x169*x49 + x170*x33 - x170*x37 + x171*x21 - x171*x25 - x172*x41 + x172*x49 + x173*x33 - x173*x37 + x174*x21 - x174*x25 - x175*x41 + x175*x49 - x176*x33 + x176*x37 - x177*x21 + x177*x25 + x178*x41 - x178*x49 + x18*x51 + x18*x52 - x18*x53 + x18*x56 + x18*x57 - x18*x59 - x18*x60 - x18*x61 + x18*x62 - x20*x75 + x20*x90 + x21*x85 - x21*x94 + x22*x51 + x22*x52 - x22*x53 + x22*x56 + x22*x57 - x22*x59 - x22*x60 - x22*x61 + x22*x62 + x22*x97 - x23*x51 - x23*x52 + x23*x53 - x23*x56 - x23*x57 + x23*x59 + x23*x60 + x23*x61 - x23*x62 - x24*x51 - x24*x52 + x24*x53 - x24*x56 - x24*x57 + x24*x59 + x24*x60 + x24*x61 - x24*x62 - x25*x85 + x25*x94 - x26*x51 - x26*x52 + x26*x53 - x26*x56 - x26*x57 + x26*x59 + x26*x60 + x26*x61 - x26*x62 - x26*x97 + x29*x51 + x29*x52 - x29*x53 + x29*x56 + x29*x57 - x29*x59 - x29*x60 - x29*x61 + x29*x62 + x3*x51 + x3*x52 - x3*x53 + x3*x56 + x3*x57 - x3*x59 - x3*x60 - x3*x61 + x3*x62 + x31*x51 + x31*x52 - x31*x53 + x31*x56 + x31*x57 - x31*x59 - x31*x60 - x31*x61 + x31*x62 + x34*x51 + x34*x52 - x34*x53 + x34*x56 + x34*x57 - x34*x59 - x34*x60 - x34*x61 + x34*x62 + x34*x97 + x38*x51 + x38*x52 - x38*x53 + x38*x56 + x38*x57 - x38*x59 - x38*x60 - x38*x61 + x38*x62 + x40*x51 + x40*x52 - x40*x53 + x40*x56 + x40*x57 - x40*x59 - x40*x60 - x40*x61 + x40*x62 - x41*x75 + x41*x90 - x41*x93 + x43*x51 + x43*x52 - x43*x53 + x43*x56 + x43*x57 - x43*x59 - x43*x60 - x43*x61 + x43*x62 - x44*x51 - x44*x52 + x44*x53 - x44*x56 - x44*x57 + x44*x59 + x44*x60 + x44*x61 - x44*x62 - x45*x51 - x45*x52 + x45*x53 - x45*x56 - x45*x57 + x45*x59 + x45*x60 + x45*x61 - x45*x62 - x46*x51 - x46*x52 + x46*x53 - x46*x56 - x46*x57 + x46*x59 + x46*x60 + x46*x61 - x46*x62 - x46*x97 - x47*x51 - x47*x52 + x47*x53 - x47*x56 - x47*x57 + x47*x59 + x47*x60 + x47*x61 - x47*x62 - x48*x51 - x48*x52 + x48*x53 - x48*x56 - x48*x57 + x48*x59 + x48*x60 + x48*x61 - x48*x62 + x49*x75 - x49*x90 + x49*x93 - x50*x51 - x50*x52 + x50*x53 - x50*x56 - x50*x57 + x50*x59 + x50*x60 + x50*x61 - x50*x62 + x51*x6 + x51*x8 - x51*x9 + x52*x6 + x52*x8 - x52*x9 - x53*x6 - x53*x8 + x53*x9 + x56*x6 + x56*x8 - x56*x9 + x57*x6 + x57*x8 - x57*x9 - x59*x6 - x59*x8 + x59*x9 - x6*x60 - x6*x61 + x6*x62 - x60*x8 + x60*x9 - x61*x8 + x61*x9 + x62*x8 - x62*x9 - x68*x69 + x68*x82 + x69*x73 + x69*x88 - x7*x72 + x7*x84 - x7*x86 + x7*x95 + x70*x71 - x70*x83 - x71*x74 - x71*x89 - x73*x82 + x74*x83 - x79*x80 + x79*x81 + x79*x91 - x79*x92 + x8*x97 + x80*x87 - x81*x87 - x82*x88 + x83*x89 - x87*x91 + x87*x92)/(2*(-x10 - x11 + x15 + x18 + x22 - x23 - x24 - x26 + x29 + x3 + x31 + x34 + x38 + x40 + x43 - x44 - x45 - x46 - x47 - x48 - x50 + x6 + x8 - x9))

    return X


def tc_integral_calibration_w_delay(V_delay,Ncal,V_tank,Q,N_bf,N_af,rs,recoil_prob,t,cal_begin,Q_external,eff,cal_duration, **kwargs):
    x0 = lambda_c**2
    x1 = Q_external**6
    x2 = V_delay*lambda_a*x1
    x3 = x0*x2
    x4 = lambda_a**2
    x5 = V_delay*x1*x4
    x6 = lambda_b*x5
    x7 = V_delay*x1
    x8 = lambda_b**2
    x9 = lambda_c*x8
    x10 = x7*x9
    x11 = V_tank*lambda_a*x1
    x12 = x11*x8
    x13 = V_tank*x1*x4
    x14 = lambda_c*x13
    x15 = V_tank*x1
    x16 = lambda_b*x0
    x17 = x15*x16
    x18 = x2*x8
    x19 = lambda_c*x5
    x20 = x16*x7
    x21 = x0*x11
    x22 = lambda_b*x13
    x23 = x15*x9
    x24 = lambda_b**3
    x25 = Q_external**5
    x26 = V_delay**2
    x27 = lambda_a*x25*x26
    x28 = x24*x27
    x29 = lambda_a**3
    x30 = x25*x26*x29
    x31 = lambda_c*x30
    x32 = lambda_c**3
    x33 = lambda_b*x32
    x34 = x25*x26
    x35 = x33*x34
    x36 = V_tank**2
    x37 = lambda_a*x25*x36
    x38 = x32*x37
    x39 = x25*x29*x36
    x40 = lambda_b*x39
    x41 = lambda_c*x24
    x42 = x25*x36
    x43 = x41*x42
    x44 = x27*x32
    x45 = lambda_b*x30
    x46 = x34*x41
    x47 = x24*x37
    x48 = lambda_c*x39
    x49 = x33*x42
    x50 = lambda_b**4
    x51 = Q_external**4
    x52 = V_delay*lambda_a*x36*x51
    x53 = x50*x52
    x54 = lambda_a**4
    x55 = V_delay*x36*x51*x54
    x56 = lambda_c*x55
    x57 = lambda_c**4
    x58 = lambda_b*x57
    x59 = V_delay*x36*x51
    x60 = x58*x59
    x61 = V_tank*lambda_a*x26*x51
    x62 = x57*x61
    x63 = V_tank*x26*x51*x54
    x64 = lambda_b*x63
    x65 = lambda_c*x50
    x66 = V_tank*x26*x51
    x67 = x65*x66
    x68 = V_delay**3
    x69 = x4*x51*x68
    x70 = x32*x69
    x71 = x29*x51*x68
    x72 = x71*x8
    x73 = x51*x68
    x74 = x0*x24
    x75 = x73*x74
    x76 = V_tank**3
    x77 = x4*x51*x76
    x78 = x24*x77
    x79 = x29*x51*x76
    x80 = x0*x79
    x81 = x51*x76
    x82 = x32*x8
    x83 = x81*x82
    x84 = x52*x57
    x85 = lambda_b*x55
    x86 = x59*x65
    x87 = x50*x61
    x88 = lambda_c*x63
    x89 = x58*x66
    x90 = x24*x69
    x91 = x0*x71
    x92 = x73*x82
    x93 = x32*x77
    x94 = x79*x8
    x95 = x74*x81
    x96 = Q_external**3
    x97 = V_delay*x4*x76*x96
    x98 = x57*x97
    x99 = V_delay*x54*x76*x96
    x100 = x8*x99
    x101 = x0*x50
    x102 = V_delay*x76*x96
    x103 = x101*x102
    x104 = V_tank*x4*x68*x96
    x105 = x104*x50
    x106 = V_tank*x54*x68*x96
    x107 = x0*x106
    x108 = x57*x8
    x109 = V_tank*x68*x96
    x110 = x108*x109
    x111 = V_delay**4
    x112 = lambda_a*x111*x96
    x113 = x112*x82
    x114 = x111*x4*x96
    x115 = x114*x41
    x116 = x111*x29*x96
    x117 = x116*x16
    x118 = V_tank**4
    x119 = lambda_a*x118*x96
    x120 = x119*x74
    x121 = x118*x4*x96
    x122 = x121*x33
    x123 = x118*x29*x96
    x124 = x123*x9
    x125 = x50*x97
    x126 = x0*x99
    x127 = x102*x108
    x128 = x104*x57
    x129 = x106*x8
    x130 = x101*x109
    x131 = x112*x74
    x132 = x114*x33
    x133 = x116*x9
    x134 = x119*x82
    x135 = x121*x41
    x136 = x123*x16
    x137 = x32*x50
    x138 = Q_external*lambda_a*x118*x26
    x139 = x137*x138
    x140 = Q_external*x118*x26*x29
    x141 = x140*x58
    x142 = Q_external*x118*x26*x54
    x143 = x142*x41
    x144 = x24*x57
    x145 = Q_external*lambda_a*x111*x36
    x146 = x144*x145
    x147 = Q_external*x111*x29*x36
    x148 = x147*x65
    x149 = Q_external*x111*x36*x54
    x150 = x149*x33
    x151 = Q_external**2
    x152 = V_delay*lambda_a*x118*x151
    x153 = x108*x152
    x154 = V_delay*x118*x151*x4
    x155 = x154*x65
    x156 = V_delay*x118*x151*x54
    x157 = x156*x16
    x158 = V_tank*lambda_a*x111*x151
    x159 = x101*x158
    x160 = V_tank*x111*x151*x4
    x161 = x160*x58
    x162 = V_tank*x111*x151*x54
    x163 = x162*x9
    x164 = x151*x26*x29*x76
    x165 = x164*x50
    x166 = x151*x26*x54*x76
    x167 = x166*x32
    x168 = x151*x26*x76
    x169 = x144*x168
    x170 = x151*x29*x36*x68
    x171 = x170*x57
    x172 = x151*x36*x54*x68
    x173 = x172*x24
    x174 = x151*x36*x68
    x175 = x137*x174
    x176 = x118*x4*x68
    x177 = x144*x176
    x178 = x118*x29*x68
    x179 = x101*x178
    x180 = x118*x54*x68
    x181 = x180*x82
    x182 = x111*x4*x76
    x183 = x137*x182
    x184 = x111*x29*x76
    x185 = x108*x184
    x186 = x111*x54*x76
    x187 = x186*x74
    x188 = x138*x144
    x189 = x140*x65
    x190 = x142*x33
    x191 = x137*x145
    x192 = x147*x58
    x193 = x149*x41
    x194 = x101*x152
    x195 = x154*x58
    x196 = x156*x9
    x197 = x108*x158
    x198 = x160*x65
    x199 = x16*x162
    x200 = x164*x57
    x201 = x166*x24
    x202 = x137*x168
    x203 = x170*x50
    x204 = x172*x32
    x205 = x144*x174
    x206 = x137*x176
    x207 = x108*x178
    x208 = x180*x74
    x209 = x144*x182
    x210 = x101*x184
    x211 = x186*x82
    x212 = N_bf*cal_duration
    x213 = 2*N_af*cal_duration
    x214 = N_af*cal_duration*recoil_prob
    x215 = cal_begin - t
    x216 = abs(x215)
    x217 = N_bf*x216
    x218 = 2*N_af*x216
    x219 = abs(cal_duration + x215)
    x220 = N_bf*x219
    x221 = N_af*recoil_prob*x216
    x222 = 2*N_af*x219
    x223 = N_af*recoil_prob*x219
    x224 = cal_begin/2
    x225 = -t/2
    x226 = -x216/2 + x224 + x225
    x227 = exp(lambda_a*x226)
    x228 = 2*N_af*V_delay*lambda_a*x1*x227
    x229 = 2*N_af*V_tank*lambda_a*x1*x227
    x230 = 2*N_bf*V_delay*lambda_a*x1
    x231 = exp(lambda_c*x226)
    x232 = lambda_b*x231
    x233 = exp(lambda_b*x226)
    x234 = lambda_c*x233
    x235 = 2*N_bf*V_tank*lambda_a*x1
    x236 = 2*N_af*V_delay*x1*x227
    x237 = 2*N_af*V_tank*x1*x227
    x238 = 2*N_bf*V_delay*x1
    x239 = x231*x8
    x240 = x0*x233
    x241 = 2*N_bf*V_tank*x1
    x242 = cal_duration/2 - x219/2 + x224 + x225
    x243 = exp(lambda_a*x242)
    x244 = 2*N_af*V_delay*lambda_a*x1*x243
    x245 = 2*N_af*V_tank*lambda_a*x1*x243
    x246 = exp(lambda_c*x242)
    x247 = lambda_b*x246
    x248 = exp(lambda_b*x242)
    x249 = lambda_c*x248
    x250 = 2*N_af*x227*x25*x26
    x251 = 2*N_af*x227*x25*x36
    x252 = 2*N_af*V_delay*x1*x243
    x253 = 2*N_af*V_tank*x1*x243
    x254 = 2*N_bf*x25*x26
    x255 = x231*x24
    x256 = x233*x32
    x257 = 2*N_bf*x25*x36
    x258 = x246*x8
    x259 = x0*x248
    x260 = 2*N_af*V_delay*x227*x36*x51
    x261 = 2*N_af*V_tank*x227*x26*x51
    x262 = 2*N_af*x227*x51*x68
    x263 = 2*N_af*x227*x51*x76
    x264 = 2*N_af*lambda_a*x227*x25*x26
    x265 = 2*N_af*lambda_a*x227*x25*x36
    x266 = 2*N_bf*V_delay*x36*x51
    x267 = x231*x50
    x268 = x233*x57
    x269 = 2*N_bf*V_tank*x26*x51
    x270 = 2*N_bf*lambda_a*x51*x68
    x271 = 2*N_bf*lambda_a*x51*x76
    x272 = 2*N_bf*x25*x26*x4
    x273 = 2*N_bf*x25*x36*x4
    x274 = 2*N_af*x243*x25*x26
    x275 = 2*N_af*x243*x25*x36
    x276 = x24*x246
    x277 = x248*x32
    x278 = 2*N_af*V_delay*x227*x76*x96
    x279 = 2*N_af*V_tank*x227*x68*x96
    x280 = 2*N_af*V_delay*lambda_a*x227*x36*x51
    x281 = 2*N_af*V_tank*lambda_a*x227*x26*x51
    x282 = 2*N_af*lambda_a*x227*x51*x68
    x283 = 2*N_af*lambda_a*x227*x51*x76
    x284 = 1/lambda_a
    x285 = 4*N_af*x227*x284
    x286 = 1/lambda_b
    x287 = 2*N_af*x233*x286
    x288 = x287*x3
    x289 = 1/lambda_c
    x290 = 2*N_af*x231*x289
    x291 = x18*x290
    x292 = x19*x287
    x293 = x290*x6
    x294 = x21*x287
    x295 = x12*x290
    x296 = x14*x287
    x297 = x22*x290
    x298 = 2*N_bf*V_delay*lambda_a*x76*x96
    x299 = 2*N_bf*V_tank*lambda_a*x68*x96
    x300 = 2*N_bf*V_delay*x29*x36*x51
    x301 = 2*N_bf*V_tank*x26*x29*x51
    x302 = 2*N_bf*x233*x286
    x303 = 2*N_bf*x231*x289
    x304 = 2*N_af*V_delay*x243*x36*x51
    x305 = 2*N_af*V_tank*x243*x26*x51
    x306 = 2*N_af*x243*x51*x68
    x307 = 2*N_af*x243*x51*x76
    x308 = 2*N_af*lambda_a*x243*x25*x26
    x309 = 2*N_af*lambda_a*x243*x25*x36
    x310 = x246*x50
    x311 = x248*x57
    x312 = 2*N_bf*x4*x51*x68
    x313 = 2*N_bf*x4*x51*x76
    x314 = 2*N_af*V_delay*lambda_a*x227*x76*x96
    x315 = 2*N_af*V_tank*lambda_a*x227*x68*x96
    x316 = 2*N_af*recoil_prob*x227*x284
    x317 = 1/V_delay
    x318 = Q_external*x226
    x319 = exp(x317*x318)
    x320 = 2*N_af*x29*x319*x51*x68
    x321 = 1/V_tank
    x322 = exp(x318*x321)
    x323 = 2*N_af*x29*x322*x51*x76
    x324 = 2*N_af*V_delay*x243*x76*x96
    x325 = 2*N_af*V_tank*x243*x68*x96
    x326 = 2*N_af*V_delay*lambda_a*x243*x36*x51
    x327 = 2*N_af*V_tank*lambda_a*x243*x26*x51
    x328 = 2*N_af*lambda_a*x243*x51*x68
    x329 = 2*N_af*lambda_a*x243*x51*x76
    x330 = x287*x44
    x331 = x28*x290
    x332 = x287*x31
    x333 = x290*x45
    x334 = x287*x38
    x335 = x290*x47
    x336 = x287*x48
    x337 = x290*x40
    x338 = 4*N_af*x243*x284
    x339 = 2*N_af*x248*x286
    x340 = x3*x339
    x341 = 2*N_af*x246*x289
    x342 = x18*x341
    x343 = x19*x339
    x344 = x341*x6
    x345 = x21*x339
    x346 = x12*x341
    x347 = x14*x339
    x348 = x22*x341
    x349 = 2*N_bf*V_delay*x29*x76*x96
    x350 = 2*N_bf*V_tank*x29*x68*x96
    x351 = 2*N_bf*x248*x286
    x352 = 2*N_bf*x246*x289
    x353 = 2*N_af*V_delay*x322*x54*x76*x96
    x354 = 2*N_af*V_tank*x319*x54*x68*x96
    x355 = 2*N_af*lambda_a*x111*x319*x96
    x356 = 2*N_af*lambda_a*x118*x322*x96
    x357 = 2*N_af*lambda_a*x319*x51*x68
    x358 = 2*N_af*lambda_a*x322*x51*x76
    x359 = 2*N_bf*lambda_a*x111*x319*x96
    x360 = 2*N_bf*lambda_a*x118*x322*x96
    x361 = 2*N_af*V_delay*lambda_a*x243*x76*x96
    x362 = 2*N_af*V_tank*lambda_a*x243*x68*x96
    x363 = x287*x84
    x364 = x290*x53
    x365 = x287*x56
    x366 = x290*x85
    x367 = x287*x62
    x368 = x290*x87
    x369 = x287*x88
    x370 = x290*x64
    x371 = 2*N_af*recoil_prob*x243*x284
    x372 = 2*N_af*x111*x319*x4*x96
    x373 = 2*N_af*x111*x29*x319*x96
    x374 = 2*N_af*x118*x322*x4*x96
    x375 = 2*N_af*x118*x29*x322*x96
    x376 = 2*N_af*x319*x4*x51*x68
    x377 = Q_external*x242
    x378 = exp(x317*x377)
    x379 = 2*N_af*x29*x378*x51*x68
    x380 = 2*N_af*x322*x4*x51*x76
    x381 = exp(x321*x377)
    x382 = 2*N_af*x29*x381*x51*x76
    x383 = 2*N_bf*x111*x319*x96
    x384 = 2*N_bf*x118*x322*x96
    x385 = 2*N_af*x151*x227*x26*x76
    x386 = 2*N_af*x151*x227*x36*x68
    x387 = x287*x70
    x388 = x290*x90
    x389 = x287*x91
    x390 = x290*x72
    x391 = x287*x93
    x392 = x290*x78
    x393 = x287*x80
    x394 = x290*x94
    x395 = x339*x44
    x396 = x28*x341
    x397 = x31*x339
    x398 = x341*x45
    x399 = x339*x38
    x400 = x341*x47
    x401 = x339*x48
    x402 = x341*x40
    x403 = 2*N_bf*x151*x26*x4*x76
    x404 = 2*N_bf*x151*x26*x29*x76
    x405 = 2*N_bf*x151*x36*x4*x68
    x406 = 2*N_bf*x151*x29*x36*x68
    x407 = V_tank**5
    x408 = 4*N_af*Q_external*V_delay*lambda_a*x322*x407
    x409 = 4*N_af*Q_external*V_delay*x322*x4*x407
    x410 = 4*N_af*Q_external*V_delay*x322*x407*x54
    x411 = V_delay**5
    x412 = 4*N_af*Q_external*V_tank*lambda_a*x319*x411
    x413 = 4*N_af*Q_external*V_tank*x319*x4*x411
    x414 = 4*N_af*Q_external*V_tank*x319*x411*x54
    x415 = 2*N_af*V_delay*lambda_a*x118*x151*x322
    x416 = 2*N_af*V_tank*lambda_a*x111*x151*x319
    x417 = 2*N_af*V_delay*lambda_a*x322*x76*x96
    x418 = 2*N_af*V_tank*lambda_a*x319*x68*x96
    x419 = 2*N_bf*Q_external*V_delay*lambda_a*x322*x407
    x420 = 2*N_bf*Q_external*V_delay*x322*x4*x407
    x421 = 2*N_bf*Q_external*V_delay*x322*x407*x54
    x422 = 2*N_bf*Q_external*V_tank*lambda_a*x319*x411
    x423 = 2*N_bf*Q_external*V_tank*x319*x4*x411
    x424 = 2*N_bf*Q_external*V_tank*x319*x411*x54
    x425 = 2*N_bf*V_delay*lambda_a*x118*x151*x322
    x426 = 2*N_bf*V_tank*lambda_a*x111*x151*x319
    x427 = 2*N_af*Q_external*x118*x26*x29*x322
    x428 = 2*N_af*Q_external*x118*x26*x322*x54
    x429 = 2*N_af*Q_external*x111*x29*x319*x36
    x430 = 2*N_af*Q_external*x111*x319*x36*x54
    x431 = 2*N_af*V_delay*x118*x151*x322*x4
    x432 = 2*N_af*V_delay*x118*x151*x322*x54
    x433 = 2*N_af*V_tank*x111*x151*x319*x4
    x434 = 2*N_af*V_tank*x111*x151*x319*x54
    x435 = 4*N_af*lambda_a*x151*x319*x411
    x436 = 4*N_af*x151*x319*x4*x411
    x437 = 4*N_af*x151*x29*x319*x411
    x438 = 4*N_af*lambda_a*x151*x322*x407
    x439 = 4*N_af*x151*x322*x4*x407
    x440 = 4*N_af*x151*x29*x322*x407
    x441 = 2*N_af*V_delay*x322*x4*x76*x96
    x442 = 2*N_af*V_delay*x381*x54*x76*x96
    x443 = 2*N_af*V_tank*x319*x4*x68*x96
    x444 = 2*N_af*V_tank*x378*x54*x68*x96
    x445 = 2*N_af*lambda_a*x111*x378*x96
    x446 = 2*N_af*lambda_a*x118*x381*x96
    x447 = 2*N_af*lambda_a*x378*x51*x68
    x448 = 2*N_af*lambda_a*x381*x51*x76
    x449 = 4*N_af*lambda_a*x26*x322*x407
    x450 = 4*N_af*x26*x29*x322*x407
    x451 = 4*N_af*x26*x322*x407*x54
    x452 = 2*N_af*x118*x29*x322*x68
    x453 = 2*N_af*x118*x322*x54*x68
    x454 = 2*N_af*x111*x29*x319*x76
    x455 = 2*N_af*x111*x319*x54*x76
    x456 = 4*N_af*lambda_a*x319*x36*x411
    x457 = 4*N_af*x29*x319*x36*x411
    x458 = 4*N_af*x319*x36*x411*x54
    x459 = 2*N_bf*Q_external*x118*x26*x322
    x460 = 2*N_bf*Q_external*x111*x319*x36
    x461 = 2*N_bf*V_delay*x118*x151*x322
    x462 = 2*N_bf*V_tank*x111*x151*x319
    x463 = 2*N_bf*lambda_a*x151*x319*x411
    x464 = 2*N_bf*x151*x319*x4*x411
    x465 = 2*N_bf*x151*x29*x319*x411
    x466 = 2*N_bf*lambda_a*x151*x322*x407
    x467 = 2*N_bf*x151*x322*x4*x407
    x468 = 2*N_bf*x151*x29*x322*x407
    x469 = 2*N_bf*lambda_a*x111*x378*x96
    x470 = 2*N_bf*x111*x319*x4*x96
    x471 = 2*N_bf*lambda_a*x118*x381*x96
    x472 = 2*N_bf*x118*x322*x4*x96
    x473 = 2*N_bf*lambda_a*x26*x322*x407
    x474 = 2*N_bf*x26*x29*x322*x407
    x475 = 2*N_bf*x26*x322*x407*x54
    x476 = 2*N_bf*lambda_a*x118*x322*x68
    x477 = 2*N_bf*lambda_a*x111*x319*x76
    x478 = 2*N_bf*lambda_a*x319*x36*x411
    x479 = 2*N_bf*x29*x319*x36*x411
    x480 = 2*N_bf*x319*x36*x411*x54
    x481 = 2*N_af*lambda_a*x151*x227*x26*x76
    x482 = 2*N_af*lambda_a*x151*x227*x36*x68
    x483 = x287*x98
    x484 = x125*x290
    x485 = x126*x287
    x486 = x100*x290
    x487 = x128*x287
    x488 = x105*x290
    x489 = x107*x287
    x490 = x129*x290
    x491 = x339*x84
    x492 = x341*x53
    x493 = x339*x56
    x494 = x341*x85
    x495 = x339*x62
    x496 = x341*x87
    x497 = x339*x88
    x498 = x341*x64
    x499 = 2*N_af*Q_external*V_delay*lambda_a*recoil_prob*x322*x407
    x500 = 2*N_af*Q_external*V_delay*recoil_prob*x322*x4*x407
    x501 = 2*N_af*Q_external*V_delay*recoil_prob*x322*x407*x54
    x502 = 2*N_af*Q_external*V_tank*lambda_a*recoil_prob*x319*x411
    x503 = 2*N_af*Q_external*V_tank*recoil_prob*x319*x4*x411
    x504 = 2*N_af*Q_external*V_tank*recoil_prob*x319*x411*x54
    x505 = 2*N_af*x111*x378*x4*x96
    x506 = 2*N_af*x111*x29*x378*x96
    x507 = 2*N_af*x118*x381*x4*x96
    x508 = 2*N_af*x118*x29*x381*x96
    x509 = 2*N_af*x378*x4*x51*x68
    x510 = 2*N_af*x381*x4*x51*x76
    x511 = 2*N_bf*x111*x378*x96
    x512 = 2*N_bf*x118*x381*x96
    x513 = 2*N_af*x151*x243*x26*x76
    x514 = 2*N_af*x151*x243*x36*x68
    x515 = x339*x70
    x516 = x341*x90
    x517 = x339*x91
    x518 = x341*x72
    x519 = x339*x93
    x520 = x341*x78
    x521 = x339*x80
    x522 = x341*x94
    x523 = 4*N_af*Q_external*V_delay*lambda_a*x381*x407
    x524 = 4*N_af*Q_external*V_delay*x381*x4*x407
    x525 = 4*N_af*Q_external*V_delay*x381*x407*x54
    x526 = 2*N_af*Q_external*lambda_a*x118*x26*x322
    x527 = 2*N_af*Q_external*lambda_b*x29*x32*x68*x76
    x528 = 2*N_af*Q_external*lambda_c*x24*x29*x68*x76
    x529 = 2*N_af*Q_external*lambda_b*x0*x54*x68*x76
    x530 = 2*N_af*Q_external*lambda_c*x54*x68*x76*x8
    x531 = 2*N_af*Q_external*lambda_a*x111*x319*x36
    x532 = 4*N_af*Q_external*V_tank*lambda_a*x378*x411
    x533 = 4*N_af*Q_external*V_tank*x378*x4*x411
    x534 = 4*N_af*Q_external*V_tank*x378*x411*x54
    x535 = 2*N_af*V_delay*lambda_a*x118*x151*x381
    x536 = 2*N_af*V_tank*lambda_a*x111*x151*x378
    x537 = 2*N_af*lambda_a*recoil_prob*x151*x319*x411
    x538 = 2*N_af*recoil_prob*x151*x319*x4*x411
    x539 = 2*N_af*recoil_prob*x151*x29*x319*x411
    x540 = 2*N_af*lambda_a*recoil_prob*x151*x322*x407
    x541 = 2*N_af*recoil_prob*x151*x322*x4*x407
    x542 = 2*N_af*recoil_prob*x151*x29*x322*x407
    x543 = 2*N_af*V_delay*lambda_a*x381*x76*x96
    x544 = 2*N_af*V_tank*lambda_a*x378*x68*x96
    x545 = 2*N_af*lambda_a*recoil_prob*x26*x322*x407
    x546 = 2*N_af*recoil_prob*x26*x29*x322*x407
    x547 = 2*N_af*recoil_prob*x26*x322*x407*x54
    x548 = 2*N_af*lambda_a*recoil_prob*x319*x36*x411
    x549 = 2*N_af*recoil_prob*x29*x319*x36*x411
    x550 = 2*N_af*recoil_prob*x319*x36*x411*x54
    x551 = 2*N_bf*Q_external*V_delay*lambda_a*x381*x407
    x552 = 2*N_bf*Q_external*V_delay*x381*x4*x407
    x553 = 2*N_bf*Q_external*V_delay*x381*x407*x54
    x554 = 2*N_bf*Q_external*x118*x26*x322*x4
    x555 = 2*N_bf*Q_external*x118*x26*x29*x322
    x556 = 2*N_bf*Q_external*x111*x319*x36*x4
    x557 = 2*N_bf*Q_external*x111*x29*x319*x36
    x558 = 2*N_bf*Q_external*V_tank*lambda_a*x378*x411
    x559 = 2*N_bf*Q_external*V_tank*x378*x4*x411
    x560 = 2*N_bf*Q_external*V_tank*x378*x411*x54
    x561 = 2*N_bf*V_delay*lambda_a*x118*x151*x381
    x562 = 2*N_bf*V_delay*x118*x151*x29*x322
    x563 = 2*N_bf*V_tank*lambda_a*x111*x151*x378
    x564 = 2*N_bf*V_tank*x111*x151*x29*x319
    x565 = 2*N_af*Q_external*x118*x26*x29*x381
    x566 = 2*N_af*Q_external*x118*x26*x381*x54
    x567 = 2*N_af*Q_external*x111*x29*x36*x378
    x568 = 2*N_af*Q_external*x111*x36*x378*x54
    x569 = 2*N_af*V_delay*x118*x151*x381*x4
    x570 = 2*N_af*V_delay*x118*x151*x381*x54
    x571 = 2*N_af*x151*x26*x29*x322*x76
    x572 = 2*N_af*x151*x26*x322*x54*x76
    x573 = 2*N_af*x151*x29*x319*x36*x68
    x574 = 2*N_af*x151*x319*x36*x54*x68
    x575 = 2*N_af*V_tank*x111*x151*x378*x4
    x576 = 2*N_af*V_tank*x111*x151*x378*x54
    x577 = 4*N_af*lambda_a*x151*x378*x411
    x578 = 4*N_af*x151*x378*x4*x411
    x579 = 4*N_af*x151*x29*x378*x411
    x580 = 4*N_af*lambda_a*x151*x381*x407
    x581 = 4*N_af*x151*x381*x4*x407
    x582 = 4*N_af*x151*x29*x381*x407
    x583 = 2*N_af*V_delay*x381*x4*x76*x96
    x584 = 2*N_af*V_tank*x378*x4*x68*x96
    x585 = 4*N_af*lambda_a*x26*x381*x407
    x586 = 4*N_af*x26*x29*x381*x407
    x587 = 4*N_af*x26*x381*x407*x54
    x588 = 2*N_af*x118*x322*x4*x68
    x589 = 2*N_af*x118*x29*x381*x68
    x590 = 2*N_af*x118*x381*x54*x68
    x591 = 2*N_af*x111*x319*x4*x76
    x592 = 2*N_af*x111*x29*x378*x76
    x593 = 2*N_af*x111*x378*x54*x76
    x594 = 4*N_af*lambda_a*x36*x378*x411
    x595 = 4*N_af*x29*x36*x378*x411
    x596 = 4*N_af*x36*x378*x411*x54
    x597 = 2*N_bf*Q_external*x118*x26*x381
    x598 = 2*N_bf*Q_external*x111*x36*x378
    x599 = 2*N_bf*V_delay*x118*x151*x381
    x600 = 2*N_bf*V_tank*x111*x151*x378
    x601 = 2*N_bf*lambda_a*x151*x378*x411
    x602 = 2*N_bf*x151*x378*x4*x411
    x603 = 2*N_bf*x151*x29*x378*x411
    x604 = 2*N_bf*lambda_a*x151*x381*x407
    x605 = 2*N_bf*x151*x381*x4*x407
    x606 = 2*N_bf*x151*x29*x381*x407
    x607 = 2*N_bf*x111*x378*x4*x96
    x608 = 2*N_bf*x118*x381*x4*x96
    x609 = 2*N_bf*lambda_a*x26*x381*x407
    x610 = 2*N_bf*x26*x29*x381*x407
    x611 = 2*N_bf*x26*x381*x407*x54
    x612 = 2*N_bf*lambda_a*x118*x381*x68
    x613 = 2*N_bf*x118*x322*x4*x68
    x614 = 2*N_bf*x118*x29*x322*x68
    x615 = 2*N_bf*lambda_a*x111*x378*x76
    x616 = 2*N_bf*x111*x319*x4*x76
    x617 = 2*N_bf*x111*x29*x319*x76
    x618 = 2*N_bf*lambda_a*x36*x378*x411
    x619 = 2*N_bf*x29*x36*x378*x411
    x620 = 2*N_bf*x36*x378*x411*x54
    x621 = 2*N_af*lambda_a*x151*x243*x26*x76
    x622 = x200*x287
    x623 = x165*x290
    x624 = x167*x287
    x625 = x201*x290
    x626 = 2*N_af*lambda_a*x151*x243*x36*x68
    x627 = x171*x287
    x628 = x203*x290
    x629 = x204*x287
    x630 = x173*x290
    x631 = x339*x98
    x632 = x125*x341
    x633 = x126*x339
    x634 = x100*x341
    x635 = x128*x339
    x636 = x105*x341
    x637 = x107*x339
    x638 = x129*x341
    x639 = 2*N_af*Q_external*V_delay*lambda_a*recoil_prob*x381*x407
    x640 = 2*N_af*Q_external*V_delay*recoil_prob*x381*x4*x407
    x641 = 2*N_af*Q_external*V_delay*recoil_prob*x381*x407*x54
    x642 = 2*N_af*Q_external*V_tank*lambda_a*recoil_prob*x378*x411
    x643 = 2*N_af*Q_external*V_tank*recoil_prob*x378*x4*x411
    x644 = 2*N_af*Q_external*V_tank*recoil_prob*x378*x411*x54
    x645 = 2*N_af*Q_external*lambda_a*x118*x26*x381
    x646 = 2*N_af*Q_external*x32*x4*x68*x76*x8
    x647 = 2*N_af*Q_external*x0*x24*x4*x68*x76
    x648 = 2*N_af*Q_external*lambda_a*x111*x36*x378
    x649 = 2*N_af*lambda_a*x151*x26*x322*x76
    x650 = 2*N_af*lambda_a*x151*x319*x36*x68
    x651 = 2*N_af*lambda_a*recoil_prob*x151*x378*x411
    x652 = 2*N_af*recoil_prob*x151*x378*x4*x411
    x653 = 2*N_af*recoil_prob*x151*x29*x378*x411
    x654 = 2*N_af*lambda_a*recoil_prob*x151*x381*x407
    x655 = 2*N_af*recoil_prob*x151*x381*x4*x407
    x656 = 2*N_af*recoil_prob*x151*x29*x381*x407
    x657 = 2*N_af*lambda_a*recoil_prob*x26*x381*x407
    x658 = 2*N_af*recoil_prob*x26*x29*x381*x407
    x659 = 2*N_af*recoil_prob*x26*x381*x407*x54
    x660 = 2*N_af*lambda_a*recoil_prob*x36*x378*x411
    x661 = 2*N_af*recoil_prob*x29*x36*x378*x411
    x662 = 2*N_af*recoil_prob*x36*x378*x411*x54
    x663 = 2*N_bf*Q_external*x118*x26*x381*x4
    x664 = 2*N_bf*Q_external*x118*x26*x29*x381
    x665 = 2*N_bf*Q_external*x111*x36*x378*x4
    x666 = 2*N_bf*Q_external*x111*x29*x36*x378
    x667 = 2*N_bf*V_delay*x118*x151*x29*x381
    x668 = 2*N_bf*V_tank*x111*x151*x29*x378
    x669 = 2*N_af*x151*x26*x29*x381*x76
    x670 = 2*N_af*x151*x26*x381*x54*x76
    x671 = 2*N_af*x151*x29*x36*x378*x68
    x672 = 2*N_af*x151*x36*x378*x54*x68
    x673 = 2*N_af*x118*x381*x4*x68
    x674 = 2*N_af*x111*x378*x4*x76
    x675 = 2*N_bf*x118*x381*x4*x68
    x676 = 2*N_bf*x118*x29*x381*x68
    x677 = 2*N_bf*x111*x378*x4*x76
    x678 = 2*N_bf*x111*x29*x378*x76
    x679 = x200*x339
    x680 = x165*x341
    x681 = x167*x339
    x682 = x201*x341
    x683 = x171*x339
    x684 = x203*x341
    x685 = x204*x339
    x686 = x173*x341
    x687 = 1/Q_external
    x688 = 4*N_af*x322*x4*x407*x68*x687
    x689 = 4*N_af*x29*x322*x407*x68*x687
    x690 = 4*N_af*x322*x407*x54*x68*x687
    x691 = 4*N_af*x319*x4*x411*x687*x76
    x692 = 4*N_af*x29*x319*x411*x687*x76
    x693 = 4*N_af*x319*x411*x54*x687*x76
    x694 = 2*N_af*lambda_a*x151*x26*x381*x76
    x695 = 2*N_af*lambda_a*x151*x36*x378*x68
    x696 = 2*N_bf*x322*x4*x407*x68*x687
    x697 = 2*N_bf*x29*x322*x407*x68*x687
    x698 = 2*N_bf*x322*x407*x54*x68*x687
    x699 = 2*N_bf*x319*x4*x411*x687*x76
    x700 = 2*N_bf*x29*x319*x411*x687*x76
    x701 = 2*N_bf*x319*x411*x54*x687*x76
    x702 = 2*N_af*recoil_prob*x322*x4*x407*x68*x687
    x703 = 2*N_af*recoil_prob*x29*x322*x407*x68*x687
    x704 = 2*N_af*recoil_prob*x322*x407*x54*x68*x687
    x705 = 2*N_af*recoil_prob*x319*x4*x411*x687*x76
    x706 = 2*N_af*recoil_prob*x29*x319*x411*x687*x76
    x707 = 2*N_af*recoil_prob*x319*x411*x54*x687*x76
    x708 = 4*N_af*x381*x4*x407*x68*x687
    x709 = 4*N_af*x29*x381*x407*x68*x687
    x710 = 4*N_af*x381*x407*x54*x68*x687
    x711 = 4*N_af*x378*x4*x411*x687*x76
    x712 = 4*N_af*x29*x378*x411*x687*x76
    x713 = 4*N_af*x378*x411*x54*x687*x76
    x714 = 2*N_bf*x381*x4*x407*x68*x687
    x715 = 2*N_bf*x29*x381*x407*x68*x687
    x716 = 2*N_bf*x381*x407*x54*x68*x687
    x717 = 2*N_bf*x378*x4*x411*x687*x76
    x718 = 2*N_bf*x29*x378*x411*x687*x76
    x719 = 2*N_bf*x378*x411*x54*x687*x76
    x720 = 2*N_af*recoil_prob*x381*x4*x407*x68*x687
    x721 = 2*N_af*recoil_prob*x29*x381*x407*x68*x687
    x722 = 2*N_af*recoil_prob*x381*x407*x54*x68*x687
    x723 = 2*N_af*recoil_prob*x378*x4*x411*x687*x76
    x724 = 2*N_af*recoil_prob*x29*x378*x411*x687*x76
    x725 = 2*N_af*recoil_prob*x378*x411*x54*x687*x76
    X = -Ncal*Q*eff*rs*(-lambda_b*x228 + lambda_b*x229 + lambda_b*x244 - lambda_b*x245 + lambda_b*x320 - lambda_b*x323 + lambda_b*x353 - lambda_b*x354 - lambda_b*x379 + lambda_b*x382 - lambda_b*x442 + lambda_b*x444 + lambda_c*x228 - lambda_c*x229 - lambda_c*x244 + lambda_c*x245 - lambda_c*x320 + lambda_c*x323 - lambda_c*x353 + lambda_c*x354 + lambda_c*x379 - lambda_c*x382 + lambda_c*x442 - lambda_c*x444 + recoil_prob*x288 - recoil_prob*x291 - recoil_prob*x292 + recoil_prob*x293 - recoil_prob*x294 + recoil_prob*x295 + recoil_prob*x296 - recoil_prob*x297 - recoil_prob*x330 + recoil_prob*x331 + recoil_prob*x332 - recoil_prob*x333 + recoil_prob*x334 - recoil_prob*x335 - recoil_prob*x336 + recoil_prob*x337 - recoil_prob*x340 + recoil_prob*x342 + recoil_prob*x343 - recoil_prob*x344 + recoil_prob*x345 - recoil_prob*x346 - recoil_prob*x347 + recoil_prob*x348 - recoil_prob*x363 + recoil_prob*x364 + recoil_prob*x365 - recoil_prob*x366 + recoil_prob*x367 - recoil_prob*x368 - recoil_prob*x369 + recoil_prob*x370 + recoil_prob*x387 - recoil_prob*x388 - recoil_prob*x389 + recoil_prob*x390 - recoil_prob*x391 + recoil_prob*x392 + recoil_prob*x393 - recoil_prob*x394 + recoil_prob*x395 - recoil_prob*x396 - recoil_prob*x397 + recoil_prob*x398 - recoil_prob*x399 + recoil_prob*x400 + recoil_prob*x401 - recoil_prob*x402 + recoil_prob*x483 - recoil_prob*x484 - recoil_prob*x485 + recoil_prob*x486 - recoil_prob*x487 + recoil_prob*x488 + recoil_prob*x489 - recoil_prob*x490 + recoil_prob*x491 - recoil_prob*x492 - recoil_prob*x493 + recoil_prob*x494 - recoil_prob*x495 + recoil_prob*x496 + recoil_prob*x497 - recoil_prob*x498 - recoil_prob*x515 + recoil_prob*x516 + recoil_prob*x517 - recoil_prob*x518 + recoil_prob*x519 - recoil_prob*x520 - recoil_prob*x521 + recoil_prob*x522 - recoil_prob*x622 + recoil_prob*x623 + recoil_prob*x624 - recoil_prob*x625 + recoil_prob*x627 - recoil_prob*x628 - recoil_prob*x629 + recoil_prob*x630 - recoil_prob*x631 + recoil_prob*x632 + recoil_prob*x633 - recoil_prob*x634 + recoil_prob*x635 - recoil_prob*x636 - recoil_prob*x637 + recoil_prob*x638 + recoil_prob*x679 - recoil_prob*x680 - recoil_prob*x681 + recoil_prob*x682 - recoil_prob*x683 + recoil_prob*x684 + recoil_prob*x685 - recoil_prob*x686 - x0*x236 + x0*x237 + x0*x252 - x0*x253 - x0*x264 + x0*x265 + x0*x308 - x0*x309 + x0*x373 - x0*x375 + x0*x376 - x0*x380 + x0*x432 - x0*x434 - x0*x506 + x0*x508 - x0*x509 + x0*x510 - x0*x570 + x0*x572 - x0*x574 + x0*x576 - x0*x670 + x0*x672 - x10*x212 - x10*x213 + x10*x214 - x10*x217 - x10*x218 + x10*x220 + x10*x221 + x10*x222 - x10*x223 - x10*x285 + x10*x316 + x10*x338 - x10*x371 - x100*x212 - x100*x213 + x100*x214 - x100*x217 - x100*x218 + x100*x220 + x100*x221 + x100*x222 - x100*x223 - x100*x303 + x100*x352 - x101*x385 + x101*x386 + x101*x408 - x101*x412 + x101*x419 - x101*x422 - x101*x461 + x101*x462 - x101*x499 + x101*x502 + x101*x513 - x101*x514 - x101*x523 + x101*x526 - x101*x531 + x101*x532 - x101*x551 + x101*x558 - x101*x588 + x101*x591 + x101*x599 - x101*x600 + x101*x613 - x101*x616 + x101*x639 - x101*x642 - x101*x645 + x101*x648 + x101*x673 - x101*x674 - x101*x675 + x101*x677 - x101*x689 + x101*x692 - x101*x697 + x101*x700 + x101*x703 - x101*x706 + x101*x709 - x101*x712 + x101*x715 - x101*x718 - x101*x721 + x101*x724 - x103*x212 - x103*x213 + x103*x214 - x103*x217 - x103*x218 + x103*x220 + x103*x221 + x103*x222 - x103*x223 - x103*x285 + x103*x316 + x103*x338 - x103*x371 - x105*x212 - x105*x213 + x105*x214 - x105*x217 - x105*x218 + x105*x220 + x105*x221 + x105*x222 - x105*x223 - x105*x303 + x105*x352 - x107*x212 - x107*x213 + x107*x214 - x107*x217 - x107*x218 + x107*x220 + x107*x221 + x107*x222 - x107*x223 - x107*x302 + x107*x351 + x108*x385 - x108*x386 - x108*x408 + x108*x412 - x108*x419 + x108*x422 + x108*x461 - x108*x462 + x108*x499 - x108*x502 - x108*x513 + x108*x514 + x108*x523 - x108*x526 + x108*x531 - x108*x532 + x108*x551 - x108*x558 + x108*x588 - x108*x591 - x108*x599 + x108*x600 - x108*x613 + x108*x616 - x108*x639 + x108*x642 + x108*x645 - x108*x648 - x108*x673 + x108*x674 + x108*x675 - x108*x677 + x108*x689 - x108*x692 + x108*x697 - x108*x700 - x108*x703 + x108*x706 - x108*x709 + x108*x712 - x108*x715 + x108*x718 + x108*x721 - x108*x724 - x110*x212 - x110*x213 + x110*x214 - x110*x217 - x110*x218 + x110*x220 + x110*x221 + x110*x222 - x110*x223 - x110*x285 + x110*x316 + x110*x338 - x110*x371 - x113*x212 - x113*x213 + x113*x214 - x113*x217 - x113*x218 + x113*x220 + x113*x221 + x113*x222 - x113*x223 - x115*x212 - x115*x213 + x115*x214 - x115*x217 - x115*x218 + x115*x220 + x115*x221 + x115*x222 - x115*x223 - x117*x212 - x117*x213 + x117*x214 - x117*x217 - x117*x218 + x117*x220 + x117*x221 + x117*x222 - x117*x223 - x12*x212 - x12*x213 + x12*x214 - x12*x217 - x12*x218 + x12*x220 + x12*x221 + x12*x222 - x12*x223 - x12*x303 + x12*x352 - x120*x212 - x120*x213 + x120*x214 - x120*x217 - x120*x218 + x120*x220 + x120*x221 + x120*x222 - x120*x223 - x122*x212 - x122*x213 + x122*x214 - x122*x217 - x122*x218 + x122*x220 + x122*x221 + x122*x222 - x122*x223 - x124*x212 - x124*x213 + x124*x214 - x124*x217 - x124*x218 + x124*x220 + x124*x221 + x124*x222 - x124*x223 + x125*x212 + x125*x213 - x125*x214 + x125*x217 + x125*x218 - x125*x220 - x125*x221 - x125*x222 + x125*x223 + x125*x303 - x125*x352 + x126*x212 + x126*x213 - x126*x214 + x126*x217 + x126*x218 - x126*x220 - x126*x221 - x126*x222 + x126*x223 + x126*x302 - x126*x351 + x127*x212 + x127*x213 - x127*x214 + x127*x217 + x127*x218 - x127*x220 - x127*x221 - x127*x222 + x127*x223 + x127*x285 - x127*x316 - x127*x338 + x127*x371 + x128*x212 + x128*x213 - x128*x214 + x128*x217 + x128*x218 - x128*x220 - x128*x221 - x128*x222 + x128*x223 + x128*x302 - x128*x351 + x129*x212 + x129*x213 - x129*x214 + x129*x217 + x129*x218 - x129*x220 - x129*x221 - x129*x222 + x129*x223 + x129*x303 - x129*x352 + x130*x212 + x130*x213 - x130*x214 + x130*x217 + x130*x218 - x130*x220 - x130*x221 - x130*x222 + x130*x223 + x130*x285 - x130*x316 - x130*x338 + x130*x371 + x131*x212 + x131*x213 - x131*x214 + x131*x217 + x131*x218 - x131*x220 - x131*x221 - x131*x222 + x131*x223 + x132*x212 + x132*x213 - x132*x214 + x132*x217 + x132*x218 - x132*x220 - x132*x221 - x132*x222 + x132*x223 + x133*x212 + x133*x213 - x133*x214 + x133*x217 + x133*x218 - x133*x220 - x133*x221 - x133*x222 + x133*x223 + x134*x212 + x134*x213 - x134*x214 + x134*x217 + x134*x218 - x134*x220 - x134*x221 - x134*x222 + x134*x223 + x135*x212 + x135*x213 - x135*x214 + x135*x217 + x135*x218 - x135*x220 - x135*x221 - x135*x222 + x135*x223 + x136*x212 + x136*x213 - x136*x214 + x136*x217 + x136*x218 - x136*x220 - x136*x221 - x136*x222 + x136*x223 - x137*x449 + x137*x456 + x137*x459 - x137*x460 - x137*x473 - x137*x476 + x137*x477 + x137*x478 + x137*x545 - x137*x548 + x137*x585 - x137*x594 - x137*x597 + x137*x598 + x137*x609 + x137*x612 - x137*x615 - x137*x618 - x137*x657 + x137*x660 + x137*x688 - x137*x691 + x137*x696 - x137*x699 - x137*x702 + x137*x705 - x137*x708 + x137*x711 - x137*x714 + x137*x717 + x137*x720 - x137*x723 - x139*x212 - x139*x213 + x139*x214 - x139*x217 - x139*x218 + x139*x220 + x139*x221 + x139*x222 - x139*x223 - x14*x212 - x14*x213 + x14*x214 - x14*x217 - x14*x218 + x14*x220 + x14*x221 + x14*x222 - x14*x223 - x14*x302 + x14*x351 - x141*x212 - x141*x213 + x141*x214 - x141*x217 - x141*x218 + x141*x220 + x141*x221 + x141*x222 - x141*x223 - x143*x212 - x143*x213 + x143*x214 - x143*x217 - x143*x218 + x143*x220 + x143*x221 + x143*x222 - x143*x223 + x144*x449 - x144*x456 - x144*x459 + x144*x460 + x144*x473 + x144*x476 - x144*x477 - x144*x478 - x144*x545 + x144*x548 - x144*x585 + x144*x594 + x144*x597 - x144*x598 - x144*x609 - x144*x612 + x144*x615 + x144*x618 + x144*x657 - x144*x660 - x144*x688 + x144*x691 - x144*x696 + x144*x699 + x144*x702 - x144*x705 + x144*x708 - x144*x711 + x144*x714 - x144*x717 - x144*x720 + x144*x723 - x146*x212 - x146*x213 + x146*x214 - x146*x217 - x146*x218 + x146*x220 + x146*x221 + x146*x222 - x146*x223 - x148*x212 - x148*x213 + x148*x214 - x148*x217 - x148*x218 + x148*x220 + x148*x221 + x148*x222 - x148*x223 - x150*x212 - x150*x213 + x150*x214 - x150*x217 - x150*x218 + x150*x220 + x150*x221 + x150*x222 - x150*x223 - x153*x212 - x153*x213 + x153*x214 - x153*x217 - x153*x218 + x153*x220 + x153*x221 + x153*x222 - x153*x223 - x155*x212 - x155*x213 + x155*x214 - x155*x217 - x155*x218 + x155*x220 + x155*x221 + x155*x222 - x155*x223 - x157*x212 - x157*x213 + x157*x214 - x157*x217 - x157*x218 + x157*x220 + x157*x221 + x157*x222 - x157*x223 - x159*x212 - x159*x213 + x159*x214 - x159*x217 - x159*x218 + x159*x220 + x159*x221 + x159*x222 - x159*x223 + x16*x250 - x16*x251 - x16*x274 + x16*x275 + x16*x282 - x16*x283 - x16*x328 + x16*x329 - x16*x357 + x16*x358 - x16*x372 + x16*x374 - x16*x410 + x16*x414 - x16*x421 + x16*x424 - x16*x428 + x16*x430 - x16*x437 + x16*x440 + x16*x447 - x16*x448 - x16*x465 + x16*x468 + x16*x470 - x16*x472 + x16*x501 - x16*x504 + x16*x505 - x16*x507 + x16*x525 - x16*x534 + x16*x539 - x16*x542 + x16*x553 - x16*x560 + x16*x562 - x16*x564 + x16*x566 - x16*x568 + x16*x579 - x16*x582 + x16*x603 - x16*x606 - x16*x607 + x16*x608 - x16*x641 + x16*x644 - x16*x653 + x16*x656 - x16*x667 + x16*x668 - x161*x212 - x161*x213 + x161*x214 - x161*x217 - x161*x218 + x161*x220 + x161*x221 + x161*x222 - x161*x223 - x163*x212 - x163*x213 + x163*x214 - x163*x217 - x163*x218 + x163*x220 + x163*x221 + x163*x222 - x163*x223 - x165*x212 - x165*x213 + x165*x214 - x165*x217 - x165*x218 + x165*x220 + x165*x221 + x165*x222 - x165*x223 - x165*x303 + x165*x352 - x167*x212 - x167*x213 + x167*x214 - x167*x217 - x167*x218 + x167*x220 + x167*x221 + x167*x222 - x167*x223 - x167*x302 + x167*x351 - x169*x212 - x169*x213 + x169*x214 - x169*x217 - x169*x218 + x169*x220 + x169*x221 + x169*x222 - x169*x223 - x169*x285 + x169*x316 + x169*x338 - x169*x371 - x17*x212 - x17*x213 + x17*x214 - x17*x217 - x17*x218 + x17*x220 + x17*x221 + x17*x222 - x17*x223 - x17*x285 + x17*x316 + x17*x338 - x17*x371 - x171*x212 - x171*x213 + x171*x214 - x171*x217 - x171*x218 + x171*x220 + x171*x221 + x171*x222 - x171*x223 - x171*x302 + x171*x351 - x173*x212 - x173*x213 + x173*x214 - x173*x217 - x173*x218 + x173*x220 + x173*x221 + x173*x222 - x173*x223 - x173*x303 + x173*x352 - x175*x212 - x175*x213 + x175*x214 - x175*x217 - x175*x218 + x175*x220 + x175*x221 + x175*x222 - x175*x223 - x175*x285 + x175*x316 + x175*x338 - x175*x371 - x177*x212 - x177*x213 + x177*x214 - x177*x217 - x177*x218 + x177*x220 + x177*x221 + x177*x222 - x177*x223 - x179*x212 - x179*x213 + x179*x214 - x179*x217 - x179*x218 + x179*x220 + x179*x221 + x179*x222 - x179*x223 + x18*x212 + x18*x213 - x18*x214 + x18*x217 + x18*x218 - x18*x220 - x18*x221 - x18*x222 + x18*x223 + x18*x303 - x18*x352 - x181*x212 - x181*x213 + x181*x214 - x181*x217 - x181*x218 + x181*x220 + x181*x221 + x181*x222 - x181*x223 - x183*x212 - x183*x213 + x183*x214 - x183*x217 - x183*x218 + x183*x220 + x183*x221 + x183*x222 - x183*x223 - x185*x212 - x185*x213 + x185*x214 - x185*x217 - x185*x218 + x185*x220 + x185*x221 + x185*x222 - x185*x223 - x187*x212 - x187*x213 + x187*x214 - x187*x217 - x187*x218 + x187*x220 + x187*x221 + x187*x222 - x187*x223 + x188*x212 + x188*x213 - x188*x214 + x188*x217 + x188*x218 - x188*x220 - x188*x221 - x188*x222 + x188*x223 + x189*x212 + x189*x213 - x189*x214 + x189*x217 + x189*x218 - x189*x220 - x189*x221 - x189*x222 + x189*x223 + x19*x212 + x19*x213 - x19*x214 + x19*x217 + x19*x218 - x19*x220 - x19*x221 - x19*x222 + x19*x223 + x19*x302 - x19*x351 + x190*x212 + x190*x213 - x190*x214 + x190*x217 + x190*x218 - x190*x220 - x190*x221 - x190*x222 + x190*x223 + x191*x212 + x191*x213 - x191*x214 + x191*x217 + x191*x218 - x191*x220 - x191*x221 - x191*x222 + x191*x223 + x192*x212 + x192*x213 - x192*x214 + x192*x217 + x192*x218 - x192*x220 - x192*x221 - x192*x222 + x192*x223 + x193*x212 + x193*x213 - x193*x214 + x193*x217 + x193*x218 - x193*x220 - x193*x221 - x193*x222 + x193*x223 + x194*x212 + x194*x213 - x194*x214 + x194*x217 + x194*x218 - x194*x220 - x194*x221 - x194*x222 + x194*x223 + x195*x212 + x195*x213 - x195*x214 + x195*x217 + x195*x218 - x195*x220 - x195*x221 - x195*x222 + x195*x223 + x196*x212 + x196*x213 - x196*x214 + x196*x217 + x196*x218 - x196*x220 - x196*x221 - x196*x222 + x196*x223 + x197*x212 + x197*x213 - x197*x214 + x197*x217 + x197*x218 - x197*x220 - x197*x221 - x197*x222 + x197*x223 + x198*x212 + x198*x213 - x198*x214 + x198*x217 + x198*x218 - x198*x220 - x198*x221 - x198*x222 + x198*x223 + x199*x212 + x199*x213 - x199*x214 + x199*x217 + x199*x218 - x199*x220 - x199*x221 - x199*x222 + x199*x223 + x20*x212 + x20*x213 - x20*x214 + x20*x217 + x20*x218 - x20*x220 - x20*x221 - x20*x222 + x20*x223 + x20*x285 - x20*x316 - x20*x338 + x20*x371 + x200*x212 + x200*x213 - x200*x214 + x200*x217 + x200*x218 - x200*x220 - x200*x221 - x200*x222 + x200*x223 + x200*x302 - x200*x351 + x201*x212 + x201*x213 - x201*x214 + x201*x217 + x201*x218 - x201*x220 - x201*x221 - x201*x222 + x201*x223 + x201*x303 - x201*x352 + x202*x212 + x202*x213 - x202*x214 + x202*x217 + x202*x218 - x202*x220 - x202*x221 - x202*x222 + x202*x223 + x202*x285 - x202*x316 - x202*x338 + x202*x371 + x203*x212 + x203*x213 - x203*x214 + x203*x217 + x203*x218 - x203*x220 - x203*x221 - x203*x222 + x203*x223 + x203*x303 - x203*x352 + x204*x212 + x204*x213 - x204*x214 + x204*x217 + x204*x218 - x204*x220 - x204*x221 - x204*x222 + x204*x223 + x204*x302 - x204*x351 + x205*x212 + x205*x213 - x205*x214 + x205*x217 + x205*x218 - x205*x220 - x205*x221 - x205*x222 + x205*x223 + x205*x285 - x205*x316 - x205*x338 + x205*x371 + x206*x212 + x206*x213 - x206*x214 + x206*x217 + x206*x218 - x206*x220 - x206*x221 - x206*x222 + x206*x223 + x207*x212 + x207*x213 - x207*x214 + x207*x217 + x207*x218 - x207*x220 - x207*x221 - x207*x222 + x207*x223 + x208*x212 + x208*x213 - x208*x214 + x208*x217 + x208*x218 - x208*x220 - x208*x221 - x208*x222 + x208*x223 + x209*x212 + x209*x213 - x209*x214 + x209*x217 + x209*x218 - x209*x220 - x209*x221 - x209*x222 + x209*x223 + x21*x212 + x21*x213 - x21*x214 + x21*x217 + x21*x218 - x21*x220 - x21*x221 - x21*x222 + x21*x223 + x21*x302 - x21*x351 + x210*x212 + x210*x213 - x210*x214 + x210*x217 + x210*x218 - x210*x220 - x210*x221 - x210*x222 + x210*x223 + x211*x212 + x211*x213 - x211*x214 + x211*x217 + x211*x218 - x211*x220 - x211*x221 - x211*x222 + x211*x223 + x212*x22 + x212*x23 - x212*x28 - x212*x3 - x212*x31 - x212*x35 - x212*x38 - x212*x40 - x212*x43 + x212*x44 + x212*x45 + x212*x46 + x212*x47 + x212*x48 + x212*x49 - x212*x53 - x212*x56 - x212*x6 - x212*x60 - x212*x62 - x212*x64 - x212*x67 - x212*x70 - x212*x72 - x212*x75 - x212*x78 - x212*x80 - x212*x83 + x212*x84 + x212*x85 + x212*x86 + x212*x87 + x212*x88 + x212*x89 + x212*x90 + x212*x91 + x212*x92 + x212*x93 + x212*x94 + x212*x95 - x212*x98 + x213*x22 + x213*x23 - x213*x28 - x213*x3 - x213*x31 - x213*x35 - x213*x38 - x213*x40 - x213*x43 + x213*x44 + x213*x45 + x213*x46 + x213*x47 + x213*x48 + x213*x49 - x213*x53 - x213*x56 - x213*x6 - x213*x60 - x213*x62 - x213*x64 - x213*x67 - x213*x70 - x213*x72 - x213*x75 - x213*x78 - x213*x80 - x213*x83 + x213*x84 + x213*x85 + x213*x86 + x213*x87 + x213*x88 + x213*x89 + x213*x90 + x213*x91 + x213*x92 + x213*x93 + x213*x94 + x213*x95 - x213*x98 - x214*x22 - x214*x23 + x214*x28 + x214*x3 + x214*x31 + x214*x35 + x214*x38 + x214*x40 + x214*x43 - x214*x44 - x214*x45 - x214*x46 - x214*x47 - x214*x48 - x214*x49 + x214*x53 + x214*x56 + x214*x6 + x214*x60 + x214*x62 + x214*x64 + x214*x67 + x214*x70 + x214*x72 + x214*x75 + x214*x78 + x214*x80 + x214*x83 - x214*x84 - x214*x85 - x214*x86 - x214*x87 - x214*x88 - x214*x89 - x214*x90 - x214*x91 - x214*x92 - x214*x93 - x214*x94 - x214*x95 + x214*x98 + x217*x22 + x217*x23 - x217*x28 - x217*x3 - x217*x31 - x217*x35 - x217*x38 - x217*x40 - x217*x43 + x217*x44 + x217*x45 + x217*x46 + x217*x47 + x217*x48 + x217*x49 - x217*x53 - x217*x56 - x217*x6 - x217*x60 - x217*x62 - x217*x64 - x217*x67 - x217*x70 - x217*x72 - x217*x75 - x217*x78 - x217*x80 - x217*x83 + x217*x84 + x217*x85 + x217*x86 + x217*x87 + x217*x88 + x217*x89 + x217*x90 + x217*x91 + x217*x92 + x217*x93 + x217*x94 + x217*x95 - x217*x98 + x218*x22 + x218*x23 - x218*x28 - x218*x3 - x218*x31 - x218*x35 - x218*x38 - x218*x40 - x218*x43 + x218*x44 + x218*x45 + x218*x46 + x218*x47 + x218*x48 + x218*x49 - x218*x53 - x218*x56 - x218*x6 - x218*x60 - x218*x62 - x218*x64 - x218*x67 - x218*x70 - x218*x72 - x218*x75 - x218*x78 - x218*x80 - x218*x83 + x218*x84 + x218*x85 + x218*x86 + x218*x87 + x218*x88 + x218*x89 + x218*x90 + x218*x91 + x218*x92 + x218*x93 + x218*x94 + x218*x95 - x218*x98 - x22*x220 - x22*x221 - x22*x222 + x22*x223 + x22*x303 - x22*x352 - x220*x23 + x220*x28 + x220*x3 + x220*x31 + x220*x35 + x220*x38 + x220*x40 + x220*x43 - x220*x44 - x220*x45 - x220*x46 - x220*x47 - x220*x48 - x220*x49 + x220*x53 + x220*x56 + x220*x6 + x220*x60 + x220*x62 + x220*x64 + x220*x67 + x220*x70 + x220*x72 + x220*x75 + x220*x78 + x220*x80 + x220*x83 - x220*x84 - x220*x85 - x220*x86 - x220*x87 - x220*x88 - x220*x89 - x220*x90 - x220*x91 - x220*x92 - x220*x93 - x220*x94 - x220*x95 + x220*x98 - x221*x23 + x221*x28 + x221*x3 + x221*x31 + x221*x35 + x221*x38 + x221*x40 + x221*x43 - x221*x44 - x221*x45 - x221*x46 - x221*x47 - x221*x48 - x221*x49 + x221*x53 + x221*x56 + x221*x6 + x221*x60 + x221*x62 + x221*x64 + x221*x67 + x221*x70 + x221*x72 + x221*x75 + x221*x78 + x221*x80 + x221*x83 - x221*x84 - x221*x85 - x221*x86 - x221*x87 - x221*x88 - x221*x89 - x221*x90 - x221*x91 - x221*x92 - x221*x93 - x221*x94 - x221*x95 + x221*x98 - x222*x23 + x222*x28 + x222*x3 + x222*x31 + x222*x35 + x222*x38 + x222*x40 + x222*x43 - x222*x44 - x222*x45 - x222*x46 - x222*x47 - x222*x48 - x222*x49 + x222*x53 + x222*x56 + x222*x6 + x222*x60 + x222*x62 + x222*x64 + x222*x67 + x222*x70 + x222*x72 + x222*x75 + x222*x78 + x222*x80 + x222*x83 - x222*x84 - x222*x85 - x222*x86 - x222*x87 - x222*x88 - x222*x89 - x222*x90 - x222*x91 - x222*x92 - x222*x93 - x222*x94 - x222*x95 + x222*x98 + x223*x23 - x223*x28 - x223*x3 - x223*x31 - x223*x35 - x223*x38 - x223*x40 - x223*x43 + x223*x44 + x223*x45 + x223*x46 + x223*x47 + x223*x48 + x223*x49 - x223*x53 - x223*x56 - x223*x6 - x223*x60 - x223*x62 - x223*x64 - x223*x67 - x223*x70 - x223*x72 - x223*x75 - x223*x78 - x223*x80 - x223*x83 + x223*x84 + x223*x85 + x223*x86 + x223*x87 + x223*x88 + x223*x89 + x223*x90 + x223*x91 + x223*x92 + x223*x93 + x223*x94 + x223*x95 - x223*x98 + x23*x285 - x23*x316 - x23*x338 + x23*x371 + x230*x232 - x230*x234 - x230*x247 + x230*x249 - x232*x235 - x232*x272 + x232*x273 - x232*x300 + x232*x301 + x234*x235 + x234*x272 - x234*x273 + x234*x300 - x234*x301 + x235*x247 - x235*x249 + x236*x8 - x237*x8 - x238*x239 + x238*x240 + x238*x258 - x238*x259 + x239*x241 + x239*x312 - x239*x313 + x239*x349 - x239*x350 - x24*x250 + x24*x251 + x24*x274 - x24*x275 + x24*x280 - x24*x281 - x24*x326 + x24*x327 + x24*x372 - x24*x374 + x24*x428 - x24*x430 - x24*x441 + x24*x443 - x24*x505 + x24*x507 - x24*x566 + x24*x568 + x24*x571 - x24*x573 + x24*x583 - x24*x584 - x24*x669 + x24*x671 - x240*x241 - x240*x312 + x240*x313 - x240*x349 + x240*x350 - x241*x258 + x241*x259 + x247*x272 - x247*x273 + x247*x300 - x247*x301 - x249*x272 + x249*x273 - x249*x300 + x249*x301 + x250*x32 - x250*x9 - x251*x32 + x251*x9 - x252*x8 + x253*x8 + x254*x255 - x254*x256 - x254*x276 + x254*x277 - x255*x257 - x255*x270 + x255*x271 - x255*x404 + x255*x406 + x256*x257 + x256*x270 - x256*x271 + x256*x404 - x256*x406 + x257*x276 - x257*x277 - x258*x312 + x258*x313 - x258*x349 + x258*x350 + x259*x312 - x259*x313 + x259*x349 - x259*x350 + x260*x33 - x260*x41 - x260*x50 + x260*x57 - x261*x33 + x261*x41 + x261*x50 - x261*x57 - x262*x33 + x262*x41 + x263*x33 - x263*x41 + x264*x8 - x265*x8 + x266*x267 - x266*x268 - x266*x310 + x266*x311 - x267*x269 - x267*x298 + x267*x299 + x267*x403 - x267*x405 + x268*x269 + x268*x298 - x268*x299 - x268*x403 + x268*x405 + x269*x310 - x269*x311 + x270*x276 - x270*x277 - x271*x276 + x271*x277 - x274*x32 + x274*x9 + x275*x32 - x275*x9 + x276*x404 - x276*x406 - x277*x404 + x277*x406 - x278*x58 + x278*x65 + x278*x74 - x278*x82 + x279*x58 - x279*x65 - x279*x74 + x279*x82 - x28*x303 + x28*x352 - x280*x32 + x281*x32 - x282*x9 + x283*x9 - x285*x35 - x285*x43 + x285*x46 + x285*x49 - x285*x60 - x285*x67 - x285*x75 - x285*x83 + x285*x86 + x285*x89 + x285*x92 + x285*x95 - x288 + x291 + x292 - x293 + x294 - x295 - x296 + x297 + x298*x310 - x298*x311 - x299*x310 + x299*x311 - x3*x302 + x3*x351 - x302*x31 - x302*x38 + x302*x44 + x302*x48 - x302*x56 - x302*x62 - x302*x70 - x302*x80 + x302*x84 + x302*x88 + x302*x91 + x302*x93 - x302*x98 - x303*x40 + x303*x45 + x303*x47 - x303*x53 - x303*x6 - x303*x64 - x303*x72 - x303*x78 + x303*x85 + x303*x87 + x303*x90 + x303*x94 - x304*x33 + x304*x41 + x304*x50 - x304*x57 + x305*x33 - x305*x41 - x305*x50 + x305*x57 + x306*x33 - x306*x41 - x307*x33 + x307*x41 - x308*x8 + x309*x8 + x31*x351 - x310*x403 + x310*x405 + x311*x403 - x311*x405 + x314*x33 - x314*x41 - x315*x33 + x315*x41 + x316*x35 + x316*x43 - x316*x46 - x316*x49 + x316*x60 + x316*x67 + x316*x75 + x316*x83 - x316*x86 - x316*x89 - x316*x92 - x316*x95 - x319*x527 + x319*x528 + x319*x529 - x319*x530 + x319*x646 - x319*x647 + x32*x326 - x32*x327 - x32*x372 + x32*x374 - x32*x428 + x32*x430 + x32*x441 - x32*x443 + x32*x505 - x32*x507 + x32*x566 - x32*x568 - x32*x571 + x32*x573 - x32*x583 + x32*x584 + x32*x669 - x32*x671 + x322*x527 - x322*x528 - x322*x529 + x322*x530 - x322*x646 + x322*x647 + x324*x58 - x324*x65 - x324*x74 + x324*x82 - x325*x58 + x325*x65 + x325*x74 - x325*x82 + x328*x9 - x329*x9 + x33*x355 - x33*x356 - x33*x359 + x33*x360 - x33*x361 + x33*x362 - x33*x417 + x33*x418 + x33*x427 - x33*x429 - x33*x431 + x33*x433 + x33*x436 - x33*x439 - x33*x445 + x33*x446 + x33*x451 + x33*x453 - x33*x455 - x33*x458 + x33*x464 - x33*x467 + x33*x469 - x33*x471 + x33*x475 - x33*x480 - x33*x538 + x33*x541 + x33*x543 - x33*x544 - x33*x547 + x33*x550 - x33*x555 + x33*x557 - x33*x565 + x33*x567 + x33*x569 - x33*x575 - x33*x578 + x33*x581 - x33*x587 - x33*x590 + x33*x593 + x33*x596 - x33*x602 + x33*x605 - x33*x611 + x33*x620 + x33*x652 - x33*x655 + x33*x659 - x33*x662 + x33*x664 - x33*x666 + x330 - x331 - x332 + x333 - x334 + x335 + x336 - x337 + x338*x35 + x338*x43 - x338*x46 - x338*x49 + x338*x60 + x338*x67 + x338*x75 + x338*x83 - x338*x86 - x338*x89 - x338*x92 - x338*x95 + x340 - x342 - x343 + x344 - x345 + x346 + x347 - x348 - x35*x371 + x351*x38 - x351*x44 - x351*x48 + x351*x56 + x351*x62 + x351*x70 + x351*x80 - x351*x84 - x351*x88 - x351*x91 - x351*x93 + x351*x98 + x352*x40 - x352*x45 - x352*x47 + x352*x53 + x352*x6 + x352*x64 + x352*x72 + x352*x78 - x352*x85 - x352*x87 - x352*x90 - x352*x94 - x355*x41 + x356*x41 + x357*x9 - x358*x9 + x359*x41 - x360*x41 + x361*x41 - x362*x41 + x363 - x364 - x365 + x366 - x367 + x368 + x369 - x370 - x371*x43 + x371*x46 + x371*x49 - x371*x60 - x371*x67 - x371*x75 - x371*x83 + x371*x86 + x371*x89 + x371*x92 + x371*x95 + x372*x9 - x373*x8 - x374*x9 + x375*x8 - x376*x8 + x378*x527 - x378*x528 - x378*x529 + x378*x530 - x378*x646 + x378*x647 + x380*x8 - x381*x527 + x381*x528 + x381*x529 - x381*x530 + x381*x646 - x381*x647 - x383*x74 + x383*x82 + x384*x74 - x384*x82 - x387 + x388 + x389 - x390 + x391 - x392 - x393 + x394 - x395 + x396 + x397 - x398 + x399 - x400 - x401 + x402 + x409*x58 - x409*x65 + x41*x417 - x41*x418 - x41*x427 + x41*x429 + x41*x431 - x41*x433 - x41*x436 + x41*x439 + x41*x445 - x41*x446 - x41*x451 - x41*x453 + x41*x455 + x41*x458 - x41*x464 + x41*x467 - x41*x469 + x41*x471 - x41*x475 + x41*x480 + x41*x538 - x41*x541 - x41*x543 + x41*x544 + x41*x547 - x41*x550 + x41*x555 - x41*x557 + x41*x565 - x41*x567 - x41*x569 + x41*x575 + x41*x578 - x41*x581 + x41*x587 + x41*x590 - x41*x593 - x41*x596 + x41*x602 - x41*x605 + x41*x611 - x41*x620 - x41*x652 + x41*x655 - x41*x659 + x41*x662 - x41*x664 + x41*x666 + x410*x9 - x413*x58 + x413*x65 - x414*x9 + x415*x58 - x415*x65 - x415*x74 + x415*x82 - x416*x58 + x416*x65 + x416*x74 - x416*x82 + x420*x58 - x420*x65 + x421*x9 - x423*x58 + x423*x65 - x424*x9 - x425*x58 + x425*x65 + x426*x58 - x426*x65 - x427*x50 + x427*x57 + x428*x9 + x429*x50 - x429*x57 - x430*x9 + x431*x50 - x431*x57 - x432*x8 - x433*x50 + x433*x57 + x434*x8 + x435*x74 - x435*x82 + x437*x9 - x438*x74 + x438*x82 - x440*x9 - x447*x9 + x448*x9 - x450*x58 + x450*x65 - x452*x58 + x452*x65 + x452*x74 - x452*x82 + x454*x58 - x454*x65 - x454*x74 + x454*x82 + x457*x58 - x457*x65 + x463*x74 - x463*x82 + x465*x9 - x466*x74 + x466*x82 - x468*x9 - x470*x9 + x472*x9 - x474*x58 + x474*x65 + x479*x58 - x479*x65 + x481*x74 - x481*x82 - x482*x74 + x482*x82 - x483 + x484 + x485 - x486 + x487 - x488 - x489 + x490 - x491 + x492 + x493 - x494 + x495 - x496 - x497 + x498 + x50*x565 - x50*x567 - x50*x569 + x50*x575 - x500*x58 + x500*x65 - x501*x9 + x503*x58 - x503*x65 + x504*x9 - x505*x9 + x506*x8 + x507*x9 - x508*x8 + x509*x8 - x510*x8 + x511*x74 - x511*x82 - x512*x74 + x512*x82 + x515 - x516 - x517 + x518 - x519 + x520 + x521 - x522 - x524*x58 + x524*x65 - x525*x9 + x533*x58 - x533*x65 + x534*x9 - x535*x58 + x535*x65 + x535*x74 - x535*x82 + x536*x58 - x536*x65 - x536*x74 + x536*x82 - x537*x74 + x537*x82 - x539*x9 + x540*x74 - x540*x82 + x542*x9 + x546*x58 - x546*x65 - x549*x58 + x549*x65 - x552*x58 + x552*x65 - x553*x9 + x554*x58 - x554*x65 - x556*x58 + x556*x65 + x559*x58 - x559*x65 + x560*x9 + x561*x58 - x561*x65 - x562*x9 - x563*x58 + x563*x65 + x564*x9 - x565*x57 - x566*x9 + x567*x57 + x568*x9 + x569*x57 - x57*x575 + x570*x8 - x572*x8 + x574*x8 - x576*x8 - x577*x74 + x577*x82 - x579*x9 + x58*x586 + x58*x589 - x58*x592 - x58*x595 + x58*x610 - x58*x619 + x58*x640 - x58*x643 - x58*x658 + x58*x661 - x58*x663 + x58*x665 + x580*x74 - x580*x82 + x582*x9 - x586*x65 - x589*x65 - x589*x74 + x589*x82 + x592*x65 + x592*x74 - x592*x82 + x595*x65 - x601*x74 + x601*x82 - x603*x9 + x604*x74 - x604*x82 + x606*x9 + x607*x9 - x608*x9 - x610*x65 - x614*x74 + x614*x82 + x617*x74 - x617*x82 + x619*x65 - x621*x74 + x621*x82 + x622 - x623 - x624 + x625 + x626*x74 - x626*x82 - x627 + x628 + x629 - x630 + x631 - x632 - x633 + x634 - x635 + x636 + x637 - x638 - x640*x65 + x641*x9 + x643*x65 - x644*x9 - x649*x74 + x649*x82 + x65*x658 - x65*x661 + x65*x663 - x65*x665 + x650*x74 - x650*x82 + x651*x74 - x651*x82 + x653*x9 - x654*x74 + x654*x82 - x656*x9 + x667*x9 - x668*x9 + x670*x8 - x672*x8 + x676*x74 - x676*x82 - x678*x74 + x678*x82 - x679 + x680 + x681 - x682 + x683 - x684 - x685 + x686 + x690*x74 - x690*x82 - x693*x74 + x693*x82 + x694*x74 - x694*x82 - x695*x74 + x695*x82 + x698*x74 - x698*x82 - x701*x74 + x701*x82 - x704*x74 + x704*x82 + x707*x74 - x707*x82 - x710*x74 + x710*x82 + x713*x74 - x713*x82 - x716*x74 + x716*x82 + x719*x74 - x719*x82 + x722*x74 - x722*x82 - x725*x74 + x725*x82)/(2*(x10 + x100 + x103 + x105 + x107 + x110 + x113 + x115 + x117 + x12 + x120 + x122 + x124 - x125 - x126 - x127 - x128 - x129 - x130 - x131 - x132 - x133 - x134 - x135 - x136 + x139 + x14 + x141 + x143 + x146 + x148 + x150 + x153 + x155 + x157 + x159 + x161 + x163 + x165 + x167 + x169 + x17 + x171 + x173 + x175 + x177 + x179 - x18 + x181 + x183 + x185 + x187 - x188 - x189 - x19 - x190 - x191 - x192 - x193 - x194 - x195 - x196 - x197 - x198 - x199 - x20 - x200 - x201 - x202 - x203 - x204 - x205 - x206 - x207 - x208 - x209 - x21 - x210 - x211 - x22 - x23 + x28 + x3 + x31 + x35 + x38 + x40 + x43 - x44 - x45 - x46 - x47 - x48 - x49 + x53 + x56 + x6 + x60 + x62 + x64 + x67 + x70 + x72 + x75 + x78 + x80 + x83 - x84 - x85 - x86 - x87 - x88 - x89 - x90 - x91 - x92 - x93 - x94 - x95 + x98))

    return X


def tc_integral_square_wave(V_delay,delta_t,V_tank,Q,N_bf,N_af,rs,recoil_prob,t0,t,N_e,Q_external,eff, **kwargs):
    x0 = Q_external**2
    x1 = lambda_a*lambda_b*x0
    x2 = lambda_a*x0
    x3 = V_delay - V_tank
    x4 = x0*x3
    x5 = lambda_a**2
    x6 = V_delay*V_tank*x3
    x7 = Q_external*lambda_a
    x8 = V_delay**2
    x9 = V_tank**2
    x10 = x8 - x9
    x11 = x10*x7
    x12 = -x11 + x4 + x5*x6
    x13 = -x12*x2
    x14 = lambda_b**3
    x15 = V_delay*V_tank*x14
    x16 = Q_external*lambda_b
    x17 = Q_external**3
    x18 = x17*x3
    x19 = V_delay**3
    x20 = V_tank**3
    x21 = x19 - x20
    x22 = x21*x5
    x23 = lambda_a**3
    x24 = V_delay*V_tank*x10
    x25 = -Q_external*x22 + x18 + x23*x24
    x26 = lambda_b**2
    x27 = x10*x17
    x28 = x3*x8*x9
    x29 = -x2*x21 + x23*x28 + x27
    x30 = x26*x29
    x31 = x12*x15 + x13 + x16*x25 - x30
    x32 = x1*x31
    x33 = lambda_c**4
    x34 = V_delay*V_tank*x33
    x35 = Q_external*lambda_c
    x36 = Q_external*x26
    x37 = Q_external**4
    x38 = Q_external*x23
    x39 = V_delay**4 - V_tank**4
    x40 = lambda_a**4
    x41 = V_delay*V_tank*x21*x40 + x3*x37 - x38*x39
    x42 = lambda_b**4
    x43 = V_delay*V_tank*x42
    x44 = x0*x5
    x45 = x8*x9
    x46 = x10*x37 + x10*x40*x45 - x39*x44
    x47 = x35*(-x12*x17*x5 - x14*x46 + x25*x43 + x36*x41)
    x48 = lambda_c**2
    x49 = lambda_b*x0
    x50 = lambda_a*x17
    x51 = x20*x40
    x52 = x19*x3*x51 + x21*x37 - x39*x50
    x53 = x48*(-x14*x52 - x25*x50 + x29*x43 + x41*x49)
    x54 = lambda_c**3
    x55 = x54*(x12*x42*x45 + x16*x46 - x2*x29 - x26*x52)
    x56 = x31*x34 + x32 - x47 + x53 - x55
    x57 = 1/V_delay
    x58 = Q_external*x57
    x59 = 1/V_tank
    x60 = Q_external*x59
    x61 = lambda_a + x58 + x60
    x62 = lambda_b + x61
    x63 = lambda_c + x62
    x64 = t - t0
    x65 = abs(x64)
    x66 = t/2 - t0/2 + x65/2
    x67 = N_af + N_bf
    x68 = x12*x67
    x69 = Q_external*lambda_a*lambda_b
    x70 = lambda_a*x67
    x71 = N_af*lambda_a*recoil_prob
    x72 = 2*lambda_a*x17*x26*(N_bf*lambda_c*x31 - V_delay*V_tank*lambda_a*x14*x68 - x25*x67*x69 + x30*x70 + x31*x71 + x44*x68)
    x73 = lambda_a*x4
    x74 = Q_external*x10
    x75 = N_bf*lambda_b
    x76 = -x12*x75 + x23*x6*x67 - x5*x67*x74 + x67*x73
    x77 = V_delay*V_tank*x54
    x78 = x40*x67
    x79 = lambda_a*x10
    x80 = 2*lambda_a*lambda_c*x17*(x2*x76 - x35*(x18*x70 - x21*x38*x67 + x24*x78 - x25*x75) + x48*(-x0*x22*x67 + x17*x67*x79 + x28*x78 - x29*x75) + x71*(x12*x77 + x13 + x25*x35 - x29*x48) - x76*x77)
    x81 = Q_external*(x57 + x59)
    x82 = x14*x6
    x83 = Q_external*x3 + x79
    x84 = V_delay*lambda_a
    x85 = V_tank*x3
    x86 = x84*x85
    x87 = x74 + x86
    x88 = 2*Q_external
    x89 = V_delay*x88 - V_tank*x88 + x79
    x90 = x8*x88 + x86 - x88*x9
    x91 = 2*x0
    x92 = V_delay*x91 - V_tank*x91 + x11 + x22
    x93 = V_tank*x5
    x94 = V_tank*x8
    x95 = V_delay*x9
    x96 = V_delay*x10*x93 + x7*(x21 + x94 - x95) + x8*x91 - x9*x91
    x97 = Q_external*x84
    x98 = x5*x8
    x99 = x3*x9
    x100 = V_tank*x10*x97 + x19*x91 - x20*x91 + x98*x99
    x101 = V_delay*x26
    x102 = -lambda_b*x74 + x101*x85 + x4
    x103 = x14*x8
    x104 = 2*N_af*x17*(-lambda_b*lambda_c*recoil_prob*(-x102*x49 + x102*x77 + x35*(x10*x15 + x18 - x21*x36) - x48*(x103*x99 - x21*x49 + x27)) - x1*(-x16*x83 + x26*x87 + x73 - x82) - x34*(-x16*x89 + x26*x90 + x73 - 2*x82) + x35*(x14*x96 + x18*x5 - x36*x92 - x43*x89) + x48*(-x100*x14 + x43*x90 + x49*x92 - x50*x83) - x54*(-x100*x26 + x16*x96 - x2*x87 + 2*x28*x42))
    x105 = exp(x60*x66)
    x106 = N_af*lambda_b*x0*x5
    x107 = -Q_external
    x108 = V_tank*lambda_a
    x109 = x107 + x108
    x110 = V_delay + V_tank
    x111 = x110*x5
    x112 = -V_tank*x111 + x0 + x97
    x113 = -x0*x110
    x114 = x113 + x5*x95 + x7*x9
    x115 = N_af*x0*x5
    x116 = V_tank*x14
    x117 = N_bf*V_tank
    x118 = 2*N_af + N_bf
    x119 = V_delay*x118
    x120 = x117 + x119
    x121 = x120*x7
    x122 = N_bf*x0 + x119*x93
    x123 = -x121 + x122
    x124 = N_af - N_bf
    x125 = x0*x124
    x126 = N_af*V_tank
    x127 = x119 + x126
    x128 = x121 + x125 - x127*x93
    x129 = N_bf*x17
    x130 = Q_external*x124
    x131 = x5*x9
    x132 = x118*x23
    x133 = -x127*x2 + x129 + x130*x131 + x132*x95
    x134 = lambda_a*lambda_b*lambda_c*recoil_prob
    x135 = Q_external - x108
    x136 = x0 - x131
    x137 = -V_tank*x135*x26 + lambda_b*x136 - x135*x7
    x138 = x20*x23
    x139 = -x138 + x17
    x140 = Q_external*lambda_a*lambda_c
    x141 = N_af*x17*x5
    x142 = N_af*x17
    x143 = V_delay*x5
    x144 = N_af*V_delay
    x145 = V_tank*x144
    x146 = x118*x8
    x147 = N_af*x9 + x145 + x146
    x148 = Q_external*x120*x143 - V_tank*x147*x23 + x125*x84 + x142
    x149 = V_delay*x124 + x126
    x150 = Q_external*x131*x149 - x0*x127*x84 + x127*x23*x95 - x149*x17
    x151 = N_bf*V_delay
    x152 = Q_external*V_delay*x124*x138 + x115*x20 + x146*x51 - x147*x50 + x151*x37
    x153 = 2*x19*(-N_af*x134*x8*(V_tank*x137*x54 + lambda_c*(-x116*x136 - x135*x44 + x139*x26) - x137*x69 - x48*(lambda_b*x139 - x135*x14*x9 - x136*x7)) - x106*(-x109*x15 + x109*x2 + x112*x16 + x114*x26) + x140*(x128*x43 - x135*x141 + x14*x150 + x148*x36) - x34*(x109*x115 - x116*x123 + x128*x69 + x133*x26) + x48*(-x1*x148 + x112*x141 + x133*x43 - x14*x152) - x54*(-x114*x115 + x123*x42*x95 + x150*x69 - x152*x26))
    x154 = x107 + x84
    x155 = Q_external*x108 - V_delay*x111 + x0
    x156 = x113 + x5*x94 + x7*x8
    x157 = V_delay*x14
    x158 = V_tank*x118
    x159 = x151 + x158
    x160 = x159*x7
    x161 = x122 - x160
    x162 = x144 + x158
    x163 = x125 - x143*x162 + x160
    x164 = x129 + x130*x98 + x132*x94 - x162*x2
    x165 = Q_external - x84
    x166 = x0 - x98
    x167 = lambda_b*x166 - x101*x165 - x165*x7
    x168 = x17 - x19*x23
    x169 = x118*x9
    x170 = N_af*x8 + x145 + x169
    x171 = Q_external*x159*x93 - V_delay*x170*x23 + x108*x125 + x142
    x172 = V_tank*x124
    x173 = x144 + x172
    x174 = Q_external*x173*x98 - x0*x108*x162 + x162*x23*x94 - x17*x173
    x175 = Q_external*x172*x19*x23 + x115*x19 + x117*x37 + x169*x19*x40 - x170*x50
    x176 = 2*x20*(-N_af*x134*x9*(V_delay*x167*x54 + lambda_c*(-x157*x166 - x165*x44 + x168*x26) - x167*x69 - x48*(lambda_b*x168 - x103*x165 - x166*x7)) - x106*(-x15*x154 + x154*x2 + x155*x16 + x156*x26) + x140*(x14*x174 - x141*x165 + x163*x43 + x171*x36) - x34*(x115*x154 - x157*x161 + x163*x69 + x164*x26) + x48*(-x1*x171 - x14*x175 + x141*x155 + x164*x43) - x54*(-x115*x156 + x161*x42*x94 + x174*x69 - x175*x26))
    x177 = Q_external*(-N_af*recoil_prob*x56 + V_tank*x119*x31*x33 + x118*x32 - x118*x47 + x118*x53 - x118*x55)
    x178 = delta_t - t + t0
    x179 = abs(x178)
    x180 = delta_t/2 - t/2 + t0/2 - x179/2
    x181 = exp(-x180*x60)
    X = N_e*Q*eff*rs*((lambda_c*(lambda_b*(lambda_a*(x105*x153 + (x105*x177*(x64 + x65) - x176)*exp(x58*x66))*exp(lambda_a*x66) + x104*exp(x66*x81))*exp(lambda_b*x66) + x80*exp(x61*x66))*exp(lambda_c*x66) - x72*exp(x62*x66))*exp(-x63*x66) - (lambda_c*(lambda_b*(lambda_a*(x153*x181 - (x176 + x177*x181*(x178 - x179))*exp(-x180*x58))*exp(-lambda_a*x180) + x104*exp(-x180*x81))*exp(-lambda_b*x180) + x80*exp(-x180*x61))*exp(-lambda_c*x180) - x72*exp(-x180*x62))*exp(x180*x63))/(2*Q_external*lambda_a*lambda_b*lambda_c*x56)

    return X


def tc_integral_square_wave_nodelay(rs,delta_t,recoil_prob,t0,V_tank,Q,N_bf,N_af,N_e,Q_external,eff,t, **kwargs):
    x0 = V_tank*lambda_c**3
    x1 = Q_external*lambda_a
    x2 = V_tank*lambda_a
    x3 = Q_external - x2
    x4 = -x1*x3
    x5 = lambda_b**2
    x6 = V_tank*x5
    x7 = Q_external**2
    x8 = V_tank**2
    x9 = lambda_a**2
    x10 = x8*x9
    x11 = -x10 + x7
    x12 = lambda_b*x11 - x3*x6 + x4
    x13 = Q_external*lambda_a*lambda_b
    x14 = lambda_c**2
    x15 = Q_external**3
    x16 = lambda_a**3
    x17 = V_tank**3*x16
    x18 = x15 - x17
    x19 = lambda_b**3
    x20 = x19*x8
    x21 = x7*x9
    x22 = V_tank*x19
    x23 = Q_external/V_tank
    x24 = lambda_a + x23
    x25 = lambda_b + x24
    x26 = lambda_c + x25
    x27 = t - t0
    x28 = abs(x27)
    x29 = t/2 - t0/2 + x28/2
    x30 = N_af + N_bf
    x31 = x30*x9
    x32 = -Q_external
    x33 = x2 + x32
    x34 = lambda_a*x30
    x35 = -x7
    x36 = x10 + x35
    x37 = lambda_b*x36
    x38 = x1*x33 + x33*x6 - x37
    x39 = N_af*lambda_a*recoil_prob
    x40 = 2*lambda_a*x5*x7*(N_bf*lambda_c*x38 - Q_external*x31*x33 - x2*x30*x33*x5 + x34*x37 + x38*x39)
    x41 = N_bf*lambda_b
    x42 = -V_tank*x31 + x1*x30 + x33*x41
    x43 = V_tank*x14
    x44 = 2*lambda_a*lambda_c*x7*(lambda_c*(-x16*x30*x8 + x34*x7 + x36*x41) - x1*x42 - x39*(lambda_c*x11 - x3*x43 + x4) - x42*x43)
    x45 = exp(x23*x29)
    x46 = Q_external + x2
    x47 = lambda_b*(-lambda_b*x46 + x1 + x6)
    x48 = 2*Q_external + x2
    x49 = V_tank*x1
    x50 = x10 + x49 + 2*x7
    x51 = V_tank*lambda_b + x32
    x52 = 2*N_af*x7*(lambda_b*lambda_c*recoil_prob*(Q_external*lambda_b*x51 - lambda_c*(x35 + x5*x8) + x43*x51) - lambda_c*(x21 + x22*x48 - x5*x50) - x0*(-lambda_b*x48 + x1 + 2*x6) + x1*x47 + x14*(-lambda_b*x50 + x1*x46 + 2*x20))
    x53 = N_af*Q_external*x9
    x54 = N_af*recoil_prob
    x55 = lambda_a*lambda_b
    x56 = lambda_a - lambda_b
    x57 = 2*N_af + N_bf
    x58 = x2*x57
    x59 = N_bf*Q_external - x58
    x60 = N_af - N_bf
    x61 = Q_external*x60 + x58
    x62 = N_af*x7
    x63 = x10*x57 + x49*x60 + x62
    x64 = 2*x8*(lambda_a*lambda_b*lambda_c*x54*x8*(-lambda_c*(-x5 + x9) + x14*x56 + x55*x56) + lambda_a*lambda_c*(x22*x61 - x5*x63 + x62*x9) + x0*(-x5*x59 + x53 - x55*x61) - x14*(-x22*x59 + x46*x53 - x55*x63) - x47*x53)
    x65 = x13*x38
    x66 = x0*x38
    x67 = -x15 + x17
    x68 = x14*(-lambda_b*x67 + x1*x36 + x20*x33)
    x69 = lambda_c*(x21*x33 + x22*x36 - x5*x67)
    x70 = Q_external*(x54*(-x65 + x66 - x68 + x69) + x57*x65 - x57*x66 + x57*x68 - x57*x69)
    x71 = delta_t - t + t0
    x72 = abs(x71)
    x73 = delta_t/2 - t/2 + t0/2 - x72/2
    x74 = exp(-x23*x73)
    X = -N_e*Q*eff*rs*((lambda_c*(lambda_b*(lambda_a*(x64 + x70*x74*(x71 - x72))*exp(-lambda_a*x73) + x52*x74)*exp(-lambda_b*x73) + x44*exp(-x24*x73))*exp(-lambda_c*x73) + x40*exp(-x25*x73))*exp(x26*x73) - (lambda_c*(lambda_b*(lambda_a*(-x45*x70*(x27 + x28) + x64)*exp(lambda_a*x29) + x45*x52)*exp(lambda_b*x29) + x44*exp(x24*x29))*exp(lambda_c*x29) + x40*exp(x25*x29))*exp(-x26*x29))/(2*Q_external*lambda_a*lambda_b*lambda_c*(lambda_c*(-x11*x22 + x18*x5 - x21*x3) + x0*x12 - x12*x13 - x14*(lambda_b*x18 - x1*x11 - x20*x3)))

    return X


def steady_state_count_rate(rs,recoil_prob,V_tank,Q,lamp,eff, **kwargs):
    x0 = V_tank/Q
    x1 = lambda_a*x0
    x2 = lambda_b*x0
    x3 = lamp*x0
    x4 = lambda_a*lambda_b
    x5 = lambda_a - lambda_b
    x6 = lambda_a**2
    x7 = lambda_b**2
    x8 = exp(x1)
    x9 = exp(x2)
    x10 = x9*(lambda_a - 2*lambda_b)
    x11 = lambda_b + lamp
    x12 = x8*exp(x3)
    X = -Q*eff*rs*(lambda_b*x10 + lamp*(lambda_a*x8 + x10) - recoil_prob*x5*x9*(-x11*x12 + x11) - x12*x9*(2*lamp*x5 + x4 + x6 - 2*x7) + x6*x8)*exp(-x1)*exp(-x2)*exp(-x3)/(lamp**2*x5 + lamp*(x6 - x7) + x4*x5)

    return X


